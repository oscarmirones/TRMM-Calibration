---
title: "Ranking Index with calibration conditioned to WT"
author: "Ã“scar Mirones Alonso"
output: 
  html_notebook:
    theme: united
    toc: yes
    toc_depth: 5
---

```{r}
library(loadeR)
library(transformeR)
library(downscaleR)
library(visualizeR)
library(convertR)
library(ncdf4)
library(climate4R.value)
library(magrittr)
library(evd)
library(formattable) #neccessary to create tables with colors
library(lubridate) #neccessary to calculate differences in years between dates
library(lattice)
library(ggplot2)
library(raster)
library(rasterVis)
library(sp)
library(ggplot2)

if (dir.exists("C:/Users/usuario/Desktop/TRMM-Calibration/Data")) {
  dir <- "C:/Users/usuario/Desktop/TRMM-Calibration/Data"
}else{
  dir <- "/vols/abedul/meteo/mironeso/trmm"
}

```

```{r setup}
knitr::opts_knit$set(root.dir = dir)
```

```{r}
set.seed(42)

load("pca.RData")
load("pp_reanalysis.RData")
idx.tp <- which(attributes(pca$tp[[1]])$explained_variance >= .75)[1]
idx.msl <- which(attributes(pca$msl[[1]])$explained_variance >= .9)[1]
idx.diff.msl <- which(attributes(pca$diff_msl[[1]])$explained_variance >= .9)[1]

pca.matrix <- cbind(pca$tp[[1]]$PCs[,1:idx.tp],pca$msl[[1]]$PCs[,1:idx.msl],pca$diff_msl[[1]]$PCs[,1:idx.diff.msl])

k = 5
load('C:/Users/usuario/Desktop/TRMM-Calibration/Data/kmModel5.RData')

precip_obs <- loadStationData("C:/Users/usuario/Desktop/TRMM-Calibration/TRMM-time-series/WT_Analysis_Calibration/SP_ascii.zip", var = "precip_obs")
precip_trmm <- loadStationData("C:/Users/usuario/Desktop/TRMM-Calibration/TRMM-time-series/WT_Analysis_Calibration/SP_ascii.zip", var = "precip_trmm")

```

```{r}
lista <- lapply(1:k, function(x) subsetDimension(pp_reanalysis, dimension = "time", indices = which(kmModel5$cluster == x)) %>% climatology())
kmedias.pp <- bindGrid(lista, dimension = "member", skip.temporal.check = TRUE)

spatialPlot(kmedias.pp,backdrop.theme = 'countries', rev.color = T, as.table = T, names.attr = paste("Days in cluster", 1:k, ":",kmModel5$size[1:k]))

```
```{r}
kmModel5$cluster <- kmModel5$cluster[1:8034]

```

```{r}
MaxReturnValue <- function(data){
  #library(lubridate)
  #nyears <- round(time_length(difftime(cal.madrid.eqm$Dates$end[length(cal.madrid.eqm$Dates$end)], cal.madrid.eqm$Dates$start[1]),"years"))
  nyears <- 20
  data.maxYear <- aggregateGrid(redim(data), aggr.y = list(FUN = "max",na.rm = TRUE))

  data.maxrv <- climatology(data, clim.fun = list(FUN = "mean", na.rm = T))

  auxData <- data.maxYear$Data
  auxData[which(is.infinite(auxData))] <- NA

  if (any(!is.na(auxData))){
      auxGEV <- fgev(auxData)
      if ((auxGEV$estimate[3] - auxGEV$std.err[3] < 0) & (0  < auxGEV$estimate[3] + auxGEV$std.err[3])){
        auxGEV <- fgev(auxData, shape = 0)
        auxRV <- qgev(1-1/nyears, loc = auxGEV$estimate[1], scale = auxGEV$estimate[2], shape = 0)
      }else{
        auxRV <- qgev(1-1/nyears, loc = auxGEV$estimate[1], scale = auxGEV$estimate[2], shape = auxGEV$estimate[3])
      }
      data.maxrv <- as.numeric(auxRV)
      names(data.maxrv) <- paste("RV",nyears,"_max", sep = "")
  }
  return(data.maxrv)
  }
```

```{r}
pp_reanalysis <- subsetGrid(pp_reanalysis, years = 1998:2019)
```

## Wallis and Futuna


```{r}
i=1

station.trmm <- subsetGrid(precip_trmm, station.id = precip_trmm$Metadata$station_id[i])
station.obs <- subsetGrid(precip_obs, station.id = precip_trmm$Metadata$station_id[i])

idx <- which.min(abs(pp_reanalysis$xyCoords$x - station.obs$xyCoords$x))
lon <- pp_reanalysis$xyCoords$x[idx]
  
idx2 <- which.min(abs(pp_reanalysis$xyCoords$y - station.obs$xyCoords$y))
lat <- pp_reanalysis$xyCoords$y[idx2]
  
station.era5 <- subsetGrid(pp_reanalysis, lonLim = lon, latLim = lat)
```


````{r}
index.obs <- valueIndex1D(station.obs$Data[!is.na(station.obs$Data)],index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))
index.obs <- c(index.obs, valueIndex1D(station.obs$Data[!is.na(station.obs$Data)], index.codes = "P98WetAmount"))
index.obs.rv20max <- MaxReturnValue(station.obs)
index.obs <- c(index.obs, index.obs.rv20max)

index.trmm <- valueIndex1D(station.trmm$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.trmm.rv20max <- MaxReturnValue(station.trmm)
index.trmm <- c(index.trmm, index.trmm.rv20max)

index.era5 <- valueIndex1D(station.era5$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.era5.rv20max <- MaxReturnValue(station.era5)
index.era5 <- c(index.era5, index.era5.rv20max)

```



### WT1

```{r}
station.obs.cl1 <- subsetDimension(station.obs, dimension = "time", indices = which(kmModel5$cluster == 1))


station.trmm.cl1 <- subsetDimension(station.trmm, dimension = "time", indices = which(kmModel5$cluster == 1))

station.era5.cl1 <- subsetDimension(station.era5, dimension = "time", indices = which(kmModel5$cluster == 1))
```

```{r}
index.obs.cl1 <- valueIndex1D(station.obs.cl1$Data[!is.na(station.obs.cl1$Data)],index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))
index.obs.cl1 <- c(index.obs.cl1, valueIndex1D(station.obs.cl1$Data[!is.na(station.obs.cl1$Data)], index.codes = "P98WetAmount"))
index.obs.cl1.rv20max <- MaxReturnValue(station.obs.cl1)
index.obs.cl1 <- c(index.obs.cl1, index.obs.cl1.rv20max)

index.trmm.cl1 <- valueIndex1D(station.trmm.cl1$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.trmm.cl1.rv20max <- MaxReturnValue(station.trmm.cl1)
index.trmm.cl1 <- c(index.trmm.cl1, index.trmm.cl1.rv20max)

index.era5.cl1 <- valueIndex1D(station.era5.cl1$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.era5.cl1.rv20max <- MaxReturnValue(station.era5.cl1)
index.era5.cl1 <- c(index.era5.cl1, index.era5.cl1.rv20max)
```

```{r}
cal.station.cl1 <- biasCorrection(y = station.obs.cl1, x = station.trmm.cl1, precipitation = TRUE,  method = "pqm")


cal.station.cl1 <- subsetDimension(cal.station.cl1, dimension = "time", indices = which(!is.na(cal.station.cl1$Data)))

cal.station.cl1$Dates$start <- as.POSIXct(cal.station.cl1$Dates$start,tz = "GMT")
cal.station.cl1$Dates$end <- as.POSIXct(cal.station.cl1$Dates$end,tz = "GMT")

index.cal.station.cl1 <- valueIndex1D(cal.station.cl1$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl1 <- c(index.cal.station.cl1, valueIndex1D(cal.station.cl1$Data[!is.na(cal.station.cl1$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl1.rv20max <- MaxReturnValue(cal.station.cl1)

index.cal.station.cl1 <- c(index.cal.station.cl1, index.cal.station.cl1.rv20max)

index.cal.station.pqm.cl1 <- index.cal.station.cl1


```


```{r}
cal.station.cl1 <- biasCorrection(y = station.obs.cl1, x = station.trmm.cl1, precipitation = TRUE,  method = "eqm")


cal.station.cl1 <- subsetDimension(cal.station.cl1, dimension = "time", indices = which(!is.na(cal.station.cl1$Data)))

cal.station.cl1$Dates$start <- as.POSIXct(cal.station.cl1$Dates$start,tz = "GMT")
cal.station.cl1$Dates$end <- as.POSIXct(cal.station.cl1$Dates$end,tz = "GMT")

index.cal.station.cl1 <- valueIndex1D(cal.station.cl1$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl1 <- c(index.cal.station.cl1, valueIndex1D(cal.station.cl1$Data[!is.na(cal.station.cl1$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl1.rv20max <- MaxReturnValue(cal.station.cl1)

index.cal.station.cl1 <- c(index.cal.station.cl1, index.cal.station.cl1.rv20max)

index.cal.station.eqm.cl1 <- index.cal.station.cl1


```

```{r}
cal.station.cl1 <- biasCorrection(y = station.obs.cl1, x = station.trmm.cl1, precipitation = TRUE,  method = "gpqm")


cal.station.cl1 <- subsetDimension(cal.station.cl1, dimension = "time", indices = which(!is.na(cal.station.cl1$Data)))

cal.station.cl1$Dates$start <- as.POSIXct(cal.station.cl1$Dates$start,tz = "GMT")
cal.station.cl1$Dates$end <- as.POSIXct(cal.station.cl1$Dates$end,tz = "GMT")

index.cal.station.cl1 <- valueIndex1D(cal.station.cl1$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl1 <- c(index.cal.station.cl1, valueIndex1D(cal.station.cl1$Data[!is.na(cal.station.cl1$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl1.rv20max <- MaxReturnValue(cal.station.cl1)

index.cal.station.cl1 <- c(index.cal.station.cl1, index.cal.station.cl1.rv20max)

index.cal.station.gpqm.cl1 <- index.cal.station.cl1


```


```{r}
cal.station.cl1 <- biasCorrection(y = station.obs.cl1, x = station.trmm.cl1, precipitation = TRUE,  method = "gpqm" , theta = .7)


cal.station.cl1 <- subsetDimension(cal.station.cl1, dimension = "time", indices = which(!is.na(cal.station.cl1$Data)))

cal.station.cl1$Dates$start <- as.POSIXct(cal.station.cl1$Dates$start,tz = "GMT")
cal.station.cl1$Dates$end <- as.POSIXct(cal.station.cl1$Dates$end,tz = "GMT")

index.cal.station.cl1 <- valueIndex1D(cal.station.cl1$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl1 <- c(index.cal.station.cl1, valueIndex1D(cal.station.cl1$Data[!is.na(cal.station.cl1$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl1.rv20max <- MaxReturnValue(cal.station.cl1)

index.cal.station.cl1 <- c(index.cal.station.cl1, index.cal.station.cl1.rv20max)

index.cal.station.gpqm2.cl1 <- index.cal.station.cl1


```



```{r}
measures <- list()
for (i in c(1:9)) {
  measures[[length(measures)+1]] <- c(abs(index.trmm.cl1[i]-index.obs.cl1[i]),abs(index.era5.cl1[i]-index.obs.cl1[i]),abs(index.cal.station.pqm.cl1[i]-index.obs.cl1[i]), abs(index.cal.station.eqm.cl1[i]-index.obs.cl1[i]), abs(index.cal.station.gpqm.cl1[i]-index.obs.cl1[i]), abs(index.cal.station.gpqm2.cl1[i]-index.obs.cl1[i])) 
}

```

```{r}
normalization <- function(measure){
  measure.norm <- c()
  #measure must be a vector with the value of a certain measure of different calibrations
  for (i in c(1:length(measure))) {
    measure.norm <- c(measure.norm, 1-((measure[i]-min(measure))/(max(measure)-min(measure))))
  }
  return(measure.norm)
}
```

```{r}
norm.vector <- list()
for (i in c(1:length(measures))) {
  norm.vector[[length(norm.vector)+1]] <- normalization(measures[[i]]) 
}
```

```{r}
score.trmm <- c()
for (i in c(1:9)) {
  score.trmm <- c(score.trmm, norm.vector[[i]][1]) 
}
score.trmm <- mean(score.trmm)

score.era5 <- c()
for (i in c(1:9)) {
  score.era5 <- c(score.era5, norm.vector[[i]][2]) 
}
score.era5 <- mean(score.era5)

score.pqm <- c()
for (i in c(1:9)) {
  score.pqm <- c(score.pqm, norm.vector[[i]][3]) 
}
score.pqm <- mean(score.pqm)


score.eqm <- c()
for (i in c(1:9)) {
  score.eqm <- c(score.eqm, norm.vector[[i]][4]) 
}
score.eqm <- mean(score.eqm)


score.gpqm <- c()
for (i in c(1:9)) {
  score.gpqm <- c(score.gpqm, norm.vector[[i]][5]) 
}
score.gpqm <- mean(score.gpqm)


score.gpqm2 <- c()
for (i in c(1:9)) {
  score.gpqm2 <- c(score.gpqm2, norm.vector[[i]][6]) 
}
score.gpqm2 <- mean(score.gpqm2)




scores <- c(score.trmm,score.era5, score.pqm, score.eqm, score.gpqm, score.gpqm2)
names(scores) <- c("TRMM","ERA5","PQM-WT1","EQM-WT1","GPQM-WT1","GPQM2-WT1")
scores <- sort(scores, decreasing = T)
```
```{r}
scores.st1.wt1 <- scores
```

### WT2
```{r}
station.obs.cl2 <- subsetDimension(station.obs, dimension = "time", indices = which(kmModel5$cluster == 2))


station.trmm.cl2 <- subsetDimension(station.trmm, dimension = "time", indices = which(kmModel5$cluster == 2))

station.era5.cl2 <- subsetDimension(station.era5, dimension = "time", indices = which(kmModel5$cluster == 2))
```

```{r}
index.obs.cl2 <- valueIndex1D(station.obs.cl2$Data[!is.na(station.obs.cl2$Data)],index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))
index.obs.cl2 <- c(index.obs.cl2, valueIndex1D(station.obs.cl2$Data[!is.na(station.obs.cl2$Data)], index.codes = "P98WetAmount"))
index.obs.cl2.rv20max <- MaxReturnValue(station.obs.cl2)
index.obs.cl2 <- c(index.obs.cl2, index.obs.cl2.rv20max)

index.trmm.cl2 <- valueIndex1D(station.trmm.cl2$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.trmm.cl2.rv20max <- MaxReturnValue(station.trmm.cl2)
index.trmm.cl2 <- c(index.trmm.cl2, index.trmm.cl2.rv20max)

index.era5.cl2 <- valueIndex1D(station.era5.cl2$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.era5.cl2.rv20max <- MaxReturnValue(station.era5.cl2)
index.era5.cl2 <- c(index.era5.cl2, index.era5.cl2.rv20max)
```

```{r}
cal.station.cl2 <- biasCorrection(y = station.obs.cl2, x = station.trmm.cl2, precipitation = TRUE,  method = "pqm")


cal.station.cl2 <- subsetDimension(cal.station.cl2, dimension = "time", indices = which(!is.na(cal.station.cl2$Data)))

cal.station.cl2$Dates$start <- as.POSIXct(cal.station.cl2$Dates$start,tz = "GMT")
cal.station.cl2$Dates$end <- as.POSIXct(cal.station.cl2$Dates$end,tz = "GMT")

index.cal.station.cl2 <- valueIndex1D(cal.station.cl2$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl2 <- c(index.cal.station.cl2, valueIndex1D(cal.station.cl2$Data[!is.na(cal.station.cl2$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl2.rv20max <- MaxReturnValue(cal.station.cl2)

index.cal.station.cl2 <- c(index.cal.station.cl2, index.cal.station.cl2.rv20max)

index.cal.station.pqm.cl2 <- index.cal.station.cl2


```


```{r}
cal.station.cl2 <- biasCorrection(y = station.obs.cl2, x = station.trmm.cl2, precipitation = TRUE,  method = "eqm")


cal.station.cl2 <- subsetDimension(cal.station.cl2, dimension = "time", indices = which(!is.na(cal.station.cl2$Data)))

cal.station.cl2$Dates$start <- as.POSIXct(cal.station.cl2$Dates$start,tz = "GMT")
cal.station.cl2$Dates$end <- as.POSIXct(cal.station.cl2$Dates$end,tz = "GMT")

index.cal.station.cl2 <- valueIndex1D(cal.station.cl2$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl2 <- c(index.cal.station.cl2, valueIndex1D(cal.station.cl2$Data[!is.na(cal.station.cl2$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl2.rv20max <- MaxReturnValue(cal.station.cl2)

index.cal.station.cl2 <- c(index.cal.station.cl2, index.cal.station.cl2.rv20max)

index.cal.station.eqm.cl2 <- index.cal.station.cl2


```

```{r}
cal.station.cl2 <- biasCorrection(y = station.obs.cl2, x = station.trmm.cl2, precipitation = TRUE,  method = "gpqm")


cal.station.cl2 <- subsetDimension(cal.station.cl2, dimension = "time", indices = which(!is.na(cal.station.cl2$Data)))

cal.station.cl2$Dates$start <- as.POSIXct(cal.station.cl2$Dates$start,tz = "GMT")
cal.station.cl2$Dates$end <- as.POSIXct(cal.station.cl2$Dates$end,tz = "GMT")

index.cal.station.cl2 <- valueIndex1D(cal.station.cl2$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl2 <- c(index.cal.station.cl2, valueIndex1D(cal.station.cl2$Data[!is.na(cal.station.cl2$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl2.rv20max <- MaxReturnValue(cal.station.cl2)

index.cal.station.cl2 <- c(index.cal.station.cl2, index.cal.station.cl2.rv20max)

index.cal.station.gpqm.cl2 <- index.cal.station.cl2


```


```{r}
cal.station.cl2 <- biasCorrection(y = station.obs.cl2, x = station.trmm.cl2, precipitation = TRUE,  method = "gpqm" , theta = .7)


cal.station.cl2 <- subsetDimension(cal.station.cl2, dimension = "time", indices = which(!is.na(cal.station.cl2$Data)))

cal.station.cl2$Dates$start <- as.POSIXct(cal.station.cl2$Dates$start,tz = "GMT")
cal.station.cl2$Dates$end <- as.POSIXct(cal.station.cl2$Dates$end,tz = "GMT")

index.cal.station.cl2 <- valueIndex1D(cal.station.cl2$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl2 <- c(index.cal.station.cl2, valueIndex1D(cal.station.cl2$Data[!is.na(cal.station.cl2$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl2.rv20max <- MaxReturnValue(cal.station.cl2)

index.cal.station.cl2 <- c(index.cal.station.cl2, index.cal.station.cl2.rv20max)

index.cal.station.gpqm2.cl2 <- index.cal.station.cl2


```



```{r}
measures <- list()
for (i in c(1:9)) {
  measures[[length(measures)+1]] <- c(abs(index.trmm.cl2[i]-index.obs.cl2[i]),abs(index.era5.cl2[i]-index.obs.cl2[i]),abs(index.cal.station.pqm.cl2[i]-index.obs.cl2[i]), abs(index.cal.station.eqm.cl2[i]-index.obs.cl2[i]), abs(index.cal.station.gpqm.cl2[i]-index.obs.cl2[i]), abs(index.cal.station.gpqm2.cl2[i]-index.obs.cl2[i])) 
}

```

```{r}
norm.vector <- list()
for (i in c(1:length(measures))) {
  norm.vector[[length(norm.vector)+1]] <- normalization(measures[[i]]) 
}
```

```{r}
score.trmm <- c()
for (i in c(1:9)) {
  score.trmm <- c(score.trmm, norm.vector[[i]][1]) 
}
score.trmm <- mean(score.trmm)

score.era5 <- c()
for (i in c(1:9)) {
  score.era5 <- c(score.era5, norm.vector[[i]][2]) 
}
score.era5 <- mean(score.era5)

score.pqm <- c()
for (i in c(1:9)) {
  score.pqm <- c(score.pqm, norm.vector[[i]][3]) 
}
score.pqm <- mean(score.pqm)


score.eqm <- c()
for (i in c(1:9)) {
  score.eqm <- c(score.eqm, norm.vector[[i]][4]) 
}
score.eqm <- mean(score.eqm)


score.gpqm <- c()
for (i in c(1:9)) {
  score.gpqm <- c(score.gpqm, norm.vector[[i]][5]) 
}
score.gpqm <- mean(score.gpqm)

score.gpqm2 <- c()
for (i in c(1:9)) {
  score.gpqm2 <- c(score.gpqm2, norm.vector[[i]][6]) 
}
score.gpqm2 <- mean(score.gpqm2)

scores <- c(score.trmm, score.era5, score.pqm, score.eqm, score.gpqm, score.gpqm2)
names(scores) <- c("TRMM","ERA5","PQM-WT1","EQM-WT1","GPQM-WT1","GPQM2-WT1")
scores <- sort(scores, decreasing = T)
scores
```
```{r}
scores.st1.wt2 <- scores
```

### WT3

```{r}
station.obs.cl3 <- subsetDimension(station.obs, dimension = "time", indices = which(kmModel5$cluster == 3))


station.trmm.cl3 <- subsetDimension(station.trmm, dimension = "time", indices = which(kmModel5$cluster == 3))

station.era5.cl3 <- subsetDimension(station.era5, dimension = "time", indices = which(kmModel5$cluster == 3))
```

```{r}
index.obs.cl3 <- valueIndex1D(station.obs.cl3$Data[!is.na(station.obs.cl3$Data)],index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))
index.obs.cl3 <- c(index.obs.cl3, valueIndex1D(station.obs.cl3$Data[!is.na(station.obs.cl3$Data)], index.codes = "P98WetAmount"))
index.obs.cl3.rv20max <- MaxReturnValue(station.obs.cl3)
index.obs.cl3 <- c(index.obs.cl3, index.obs.cl3.rv20max)

index.trmm.cl3 <- valueIndex1D(station.trmm.cl3$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.trmm.cl3.rv20max <- MaxReturnValue(station.trmm.cl3)
index.trmm.cl3 <- c(index.trmm.cl3, index.trmm.cl3.rv20max)

index.era5.cl3 <- valueIndex1D(station.era5.cl3$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.era5.cl3.rv20max <- MaxReturnValue(station.era5.cl3)
index.era5.cl3 <- c(index.era5.cl3, index.era5.cl3.rv20max)
```

```{r}
cal.station.cl3 <- biasCorrection(y = station.obs.cl3, x = station.trmm.cl3, precipitation = TRUE,  method = "pqm")


cal.station.cl3 <- subsetDimension(cal.station.cl3, dimension = "time", indices = which(!is.na(cal.station.cl3$Data)))

cal.station.cl3$Dates$start <- as.POSIXct(cal.station.cl3$Dates$start,tz = "GMT")
cal.station.cl3$Dates$end <- as.POSIXct(cal.station.cl3$Dates$end,tz = "GMT")

index.cal.station.cl3 <- valueIndex1D(cal.station.cl3$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl3 <- c(index.cal.station.cl3, valueIndex1D(cal.station.cl3$Data[!is.na(cal.station.cl3$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl3.rv20max <- MaxReturnValue(cal.station.cl3)

index.cal.station.cl3 <- c(index.cal.station.cl3, index.cal.station.cl3.rv20max)

index.cal.station.pqm.cl3 <- index.cal.station.cl3


```


```{r}
cal.station.cl3 <- biasCorrection(y = station.obs.cl3, x = station.trmm.cl3, precipitation = TRUE,  method = "eqm")


cal.station.cl3 <- subsetDimension(cal.station.cl3, dimension = "time", indices = which(!is.na(cal.station.cl3$Data)))

cal.station.cl3$Dates$start <- as.POSIXct(cal.station.cl3$Dates$start,tz = "GMT")
cal.station.cl3$Dates$end <- as.POSIXct(cal.station.cl3$Dates$end,tz = "GMT")

index.cal.station.cl3 <- valueIndex1D(cal.station.cl3$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl3 <- c(index.cal.station.cl3, valueIndex1D(cal.station.cl3$Data[!is.na(cal.station.cl3$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl3.rv20max <- MaxReturnValue(cal.station.cl3)

index.cal.station.cl3 <- c(index.cal.station.cl3, index.cal.station.cl3.rv20max)

index.cal.station.eqm.cl3 <- index.cal.station.cl3


```

```{r}
cal.station.cl3 <- biasCorrection(y = station.obs.cl3, x = station.trmm.cl3, precipitation = TRUE,  method = "gpqm")


cal.station.cl3 <- subsetDimension(cal.station.cl3, dimension = "time", indices = which(!is.na(cal.station.cl3$Data)))

cal.station.cl3$Dates$start <- as.POSIXct(cal.station.cl3$Dates$start,tz = "GMT")
cal.station.cl3$Dates$end <- as.POSIXct(cal.station.cl3$Dates$end,tz = "GMT")

index.cal.station.cl3 <- valueIndex1D(cal.station.cl3$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl3 <- c(index.cal.station.cl3, valueIndex1D(cal.station.cl3$Data[!is.na(cal.station.cl3$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl3.rv20max <- MaxReturnValue(cal.station.cl3)

index.cal.station.cl3 <- c(index.cal.station.cl3, index.cal.station.cl3.rv20max)

index.cal.station.gpqm.cl3 <- index.cal.station.cl3


```


```{r}
cal.station.cl3 <- biasCorrection(y = station.obs.cl3, x = station.trmm.cl3, precipitation = TRUE,  method = "gpqm" , theta = .7)


cal.station.cl3 <- subsetDimension(cal.station.cl3, dimension = "time", indices = which(!is.na(cal.station.cl3$Data)))

cal.station.cl3$Dates$start <- as.POSIXct(cal.station.cl3$Dates$start,tz = "GMT")
cal.station.cl3$Dates$end <- as.POSIXct(cal.station.cl3$Dates$end,tz = "GMT")

index.cal.station.cl3 <- valueIndex1D(cal.station.cl3$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl3 <- c(index.cal.station.cl3, valueIndex1D(cal.station.cl3$Data[!is.na(cal.station.cl3$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl3.rv20max <- MaxReturnValue(cal.station.cl3)

index.cal.station.cl3 <- c(index.cal.station.cl3, index.cal.station.cl3.rv20max)

index.cal.station.gpqm2.cl3 <- index.cal.station.cl3


```



```{r}
measures <- list()
for (i in c(1:9)) {
  measures[[length(measures)+1]] <- c(abs(index.trmm.cl3[i]-index.obs.cl3[i]),abs(index.era5.cl3[i]-index.obs.cl3[i]),abs(index.cal.station.pqm.cl3[i]-index.obs.cl3[i]), abs(index.cal.station.eqm.cl3[i]-index.obs.cl3[i]), abs(index.cal.station.gpqm.cl3[i]-index.obs.cl3[i]), abs(index.cal.station.gpqm2.cl3[i]-index.obs.cl3[i])) 
}

```

```{r}
norm.vector <- list()
for (i in c(1:length(measures))) {
  norm.vector[[length(norm.vector)+1]] <- normalization(measures[[i]]) 
}
```

```{r}
score.trmm <- c()
for (i in c(1:9)) {
  score.trmm <- c(score.trmm, norm.vector[[i]][1]) 
}
score.trmm <- mean(score.trmm)

score.era5 <- c()
for (i in c(1:9)) {
  score.era5 <- c(score.era5, norm.vector[[i]][2]) 
}
score.era5 <- mean(score.era5)

score.pqm <- c()
for (i in c(1:9)) {
  score.pqm <- c(score.pqm, norm.vector[[i]][3]) 
}
score.pqm <- mean(score.pqm)


score.eqm <- c()
for (i in c(1:9)) {
  score.eqm <- c(score.eqm, norm.vector[[i]][4]) 
}
score.eqm <- mean(score.eqm)


score.gpqm <- c()
for (i in c(1:9)) {
  score.gpqm <- c(score.gpqm, norm.vector[[i]][5]) 
}
score.gpqm <- mean(score.gpqm)

score.gpqm2 <- c()
for (i in c(1:9)) {
  score.gpqm2 <- c(score.gpqm2, norm.vector[[i]][6]) 
}
score.gpqm2 <- mean(score.gpqm2)


scores <- c(score.trmm,score.era5, score.pqm, score.eqm, score.gpqm, score.gpqm2)
names(scores) <- c("TRMM","ERA5","PQM-WT3","EQM-WT3","GPQM-WT3","GPQM2-WT3")
scores <- sort(scores, decreasing = T)
scores
```
```{r}
scores.st1.wt3 <- scores
```
### WT4

```{r}
station.obs.cl4 <- subsetDimension(station.obs, dimension = "time", indices = which(kmModel5$cluster == 4))


station.trmm.cl4 <- subsetDimension(station.trmm, dimension = "time", indices = which(kmModel5$cluster == 4))

station.era5.cl4 <- subsetDimension(station.era5, dimension = "time", indices = which(kmModel5$cluster == 4))
```

```{r}
index.obs.cl4 <- valueIndex1D(station.obs.cl4$Data[!is.na(station.obs.cl4$Data)],index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))
index.obs.cl4 <- c(index.obs.cl4, valueIndex1D(station.obs.cl4$Data[!is.na(station.obs.cl4$Data)], index.codes = "P98WetAmount"))
index.obs.cl4.rv20max <- MaxReturnValue(station.obs.cl4)
index.obs.cl4 <- c(index.obs.cl4, index.obs.cl4.rv20max)

index.trmm.cl4 <- valueIndex1D(station.trmm.cl4$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.trmm.cl4.rv20max <- MaxReturnValue(station.trmm.cl4)
index.trmm.cl4 <- c(index.trmm.cl4, index.trmm.cl4.rv20max)

index.era5.cl4 <- valueIndex1D(station.era5.cl4$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.era5.cl4.rv20max <- MaxReturnValue(station.era5.cl4)
index.era5.cl4 <- c(index.era5.cl4, index.era5.cl4.rv20max)
```

```{r}
cal.station.cl4 <- biasCorrection(y = station.obs.cl4, x = station.trmm.cl4, precipitation = TRUE,  method = "pqm")


cal.station.cl4 <- subsetDimension(cal.station.cl4, dimension = "time", indices = which(!is.na(cal.station.cl4$Data)))

cal.station.cl4$Dates$start <- as.POSIXct(cal.station.cl4$Dates$start,tz = "GMT")
cal.station.cl4$Dates$end <- as.POSIXct(cal.station.cl4$Dates$end,tz = "GMT")

index.cal.station.cl4 <- valueIndex1D(cal.station.cl4$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl4 <- c(index.cal.station.cl4, valueIndex1D(cal.station.cl4$Data[!is.na(cal.station.cl4$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl4.rv20max <- MaxReturnValue(cal.station.cl4)

index.cal.station.cl4 <- c(index.cal.station.cl4, index.cal.station.cl4.rv20max)

index.cal.station.pqm.cl4 <- index.cal.station.cl4


```


```{r}
cal.station.cl4 <- biasCorrection(y = station.obs.cl4, x = station.trmm.cl4, precipitation = TRUE,  method = "eqm")


cal.station.cl4 <- subsetDimension(cal.station.cl4, dimension = "time", indices = which(!is.na(cal.station.cl4$Data)))

cal.station.cl4$Dates$start <- as.POSIXct(cal.station.cl4$Dates$start,tz = "GMT")
cal.station.cl4$Dates$end <- as.POSIXct(cal.station.cl4$Dates$end,tz = "GMT")

index.cal.station.cl4 <- valueIndex1D(cal.station.cl4$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl4 <- c(index.cal.station.cl4, valueIndex1D(cal.station.cl4$Data[!is.na(cal.station.cl4$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl4.rv20max <- MaxReturnValue(cal.station.cl4)

index.cal.station.cl4 <- c(index.cal.station.cl4, index.cal.station.cl4.rv20max)

index.cal.station.eqm.cl4 <- index.cal.station.cl4


```

```{r}
cal.station.cl4 <- biasCorrection(y = station.obs.cl4, x = station.trmm.cl4, precipitation = TRUE,  method = "gpqm")


cal.station.cl4 <- subsetDimension(cal.station.cl4, dimension = "time", indices = which(!is.na(cal.station.cl4$Data)))

cal.station.cl4$Dates$start <- as.POSIXct(cal.station.cl4$Dates$start,tz = "GMT")
cal.station.cl4$Dates$end <- as.POSIXct(cal.station.cl4$Dates$end,tz = "GMT")

index.cal.station.cl4 <- valueIndex1D(cal.station.cl4$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl4 <- c(index.cal.station.cl4, valueIndex1D(cal.station.cl4$Data[!is.na(cal.station.cl4$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl4.rv20max <- MaxReturnValue(cal.station.cl4)

index.cal.station.cl4 <- c(index.cal.station.cl4, index.cal.station.cl4.rv20max)

index.cal.station.gpqm.cl4 <- index.cal.station.cl4


```


```{r}
cal.station.cl4 <- biasCorrection(y = station.obs.cl4, x = station.trmm.cl4, precipitation = TRUE,  method = "gpqm" , theta = .7)


cal.station.cl4 <- subsetDimension(cal.station.cl4, dimension = "time", indices = which(!is.na(cal.station.cl4$Data)))

cal.station.cl4$Dates$start <- as.POSIXct(cal.station.cl4$Dates$start,tz = "GMT")
cal.station.cl4$Dates$end <- as.POSIXct(cal.station.cl4$Dates$end,tz = "GMT")

index.cal.station.cl4 <- valueIndex1D(cal.station.cl4$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl4 <- c(index.cal.station.cl4, valueIndex1D(cal.station.cl4$Data[!is.na(cal.station.cl4$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl4.rv20max <- MaxReturnValue(cal.station.cl4)

index.cal.station.cl4 <- c(index.cal.station.cl4, index.cal.station.cl4.rv20max)

index.cal.station.gpqm2.cl4 <- index.cal.station.cl4


```



```{r}
measures <- list()
for (i in c(1:9)) {
  measures[[length(measures)+1]] <- c(abs(index.trmm.cl4[i]-index.obs.cl4[i]),abs(index.era5.cl4[i]-index.obs.cl4[i]),abs(index.cal.station.pqm.cl4[i]-index.obs.cl4[i]), abs(index.cal.station.eqm.cl4[i]-index.obs.cl4[i]), abs(index.cal.station.gpqm.cl4[i]-index.obs.cl4[i]), abs(index.cal.station.gpqm2.cl4[i]-index.obs.cl4[i])) 
}

```

```{r}
norm.vector <- list()
for (i in c(1:length(measures))) {
  norm.vector[[length(norm.vector)+1]] <- normalization(measures[[i]]) 
}
```

```{r}
score.trmm <- c()
for (i in c(1:9)) {
  score.trmm <- c(score.trmm, norm.vector[[i]][1]) 
}
score.trmm <- mean(score.trmm)

score.era5 <- c()
for (i in c(1:9)) {
  score.era5 <- c(score.era5, norm.vector[[i]][2]) 
}
score.era5 <- mean(score.era5)

score.pqm <- c()
for (i in c(1:9)) {
  score.pqm <- c(score.pqm, norm.vector[[i]][3]) 
}
score.pqm <- mean(score.pqm)


score.eqm <- c()
for (i in c(1:9)) {
  score.eqm <- c(score.eqm, norm.vector[[i]][4]) 
}
score.eqm <- mean(score.eqm)


score.gpqm <- c()
for (i in c(1:9)) {
  score.gpqm <- c(score.gpqm, norm.vector[[i]][5]) 
}
score.gpqm <- mean(score.gpqm)

score.gpqm.cl5 <- c()


score.gpqm2 <- c()
for (i in c(1:9)) {
  score.gpqm2 <- c(score.gpqm2, norm.vector[[i]][6]) 
}
score.gpqm2 <- mean(score.gpqm2)



scores <- c(score.trmm,score.era5, score.pqm, score.eqm, score.gpqm, score.gpqm2)
names(scores) <- c("TRMM","ERA5","PQM-WT4","EQM-WT4","GPQM-WT4","GPQM2-WT4")
scores <- sort(scores, decreasing = T)
scores
```
```{r}
scores.st1.wt4 <- scores
```
### WT5

```{r}
station.obs.cl5 <- subsetDimension(station.obs, dimension = "time", indices = which(kmModel5$cluster == 5))


station.trmm.cl5 <- subsetDimension(station.trmm, dimension = "time", indices = which(kmModel5$cluster == 5))

station.era5.cl5 <- subsetDimension(station.era5, dimension = "time", indices = which(kmModel5$cluster == 5))
```

```{r}
index.obs.cl5 <- valueIndex1D(station.obs.cl5$Data[!is.na(station.obs.cl5$Data)],index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))
index.obs.cl5 <- c(index.obs.cl5, valueIndex1D(station.obs.cl5$Data[!is.na(station.obs.cl5$Data)], index.codes = "P98WetAmount"))
index.obs.cl5.rv20max <- MaxReturnValue(station.obs.cl5)
index.obs.cl5 <- c(index.obs.cl5, index.obs.cl5.rv20max)

index.trmm.cl5 <- valueIndex1D(station.trmm.cl5$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.trmm.cl5.rv20max <- MaxReturnValue(station.trmm.cl5)
index.trmm.cl5 <- c(index.trmm.cl5, index.trmm.cl5.rv20max)

index.era5.cl5 <- valueIndex1D(station.era5.cl5$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.era5.cl5.rv20max <- MaxReturnValue(station.era5.cl5)
index.era5.cl5 <- c(index.era5.cl5, index.era5.cl5.rv20max)
```

```{r}
cal.station.cl5 <- biasCorrection(y = station.obs.cl5, x = station.trmm.cl5, precipitation = TRUE,  method = "pqm")


cal.station.cl5 <- subsetDimension(cal.station.cl5, dimension = "time", indices = which(!is.na(cal.station.cl5$Data)))

cal.station.cl5$Dates$start <- as.POSIXct(cal.station.cl5$Dates$start,tz = "GMT")
cal.station.cl5$Dates$end <- as.POSIXct(cal.station.cl5$Dates$end,tz = "GMT")

index.cal.station.cl5 <- valueIndex1D(cal.station.cl5$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl5 <- c(index.cal.station.cl5, valueIndex1D(cal.station.cl5$Data[!is.na(cal.station.cl5$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl5.rv20max <- MaxReturnValue(cal.station.cl5)

index.cal.station.cl5 <- c(index.cal.station.cl5, index.cal.station.cl5.rv20max)

index.cal.station.pqm.cl5 <- index.cal.station.cl5


```


```{r}
cal.station.cl5 <- biasCorrection(y = station.obs.cl5, x = station.trmm.cl5, precipitation = TRUE,  method = "eqm")


cal.station.cl5 <- subsetDimension(cal.station.cl5, dimension = "time", indices = which(!is.na(cal.station.cl5$Data)))

cal.station.cl5$Dates$start <- as.POSIXct(cal.station.cl5$Dates$start,tz = "GMT")
cal.station.cl5$Dates$end <- as.POSIXct(cal.station.cl5$Dates$end,tz = "GMT")

index.cal.station.cl5 <- valueIndex1D(cal.station.cl5$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl5 <- c(index.cal.station.cl5, valueIndex1D(cal.station.cl5$Data[!is.na(cal.station.cl5$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl5.rv20max <- MaxReturnValue(cal.station.cl5)

index.cal.station.cl5 <- c(index.cal.station.cl5, index.cal.station.cl5.rv20max)

index.cal.station.eqm.cl5 <- index.cal.station.cl5


```

```{r}
cal.station.cl5 <- biasCorrection(y = station.obs.cl5, x = station.trmm.cl5, precipitation = TRUE,  method = "gpqm")


cal.station.cl5 <- subsetDimension(cal.station.cl5, dimension = "time", indices = which(!is.na(cal.station.cl5$Data)))

cal.station.cl5$Dates$start <- as.POSIXct(cal.station.cl5$Dates$start,tz = "GMT")
cal.station.cl5$Dates$end <- as.POSIXct(cal.station.cl5$Dates$end,tz = "GMT")

index.cal.station.cl5 <- valueIndex1D(cal.station.cl5$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl5 <- c(index.cal.station.cl5, valueIndex1D(cal.station.cl5$Data[!is.na(cal.station.cl5$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl5.rv20max <- MaxReturnValue(cal.station.cl5)

index.cal.station.cl5 <- c(index.cal.station.cl5, index.cal.station.cl5.rv20max)

index.cal.station.gpqm.cl5 <- index.cal.station.cl5


```


```{r}
cal.station.cl5 <- biasCorrection(y = station.obs.cl5, x = station.trmm.cl5, precipitation = TRUE,  method = "gpqm" , theta = .7)


cal.station.cl5 <- subsetDimension(cal.station.cl5, dimension = "time", indices = which(!is.na(cal.station.cl5$Data)))

cal.station.cl5$Dates$start <- as.POSIXct(cal.station.cl5$Dates$start,tz = "GMT")
cal.station.cl5$Dates$end <- as.POSIXct(cal.station.cl5$Dates$end,tz = "GMT")

index.cal.station.cl5 <- valueIndex1D(cal.station.cl5$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl5 <- c(index.cal.station.cl5, valueIndex1D(cal.station.cl5$Data[!is.na(cal.station.cl5$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl5.rv20max <- MaxReturnValue(cal.station.cl5)

index.cal.station.cl5 <- c(index.cal.station.cl5, index.cal.station.cl5.rv20max)

index.cal.station.gpqm2.cl5 <- index.cal.station.cl5


```



```{r}
measures <- list()
for (i in c(1:9)) {
  measures[[length(measures)+1]] <- c(abs(index.trmm.cl5[i]-index.obs.cl5[i]),abs(index.era5.cl5[i]-index.obs.cl5[i]),abs(index.cal.station.pqm.cl5[i]-index.obs.cl5[i]), abs(index.cal.station.eqm.cl5[i]-index.obs.cl5[i]), abs(index.cal.station.gpqm.cl5[i]-index.obs.cl5[i]), abs(index.cal.station.gpqm2.cl5[i]-index.obs.cl5[i])) 
}

```

```{r}
norm.vector <- list()
for (i in c(1:length(measures))) {
  norm.vector[[length(norm.vector)+1]] <- normalization(measures[[i]]) 
}
```

```{r}
score.trmm <- c()
for (i in c(1:9)) {
  score.trmm <- c(score.trmm, norm.vector[[i]][1]) 
}
score.trmm <- mean(score.trmm)

score.era5 <- c()
for (i in c(1:9)) {
  score.era5 <- c(score.era5, norm.vector[[i]][1]) 
}
score.era5 <- mean(score.era5)

score.pqm <- c()
for (i in c(1:9)) {
  score.pqm <- c(score.pqm, norm.vector[[i]][2]) 
}
score.pqm <- mean(score.pqm)


score.eqm <- c()
for (i in c(1:9)) {
  score.eqm <- c(score.eqm, norm.vector[[i]][3]) 
}
score.eqm <- mean(score.eqm)


score.gpqm <- c()
for (i in c(1:9)) {
  score.gpqm <- c(score.gpqm, norm.vector[[i]][4]) 
}
score.gpqm <- mean(score.gpqm)



score.gpqm2 <- c()
for (i in c(1:9)) {
  score.gpqm2 <- c(score.gpqm2, norm.vector[[i]][5]) 
}
score.gpqm2 <- mean(score.gpqm2)


scores <- c(score.trmm, score.era5, score.pqm, score.eqm, score.gpqm, score.gpqm2)
names(scores) <- c("TRMM","ERA5","PQM-WT5","EQM-WT5","GPQM-WT5","GPQM2-WT5")
scores <- sort(scores, decreasing = T)
scores
```
```{r}
scores.st1.wt5 <- scores
```


## Alofi,Niue


```{r}
i=2

station.trmm <- subsetGrid(precip_trmm, station.id = precip_trmm$Metadata$station_id[i])
station.obs <- subsetGrid(precip_obs, station.id = precip_trmm$Metadata$station_id[i])

idx <- which.min(abs(pp_reanalysis$xyCoords$x - station.obs$xyCoords$x))
lon <- pp_reanalysis$xyCoords$x[idx]
  
idx2 <- which.min(abs(pp_reanalysis$xyCoords$y - station.obs$xyCoords$y))
lat <- pp_reanalysis$xyCoords$y[idx2]
  
station.era5 <- subsetGrid(pp_reanalysis, lonLim = lon, latLim = lat)
```


````{r}
index.obs <- valueIndex1D(station.obs$Data[!is.na(station.obs$Data)],index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))
index.obs <- c(index.obs, valueIndex1D(station.obs$Data[!is.na(station.obs$Data)], index.codes = "P98WetAmount"))
index.obs.rv20max <- MaxReturnValue(station.obs)
index.obs <- c(index.obs, index.obs.rv20max)

index.trmm <- valueIndex1D(station.trmm$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.trmm.rv20max <- MaxReturnValue(station.trmm)
index.trmm <- c(index.trmm, index.trmm.rv20max)

index.era5 <- valueIndex1D(station.era5$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.era5.rv20max <- MaxReturnValue(station.era5)
index.era5 <- c(index.era5, index.era5.rv20max)

```



### WT1

```{r}
station.obs.cl1 <- subsetDimension(station.obs, dimension = "time", indices = which(kmModel5$cluster == 1))


station.trmm.cl1 <- subsetDimension(station.trmm, dimension = "time", indices = which(kmModel5$cluster == 1))

station.era5.cl1 <- subsetDimension(station.era5, dimension = "time", indices = which(kmModel5$cluster == 1))
```

```{r}
index.obs.cl1 <- valueIndex1D(station.obs.cl1$Data[!is.na(station.obs.cl1$Data)],index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))
index.obs.cl1 <- c(index.obs.cl1, valueIndex1D(station.obs.cl1$Data[!is.na(station.obs.cl1$Data)], index.codes = "P98WetAmount"))
index.obs.cl1.rv20max <- MaxReturnValue(station.obs.cl1)
index.obs.cl1 <- c(index.obs.cl1, index.obs.cl1.rv20max)

index.trmm.cl1 <- valueIndex1D(station.trmm.cl1$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.trmm.cl1.rv20max <- MaxReturnValue(station.trmm.cl1)
index.trmm.cl1 <- c(index.trmm.cl1, index.trmm.cl1.rv20max)

index.era5.cl1 <- valueIndex1D(station.era5.cl1$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.era5.cl1.rv20max <- MaxReturnValue(station.era5.cl1)
index.era5.cl1 <- c(index.era5.cl1, index.era5.cl1.rv20max)
```

```{r}
cal.station.cl1 <- biasCorrection(y = station.obs.cl1, x = station.trmm.cl1, precipitation = TRUE,  method = "pqm")


cal.station.cl1 <- subsetDimension(cal.station.cl1, dimension = "time", indices = which(!is.na(cal.station.cl1$Data)))

cal.station.cl1$Dates$start <- as.POSIXct(cal.station.cl1$Dates$start,tz = "GMT")
cal.station.cl1$Dates$end <- as.POSIXct(cal.station.cl1$Dates$end,tz = "GMT")

index.cal.station.cl1 <- valueIndex1D(cal.station.cl1$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl1 <- c(index.cal.station.cl1, valueIndex1D(cal.station.cl1$Data[!is.na(cal.station.cl1$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl1.rv20max <- MaxReturnValue(cal.station.cl1)

index.cal.station.cl1 <- c(index.cal.station.cl1, index.cal.station.cl1.rv20max)

index.cal.station.pqm.cl1 <- index.cal.station.cl1


```


```{r}
cal.station.cl1 <- biasCorrection(y = station.obs.cl1, x = station.trmm.cl1, precipitation = TRUE,  method = "eqm")


cal.station.cl1 <- subsetDimension(cal.station.cl1, dimension = "time", indices = which(!is.na(cal.station.cl1$Data)))

cal.station.cl1$Dates$start <- as.POSIXct(cal.station.cl1$Dates$start,tz = "GMT")
cal.station.cl1$Dates$end <- as.POSIXct(cal.station.cl1$Dates$end,tz = "GMT")

index.cal.station.cl1 <- valueIndex1D(cal.station.cl1$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl1 <- c(index.cal.station.cl1, valueIndex1D(cal.station.cl1$Data[!is.na(cal.station.cl1$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl1.rv20max <- MaxReturnValue(cal.station.cl1)

index.cal.station.cl1 <- c(index.cal.station.cl1, index.cal.station.cl1.rv20max)

index.cal.station.eqm.cl1 <- index.cal.station.cl1


```

```{r}
cal.station.cl1 <- biasCorrection(y = station.obs.cl1, x = station.trmm.cl1, precipitation = TRUE,  method = "gpqm")


cal.station.cl1 <- subsetDimension(cal.station.cl1, dimension = "time", indices = which(!is.na(cal.station.cl1$Data)))

cal.station.cl1$Dates$start <- as.POSIXct(cal.station.cl1$Dates$start,tz = "GMT")
cal.station.cl1$Dates$end <- as.POSIXct(cal.station.cl1$Dates$end,tz = "GMT")

index.cal.station.cl1 <- valueIndex1D(cal.station.cl1$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl1 <- c(index.cal.station.cl1, valueIndex1D(cal.station.cl1$Data[!is.na(cal.station.cl1$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl1.rv20max <- MaxReturnValue(cal.station.cl1)

index.cal.station.cl1 <- c(index.cal.station.cl1, index.cal.station.cl1.rv20max)

index.cal.station.gpqm.cl1 <- index.cal.station.cl1


```


```{r}
cal.station.cl1 <- biasCorrection(y = station.obs.cl1, x = station.trmm.cl1, precipitation = TRUE,  method = "gpqm" , theta = .7)


cal.station.cl1 <- subsetDimension(cal.station.cl1, dimension = "time", indices = which(!is.na(cal.station.cl1$Data)))

cal.station.cl1$Dates$start <- as.POSIXct(cal.station.cl1$Dates$start,tz = "GMT")
cal.station.cl1$Dates$end <- as.POSIXct(cal.station.cl1$Dates$end,tz = "GMT")

index.cal.station.cl1 <- valueIndex1D(cal.station.cl1$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl1 <- c(index.cal.station.cl1, valueIndex1D(cal.station.cl1$Data[!is.na(cal.station.cl1$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl1.rv20max <- MaxReturnValue(cal.station.cl1)

index.cal.station.cl1 <- c(index.cal.station.cl1, index.cal.station.cl1.rv20max)

index.cal.station.gpqm2.cl1 <- index.cal.station.cl1


```



```{r}
measures <- list()
for (i in c(1:9)) {
  measures[[length(measures)+1]] <- c(abs(index.trmm.cl1[i]-index.obs.cl1[i]),abs(index.era5.cl1[i]-index.obs.cl1[i]),abs(index.cal.station.pqm.cl1[i]-index.obs.cl1[i]), abs(index.cal.station.eqm.cl1[i]-index.obs.cl1[i]), abs(index.cal.station.gpqm.cl1[i]-index.obs.cl1[i]), abs(index.cal.station.gpqm2.cl1[i]-index.obs.cl1[i])) 
}

```

```{r}
normalization <- function(measure){
  measure.norm <- c()
  #measure must be a vector with the value of a certain measure of different calibrations
  for (i in c(1:length(measure))) {
    measure.norm <- c(measure.norm, 1-((measure[i]-min(measure))/(max(measure)-min(measure))))
  }
  return(measure.norm)
}
```

```{r}
norm.vector <- list()
for (i in c(1:length(measures))) {
  norm.vector[[length(norm.vector)+1]] <- normalization(measures[[i]]) 
}
```

```{r}
score.trmm <- c()
for (i in c(1:9)) {
  score.trmm <- c(score.trmm, norm.vector[[i]][1]) 
}
score.trmm <- mean(score.trmm)

score.era5 <- c()
for (i in c(1:9)) {
  score.era5 <- c(score.era5, norm.vector[[i]][2]) 
}
score.era5 <- mean(score.era5)

score.pqm <- c()
for (i in c(1:9)) {
  score.pqm <- c(score.pqm, norm.vector[[i]][3]) 
}
score.pqm <- mean(score.pqm)


score.eqm <- c()
for (i in c(1:9)) {
  score.eqm <- c(score.eqm, norm.vector[[i]][4]) 
}
score.eqm <- mean(score.eqm)


score.gpqm <- c()
for (i in c(1:9)) {
  score.gpqm <- c(score.gpqm, norm.vector[[i]][5]) 
}
score.gpqm <- mean(score.gpqm)


score.gpqm2 <- c()
for (i in c(1:9)) {
  score.gpqm2 <- c(score.gpqm2, norm.vector[[i]][6]) 
}
score.gpqm2 <- mean(score.gpqm2)




scores <- c(score.trmm,score.era5, score.pqm, score.eqm, score.gpqm, score.gpqm2)
names(scores) <- c("TRMM","ERA5","PQM-WT1","EQM-WT1","GPQM-WT1","GPQM2-WT1")
scores <- sort(scores, decreasing = T)
scores
```
```{r}
scores.st2.wt1 <- scores
```
### WT2
```{r}
station.obs.cl2 <- subsetDimension(station.obs, dimension = "time", indices = which(kmModel5$cluster == 2))


station.trmm.cl2 <- subsetDimension(station.trmm, dimension = "time", indices = which(kmModel5$cluster == 2))

station.era5.cl2 <- subsetDimension(station.era5, dimension = "time", indices = which(kmModel5$cluster == 2))
```

```{r}
index.obs.cl2 <- valueIndex1D(station.obs.cl2$Data[!is.na(station.obs.cl2$Data)],index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))
index.obs.cl2 <- c(index.obs.cl2, valueIndex1D(station.obs.cl2$Data[!is.na(station.obs.cl2$Data)], index.codes = "P98WetAmount"))
index.obs.cl2.rv20max <- MaxReturnValue(station.obs.cl2)
index.obs.cl2 <- c(index.obs.cl2, index.obs.cl2.rv20max)

index.trmm.cl2 <- valueIndex1D(station.trmm.cl2$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.trmm.cl2.rv20max <- MaxReturnValue(station.trmm.cl2)
index.trmm.cl2 <- c(index.trmm.cl2, index.trmm.cl2.rv20max)

index.era5.cl2 <- valueIndex1D(station.era5.cl2$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.era5.cl2.rv20max <- MaxReturnValue(station.era5.cl2)
index.era5.cl2 <- c(index.era5.cl2, index.era5.cl2.rv20max)
```

```{r}
cal.station.cl2 <- biasCorrection(y = station.obs.cl2, x = station.trmm.cl2, precipitation = TRUE,  method = "pqm")


cal.station.cl2 <- subsetDimension(cal.station.cl2, dimension = "time", indices = which(!is.na(cal.station.cl2$Data)))

cal.station.cl2$Dates$start <- as.POSIXct(cal.station.cl2$Dates$start,tz = "GMT")
cal.station.cl2$Dates$end <- as.POSIXct(cal.station.cl2$Dates$end,tz = "GMT")

index.cal.station.cl2 <- valueIndex1D(cal.station.cl2$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl2 <- c(index.cal.station.cl2, valueIndex1D(cal.station.cl2$Data[!is.na(cal.station.cl2$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl2.rv20max <- MaxReturnValue(cal.station.cl2)

index.cal.station.cl2 <- c(index.cal.station.cl2, index.cal.station.cl2.rv20max)

index.cal.station.pqm.cl2 <- index.cal.station.cl2


```


```{r}
cal.station.cl2 <- biasCorrection(y = station.obs.cl2, x = station.trmm.cl2, precipitation = TRUE,  method = "eqm")


cal.station.cl2 <- subsetDimension(cal.station.cl2, dimension = "time", indices = which(!is.na(cal.station.cl2$Data)))

cal.station.cl2$Dates$start <- as.POSIXct(cal.station.cl2$Dates$start,tz = "GMT")
cal.station.cl2$Dates$end <- as.POSIXct(cal.station.cl2$Dates$end,tz = "GMT")

index.cal.station.cl2 <- valueIndex1D(cal.station.cl2$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl2 <- c(index.cal.station.cl2, valueIndex1D(cal.station.cl2$Data[!is.na(cal.station.cl2$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl2.rv20max <- MaxReturnValue(cal.station.cl2)

index.cal.station.cl2 <- c(index.cal.station.cl2, index.cal.station.cl2.rv20max)

index.cal.station.eqm.cl2 <- index.cal.station.cl2


```

```{r}
cal.station.cl2 <- biasCorrection(y = station.obs.cl2, x = station.trmm.cl2, precipitation = TRUE,  method = "gpqm")


cal.station.cl2 <- subsetDimension(cal.station.cl2, dimension = "time", indices = which(!is.na(cal.station.cl2$Data)))

cal.station.cl2$Dates$start <- as.POSIXct(cal.station.cl2$Dates$start,tz = "GMT")
cal.station.cl2$Dates$end <- as.POSIXct(cal.station.cl2$Dates$end,tz = "GMT")

index.cal.station.cl2 <- valueIndex1D(cal.station.cl2$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl2 <- c(index.cal.station.cl2, valueIndex1D(cal.station.cl2$Data[!is.na(cal.station.cl2$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl2.rv20max <- MaxReturnValue(cal.station.cl2)

index.cal.station.cl2 <- c(index.cal.station.cl2, index.cal.station.cl2.rv20max)

index.cal.station.gpqm.cl2 <- index.cal.station.cl2


```


```{r}
cal.station.cl2 <- biasCorrection(y = station.obs.cl2, x = station.trmm.cl2, precipitation = TRUE,  method = "gpqm" , theta = .7)


cal.station.cl2 <- subsetDimension(cal.station.cl2, dimension = "time", indices = which(!is.na(cal.station.cl2$Data)))

cal.station.cl2$Dates$start <- as.POSIXct(cal.station.cl2$Dates$start,tz = "GMT")
cal.station.cl2$Dates$end <- as.POSIXct(cal.station.cl2$Dates$end,tz = "GMT")

index.cal.station.cl2 <- valueIndex1D(cal.station.cl2$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl2 <- c(index.cal.station.cl2, valueIndex1D(cal.station.cl2$Data[!is.na(cal.station.cl2$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl2.rv20max <- MaxReturnValue(cal.station.cl2)

index.cal.station.cl2 <- c(index.cal.station.cl2, index.cal.station.cl2.rv20max)

index.cal.station.gpqm2.cl2 <- index.cal.station.cl2


```



```{r}
measures <- list()
for (i in c(1:9)) {
  measures[[length(measures)+1]] <- c(abs(index.trmm.cl2[i]-index.obs.cl2[i]),abs(index.era5.cl2[i]-index.obs.cl2[i]),abs(index.cal.station.pqm.cl2[i]-index.obs.cl2[i]), abs(index.cal.station.eqm.cl2[i]-index.obs.cl2[i]), abs(index.cal.station.gpqm.cl2[i]-index.obs.cl2[i]), abs(index.cal.station.gpqm2.cl2[i]-index.obs.cl2[i])) 
}

```

```{r}
norm.vector <- list()
for (i in c(1:length(measures))) {
  norm.vector[[length(norm.vector)+1]] <- normalization(measures[[i]]) 
}
```

```{r}
score.trmm <- c()
for (i in c(1:9)) {
  score.trmm <- c(score.trmm, norm.vector[[i]][1]) 
}
score.trmm <- mean(score.trmm)

score.era5 <- c()
for (i in c(1:9)) {
  score.era5 <- c(score.era5, norm.vector[[i]][2]) 
}
score.era5 <- mean(score.era5)

score.pqm <- c()
for (i in c(1:9)) {
  score.pqm <- c(score.pqm, norm.vector[[i]][3]) 
}
score.pqm <- mean(score.pqm)


score.eqm <- c()
for (i in c(1:9)) {
  score.eqm <- c(score.eqm, norm.vector[[i]][4]) 
}
score.eqm <- mean(score.eqm)


score.gpqm <- c()
for (i in c(1:9)) {
  score.gpqm <- c(score.gpqm, norm.vector[[i]][5]) 
}
score.gpqm <- mean(score.gpqm)

score.gpqm2 <- c()
for (i in c(1:9)) {
  score.gpqm2 <- c(score.gpqm2, norm.vector[[i]][6]) 
}
score.gpqm2 <- mean(score.gpqm2)

scores <- c(score.trmm, score.era5, score.pqm, score.eqm, score.gpqm, score.gpqm2)
names(scores) <- c("TRMM","ERA5","PQM-WT1","EQM-WT1","GPQM-WT1","GPQM2-WT1")
scores <- sort(scores, decreasing = T)
scores
```
```{r}
scores.st2.wt2 <- scores
```
### WT3

```{r}
station.obs.cl3 <- subsetDimension(station.obs, dimension = "time", indices = which(kmModel5$cluster == 3))


station.trmm.cl3 <- subsetDimension(station.trmm, dimension = "time", indices = which(kmModel5$cluster == 3))

station.era5.cl3 <- subsetDimension(station.era5, dimension = "time", indices = which(kmModel5$cluster == 3))
```

```{r}
index.obs.cl3 <- valueIndex1D(station.obs.cl3$Data[!is.na(station.obs.cl3$Data)],index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))
index.obs.cl3 <- c(index.obs.cl3, valueIndex1D(station.obs.cl3$Data[!is.na(station.obs.cl3$Data)], index.codes = "P98WetAmount"))
index.obs.cl3.rv20max <- MaxReturnValue(station.obs.cl3)
index.obs.cl3 <- c(index.obs.cl3, index.obs.cl3.rv20max)

index.trmm.cl3 <- valueIndex1D(station.trmm.cl3$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.trmm.cl3.rv20max <- MaxReturnValue(station.trmm.cl3)
index.trmm.cl3 <- c(index.trmm.cl3, index.trmm.cl3.rv20max)

index.era5.cl3 <- valueIndex1D(station.era5.cl3$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.era5.cl3.rv20max <- MaxReturnValue(station.era5.cl3)
index.era5.cl3 <- c(index.era5.cl3, index.era5.cl3.rv20max)
```

```{r}
cal.station.cl3 <- biasCorrection(y = station.obs.cl3, x = station.trmm.cl3, precipitation = TRUE,  method = "pqm")


cal.station.cl3 <- subsetDimension(cal.station.cl3, dimension = "time", indices = which(!is.na(cal.station.cl3$Data)))

cal.station.cl3$Dates$start <- as.POSIXct(cal.station.cl3$Dates$start,tz = "GMT")
cal.station.cl3$Dates$end <- as.POSIXct(cal.station.cl3$Dates$end,tz = "GMT")

index.cal.station.cl3 <- valueIndex1D(cal.station.cl3$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl3 <- c(index.cal.station.cl3, valueIndex1D(cal.station.cl3$Data[!is.na(cal.station.cl3$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl3.rv20max <- MaxReturnValue(cal.station.cl3)

index.cal.station.cl3 <- c(index.cal.station.cl3, index.cal.station.cl3.rv20max)

index.cal.station.pqm.cl3 <- index.cal.station.cl3


```


```{r}
cal.station.cl3 <- biasCorrection(y = station.obs.cl3, x = station.trmm.cl3, precipitation = TRUE,  method = "eqm")


cal.station.cl3 <- subsetDimension(cal.station.cl3, dimension = "time", indices = which(!is.na(cal.station.cl3$Data)))

cal.station.cl3$Dates$start <- as.POSIXct(cal.station.cl3$Dates$start,tz = "GMT")
cal.station.cl3$Dates$end <- as.POSIXct(cal.station.cl3$Dates$end,tz = "GMT")

index.cal.station.cl3 <- valueIndex1D(cal.station.cl3$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl3 <- c(index.cal.station.cl3, valueIndex1D(cal.station.cl3$Data[!is.na(cal.station.cl3$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl3.rv20max <- MaxReturnValue(cal.station.cl3)

index.cal.station.cl3 <- c(index.cal.station.cl3, index.cal.station.cl3.rv20max)

index.cal.station.eqm.cl3 <- index.cal.station.cl3


```

```{r}
cal.station.cl3 <- biasCorrection(y = station.obs.cl3, x = station.trmm.cl3, precipitation = TRUE,  method = "gpqm")


cal.station.cl3 <- subsetDimension(cal.station.cl3, dimension = "time", indices = which(!is.na(cal.station.cl3$Data)))

cal.station.cl3$Dates$start <- as.POSIXct(cal.station.cl3$Dates$start,tz = "GMT")
cal.station.cl3$Dates$end <- as.POSIXct(cal.station.cl3$Dates$end,tz = "GMT")

index.cal.station.cl3 <- valueIndex1D(cal.station.cl3$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl3 <- c(index.cal.station.cl3, valueIndex1D(cal.station.cl3$Data[!is.na(cal.station.cl3$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl3.rv20max <- MaxReturnValue(cal.station.cl3)

index.cal.station.cl3 <- c(index.cal.station.cl3, index.cal.station.cl3.rv20max)

index.cal.station.gpqm.cl3 <- index.cal.station.cl3


```


```{r}
cal.station.cl3 <- biasCorrection(y = station.obs.cl3, x = station.trmm.cl3, precipitation = TRUE,  method = "gpqm" , theta = .7)


cal.station.cl3 <- subsetDimension(cal.station.cl3, dimension = "time", indices = which(!is.na(cal.station.cl3$Data)))

cal.station.cl3$Dates$start <- as.POSIXct(cal.station.cl3$Dates$start,tz = "GMT")
cal.station.cl3$Dates$end <- as.POSIXct(cal.station.cl3$Dates$end,tz = "GMT")

index.cal.station.cl3 <- valueIndex1D(cal.station.cl3$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl3 <- c(index.cal.station.cl3, valueIndex1D(cal.station.cl3$Data[!is.na(cal.station.cl3$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl3.rv20max <- MaxReturnValue(cal.station.cl3)

index.cal.station.cl3 <- c(index.cal.station.cl3, index.cal.station.cl3.rv20max)

index.cal.station.gpqm2.cl3 <- index.cal.station.cl3


```



```{r}
measures <- list()
for (i in c(1:9)) {
  measures[[length(measures)+1]] <- c(abs(index.trmm.cl3[i]-index.obs.cl3[i]),abs(index.era5.cl3[i]-index.obs.cl3[i]),abs(index.cal.station.pqm.cl3[i]-index.obs.cl3[i]), abs(index.cal.station.eqm.cl3[i]-index.obs.cl3[i]), abs(index.cal.station.gpqm.cl3[i]-index.obs.cl3[i]), abs(index.cal.station.gpqm2.cl3[i]-index.obs.cl3[i])) 
}

```

```{r}
norm.vector <- list()
for (i in c(1:length(measures))) {
  norm.vector[[length(norm.vector)+1]] <- normalization(measures[[i]]) 
}
```

```{r}
score.trmm <- c()
for (i in c(1:9)) {
  score.trmm <- c(score.trmm, norm.vector[[i]][1]) 
}
score.trmm <- mean(score.trmm)

score.era5 <- c()
for (i in c(1:9)) {
  score.era5 <- c(score.era5, norm.vector[[i]][2]) 
}
score.era5 <- mean(score.era5)

score.pqm <- c()
for (i in c(1:9)) {
  score.pqm <- c(score.pqm, norm.vector[[i]][3]) 
}
score.pqm <- mean(score.pqm)


score.eqm <- c()
for (i in c(1:9)) {
  score.eqm <- c(score.eqm, norm.vector[[i]][4]) 
}
score.eqm <- mean(score.eqm)


score.gpqm <- c()
for (i in c(1:9)) {
  score.gpqm <- c(score.gpqm, norm.vector[[i]][5]) 
}
score.gpqm <- mean(score.gpqm)

score.gpqm2 <- c()
for (i in c(1:9)) {
  score.gpqm2 <- c(score.gpqm2, norm.vector[[i]][6]) 
}
score.gpqm2 <- mean(score.gpqm2)


scores <- c(score.trmm,score.era5, score.pqm, score.eqm, score.gpqm, score.gpqm2)
names(scores) <- c("TRMM","ERA5","PQM-WT3","EQM-WT3","GPQM-WT3","GPQM2-WT3")
scores <- sort(scores, decreasing = T)
scores
```
```{r}
scores.st2.wt3 <- scores
```
### WT4

```{r}
station.obs.cl4 <- subsetDimension(station.obs, dimension = "time", indices = which(kmModel5$cluster == 4))


station.trmm.cl4 <- subsetDimension(station.trmm, dimension = "time", indices = which(kmModel5$cluster == 4))

station.era5.cl4 <- subsetDimension(station.era5, dimension = "time", indices = which(kmModel5$cluster == 4))
```

```{r}
index.obs.cl4 <- valueIndex1D(station.obs.cl4$Data[!is.na(station.obs.cl4$Data)],index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))
index.obs.cl4 <- c(index.obs.cl4, valueIndex1D(station.obs.cl4$Data[!is.na(station.obs.cl4$Data)], index.codes = "P98WetAmount"))
index.obs.cl4.rv20max <- MaxReturnValue(station.obs.cl4)
index.obs.cl4 <- c(index.obs.cl4, index.obs.cl4.rv20max)

index.trmm.cl4 <- valueIndex1D(station.trmm.cl4$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.trmm.cl4.rv20max <- MaxReturnValue(station.trmm.cl4)
index.trmm.cl4 <- c(index.trmm.cl4, index.trmm.cl4.rv20max)

index.era5.cl4 <- valueIndex1D(station.era5.cl4$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.era5.cl4.rv20max <- MaxReturnValue(station.era5.cl4)
index.era5.cl4 <- c(index.era5.cl4, index.era5.cl4.rv20max)
```

```{r}
cal.station.cl4 <- biasCorrection(y = station.obs.cl4, x = station.trmm.cl4, precipitation = TRUE,  method = "pqm")


cal.station.cl4 <- subsetDimension(cal.station.cl4, dimension = "time", indices = which(!is.na(cal.station.cl4$Data)))

cal.station.cl4$Dates$start <- as.POSIXct(cal.station.cl4$Dates$start,tz = "GMT")
cal.station.cl4$Dates$end <- as.POSIXct(cal.station.cl4$Dates$end,tz = "GMT")

index.cal.station.cl4 <- valueIndex1D(cal.station.cl4$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl4 <- c(index.cal.station.cl4, valueIndex1D(cal.station.cl4$Data[!is.na(cal.station.cl4$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl4.rv20max <- MaxReturnValue(cal.station.cl4)

index.cal.station.cl4 <- c(index.cal.station.cl4, index.cal.station.cl4.rv20max)

index.cal.station.pqm.cl4 <- index.cal.station.cl4


```


```{r}
cal.station.cl4 <- biasCorrection(y = station.obs.cl4, x = station.trmm.cl4, precipitation = TRUE,  method = "eqm")


cal.station.cl4 <- subsetDimension(cal.station.cl4, dimension = "time", indices = which(!is.na(cal.station.cl4$Data)))

cal.station.cl4$Dates$start <- as.POSIXct(cal.station.cl4$Dates$start,tz = "GMT")
cal.station.cl4$Dates$end <- as.POSIXct(cal.station.cl4$Dates$end,tz = "GMT")

index.cal.station.cl4 <- valueIndex1D(cal.station.cl4$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl4 <- c(index.cal.station.cl4, valueIndex1D(cal.station.cl4$Data[!is.na(cal.station.cl4$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl4.rv20max <- MaxReturnValue(cal.station.cl4)

index.cal.station.cl4 <- c(index.cal.station.cl4, index.cal.station.cl4.rv20max)

index.cal.station.eqm.cl4 <- index.cal.station.cl4


```

```{r}
cal.station.cl4 <- biasCorrection(y = station.obs.cl4, x = station.trmm.cl4, precipitation = TRUE,  method = "gpqm")


cal.station.cl4 <- subsetDimension(cal.station.cl4, dimension = "time", indices = which(!is.na(cal.station.cl4$Data)))

cal.station.cl4$Dates$start <- as.POSIXct(cal.station.cl4$Dates$start,tz = "GMT")
cal.station.cl4$Dates$end <- as.POSIXct(cal.station.cl4$Dates$end,tz = "GMT")

index.cal.station.cl4 <- valueIndex1D(cal.station.cl4$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl4 <- c(index.cal.station.cl4, valueIndex1D(cal.station.cl4$Data[!is.na(cal.station.cl4$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl4.rv20max <- MaxReturnValue(cal.station.cl4)

index.cal.station.cl4 <- c(index.cal.station.cl4, index.cal.station.cl4.rv20max)

index.cal.station.gpqm.cl4 <- index.cal.station.cl4


```


```{r}
cal.station.cl4 <- biasCorrection(y = station.obs.cl4, x = station.trmm.cl4, precipitation = TRUE,  method = "gpqm" , theta = .7)


cal.station.cl4 <- subsetDimension(cal.station.cl4, dimension = "time", indices = which(!is.na(cal.station.cl4$Data)))

cal.station.cl4$Dates$start <- as.POSIXct(cal.station.cl4$Dates$start,tz = "GMT")
cal.station.cl4$Dates$end <- as.POSIXct(cal.station.cl4$Dates$end,tz = "GMT")

index.cal.station.cl4 <- valueIndex1D(cal.station.cl4$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl4 <- c(index.cal.station.cl4, valueIndex1D(cal.station.cl4$Data[!is.na(cal.station.cl4$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl4.rv20max <- MaxReturnValue(cal.station.cl4)

index.cal.station.cl4 <- c(index.cal.station.cl4, index.cal.station.cl4.rv20max)

index.cal.station.gpqm2.cl4 <- index.cal.station.cl4


```



```{r}
measures <- list()
for (i in c(1:9)) {
  measures[[length(measures)+1]] <- c(abs(index.trmm.cl4[i]-index.obs.cl4[i]),abs(index.era5.cl4[i]-index.obs.cl4[i]),abs(index.cal.station.pqm.cl4[i]-index.obs.cl4[i]), abs(index.cal.station.eqm.cl4[i]-index.obs.cl4[i]), abs(index.cal.station.gpqm.cl4[i]-index.obs.cl4[i]), abs(index.cal.station.gpqm2.cl4[i]-index.obs.cl4[i])) 
}

```

```{r}
norm.vector <- list()
for (i in c(1:length(measures))) {
  norm.vector[[length(norm.vector)+1]] <- normalization(measures[[i]]) 
}
```

```{r}
score.trmm <- c()
for (i in c(1:9)) {
  score.trmm <- c(score.trmm, norm.vector[[i]][1]) 
}
score.trmm <- mean(score.trmm)

score.era5 <- c()
for (i in c(1:9)) {
  score.era5 <- c(score.era5, norm.vector[[i]][2]) 
}
score.era5 <- mean(score.era5)

score.pqm <- c()
for (i in c(1:9)) {
  score.pqm <- c(score.pqm, norm.vector[[i]][3]) 
}
score.pqm <- mean(score.pqm)


score.eqm <- c()
for (i in c(1:9)) {
  score.eqm <- c(score.eqm, norm.vector[[i]][4]) 
}
score.eqm <- mean(score.eqm)


score.gpqm <- c()
for (i in c(1:9)) {
  score.gpqm <- c(score.gpqm, norm.vector[[i]][5]) 
}
score.gpqm <- mean(score.gpqm)

score.gpqm.cl5 <- c()


score.gpqm2 <- c()
for (i in c(1:9)) {
  score.gpqm2 <- c(score.gpqm2, norm.vector[[i]][6]) 
}
score.gpqm2 <- mean(score.gpqm2)



scores <- c(score.trmm,score.era5, score.pqm, score.eqm, score.gpqm, score.gpqm2)
names(scores) <- c("TRMM","ERA5","PQM-WT4","EQM-WT4","GPQM-WT4","GPQM2-WT4")
scores <- sort(scores, decreasing = T)
scores
```
```{r}
scores.st2.wt4 <- scores
```
### WT5

```{r}
station.obs.cl5 <- subsetDimension(station.obs, dimension = "time", indices = which(kmModel5$cluster == 5))


station.trmm.cl5 <- subsetDimension(station.trmm, dimension = "time", indices = which(kmModel5$cluster == 5))

station.era5.cl5 <- subsetDimension(station.era5, dimension = "time", indices = which(kmModel5$cluster == 5))
```

```{r}
index.obs.cl5 <- valueIndex1D(station.obs.cl5$Data[!is.na(station.obs.cl5$Data)],index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))
index.obs.cl5 <- c(index.obs.cl5, valueIndex1D(station.obs.cl5$Data[!is.na(station.obs.cl5$Data)], index.codes = "P98WetAmount"))
index.obs.cl5.rv20max <- MaxReturnValue(station.obs.cl5)
index.obs.cl5 <- c(index.obs.cl5, index.obs.cl5.rv20max)

index.trmm.cl5 <- valueIndex1D(station.trmm.cl5$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.trmm.cl5.rv20max <- MaxReturnValue(station.trmm.cl5)
index.trmm.cl5 <- c(index.trmm.cl5, index.trmm.cl5.rv20max)

index.era5.cl5 <- valueIndex1D(station.era5.cl5$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.era5.cl5.rv20max <- MaxReturnValue(station.era5.cl5)
index.era5.cl5 <- c(index.era5.cl5, index.era5.cl5.rv20max)
```

```{r}
cal.station.cl5 <- biasCorrection(y = station.obs.cl5, x = station.trmm.cl5, precipitation = TRUE,  method = "pqm")


cal.station.cl5 <- subsetDimension(cal.station.cl5, dimension = "time", indices = which(!is.na(cal.station.cl5$Data)))

cal.station.cl5$Dates$start <- as.POSIXct(cal.station.cl5$Dates$start,tz = "GMT")
cal.station.cl5$Dates$end <- as.POSIXct(cal.station.cl5$Dates$end,tz = "GMT")

index.cal.station.cl5 <- valueIndex1D(cal.station.cl5$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl5 <- c(index.cal.station.cl5, valueIndex1D(cal.station.cl5$Data[!is.na(cal.station.cl5$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl5.rv20max <- MaxReturnValue(cal.station.cl5)

index.cal.station.cl5 <- c(index.cal.station.cl5, index.cal.station.cl5.rv20max)

index.cal.station.pqm.cl5 <- index.cal.station.cl5


```


```{r}
cal.station.cl5 <- biasCorrection(y = station.obs.cl5, x = station.trmm.cl5, precipitation = TRUE,  method = "eqm")


cal.station.cl5 <- subsetDimension(cal.station.cl5, dimension = "time", indices = which(!is.na(cal.station.cl5$Data)))

cal.station.cl5$Dates$start <- as.POSIXct(cal.station.cl5$Dates$start,tz = "GMT")
cal.station.cl5$Dates$end <- as.POSIXct(cal.station.cl5$Dates$end,tz = "GMT")

index.cal.station.cl5 <- valueIndex1D(cal.station.cl5$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl5 <- c(index.cal.station.cl5, valueIndex1D(cal.station.cl5$Data[!is.na(cal.station.cl5$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl5.rv20max <- MaxReturnValue(cal.station.cl5)

index.cal.station.cl5 <- c(index.cal.station.cl5, index.cal.station.cl5.rv20max)

index.cal.station.eqm.cl5 <- index.cal.station.cl5


```

```{r}
cal.station.cl5 <- biasCorrection(y = station.obs.cl5, x = station.trmm.cl5, precipitation = TRUE,  method = "gpqm")


cal.station.cl5 <- subsetDimension(cal.station.cl5, dimension = "time", indices = which(!is.na(cal.station.cl5$Data)))

cal.station.cl5$Dates$start <- as.POSIXct(cal.station.cl5$Dates$start,tz = "GMT")
cal.station.cl5$Dates$end <- as.POSIXct(cal.station.cl5$Dates$end,tz = "GMT")

index.cal.station.cl5 <- valueIndex1D(cal.station.cl5$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl5 <- c(index.cal.station.cl5, valueIndex1D(cal.station.cl5$Data[!is.na(cal.station.cl5$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl5.rv20max <- MaxReturnValue(cal.station.cl5)

index.cal.station.cl5 <- c(index.cal.station.cl5, index.cal.station.cl5.rv20max)

index.cal.station.gpqm.cl5 <- index.cal.station.cl5


```


```{r}
cal.station.cl5 <- biasCorrection(y = station.obs.cl5, x = station.trmm.cl5, precipitation = TRUE,  method = "gpqm" , theta = .7)


cal.station.cl5 <- subsetDimension(cal.station.cl5, dimension = "time", indices = which(!is.na(cal.station.cl5$Data)))

cal.station.cl5$Dates$start <- as.POSIXct(cal.station.cl5$Dates$start,tz = "GMT")
cal.station.cl5$Dates$end <- as.POSIXct(cal.station.cl5$Dates$end,tz = "GMT")

index.cal.station.cl5 <- valueIndex1D(cal.station.cl5$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl5 <- c(index.cal.station.cl5, valueIndex1D(cal.station.cl5$Data[!is.na(cal.station.cl5$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl5.rv20max <- MaxReturnValue(cal.station.cl5)

index.cal.station.cl5 <- c(index.cal.station.cl5, index.cal.station.cl5.rv20max)

index.cal.station.gpqm2.cl5 <- index.cal.station.cl5


```



```{r}
measures <- list()
for (i in c(1:9)) {
  measures[[length(measures)+1]] <- c(abs(index.trmm.cl5[i]-index.obs.cl5[i]),abs(index.era5.cl5[i]-index.obs.cl5[i]),abs(index.cal.station.pqm.cl5[i]-index.obs.cl5[i]), abs(index.cal.station.eqm.cl5[i]-index.obs.cl5[i]), abs(index.cal.station.gpqm.cl5[i]-index.obs.cl5[i]), abs(index.cal.station.gpqm2.cl5[i]-index.obs.cl5[i])) 
}

```

```{r}
norm.vector <- list()
for (i in c(1:length(measures))) {
  norm.vector[[length(norm.vector)+1]] <- normalization(measures[[i]]) 
}
```

```{r}
score.trmm <- c()
for (i in c(1:9)) {
  score.trmm <- c(score.trmm, norm.vector[[i]][1]) 
}
score.trmm <- mean(score.trmm)

score.era5 <- c()
for (i in c(1:9)) {
  score.era5 <- c(score.era5, norm.vector[[i]][1]) 
}
score.era5 <- mean(score.era5)

score.pqm <- c()
for (i in c(1:9)) {
  score.pqm <- c(score.pqm, norm.vector[[i]][2]) 
}
score.pqm <- mean(score.pqm)


score.eqm <- c()
for (i in c(1:9)) {
  score.eqm <- c(score.eqm, norm.vector[[i]][3]) 
}
score.eqm <- mean(score.eqm)


score.gpqm <- c()
for (i in c(1:9)) {
  score.gpqm <- c(score.gpqm, norm.vector[[i]][4]) 
}
score.gpqm <- mean(score.gpqm)



score.gpqm2 <- c()
for (i in c(1:9)) {
  score.gpqm2 <- c(score.gpqm2, norm.vector[[i]][5]) 
}
score.gpqm2 <- mean(score.gpqm2)


scores <- c(score.trmm, score.era5, score.pqm, score.eqm, score.gpqm, score.gpqm2)
names(scores) <- c("TRMM","ERA5","PQM-WT5","EQM-WT5","GPQM-WT5","GPQM2-WT5")
scores <- sort(scores, decreasing = T)
scores
```
```{r}
scores.st2.wt5 <- scores
```

## RarotongaIA, Cook Island


```{r}
i=3

station.trmm <- subsetGrid(precip_trmm, station.id = precip_trmm$Metadata$station_id[i])
station.obs <- subsetGrid(precip_obs, station.id = precip_trmm$Metadata$station_id[i])

idx <- which.min(abs(pp_reanalysis$xyCoords$x - station.obs$xyCoords$x))
lon <- pp_reanalysis$xyCoords$x[idx]
  
idx2 <- which.min(abs(pp_reanalysis$xyCoords$y - station.obs$xyCoords$y))
lat <- pp_reanalysis$xyCoords$y[idx2]
  
station.era5 <- subsetGrid(pp_reanalysis, lonLim = lon, latLim = lat)
```


````{r}
index.obs <- valueIndex1D(station.obs$Data[!is.na(station.obs$Data)],index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))
index.obs <- c(index.obs, valueIndex1D(station.obs$Data[!is.na(station.obs$Data)], index.codes = "P98WetAmount"))
index.obs.rv20max <- MaxReturnValue(station.obs)
index.obs <- c(index.obs, index.obs.rv20max)

index.trmm <- valueIndex1D(station.trmm$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.trmm.rv20max <- MaxReturnValue(station.trmm)
index.trmm <- c(index.trmm, index.trmm.rv20max)

index.era5 <- valueIndex1D(station.era5$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.era5.rv20max <- MaxReturnValue(station.era5)
index.era5 <- c(index.era5, index.era5.rv20max)

```



### WT1

```{r}
station.obs.cl1 <- subsetDimension(station.obs, dimension = "time", indices = which(kmModel5$cluster == 1))


station.trmm.cl1 <- subsetDimension(station.trmm, dimension = "time", indices = which(kmModel5$cluster == 1))

station.era5.cl1 <- subsetDimension(station.era5, dimension = "time", indices = which(kmModel5$cluster == 1))
```

```{r}
index.obs.cl1 <- valueIndex1D(station.obs.cl1$Data[!is.na(station.obs.cl1$Data)],index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))
index.obs.cl1 <- c(index.obs.cl1, valueIndex1D(station.obs.cl1$Data[!is.na(station.obs.cl1$Data)], index.codes = "P98WetAmount"))
index.obs.cl1.rv20max <- MaxReturnValue(station.obs.cl1)
index.obs.cl1 <- c(index.obs.cl1, index.obs.cl1.rv20max)

index.trmm.cl1 <- valueIndex1D(station.trmm.cl1$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.trmm.cl1.rv20max <- MaxReturnValue(station.trmm.cl1)
index.trmm.cl1 <- c(index.trmm.cl1, index.trmm.cl1.rv20max)

index.era5.cl1 <- valueIndex1D(station.era5.cl1$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.era5.cl1.rv20max <- MaxReturnValue(station.era5.cl1)
index.era5.cl1 <- c(index.era5.cl1, index.era5.cl1.rv20max)
```

```{r}
cal.station.cl1 <- biasCorrection(y = station.obs.cl1, x = station.trmm.cl1, precipitation = TRUE,  method = "pqm")


cal.station.cl1 <- subsetDimension(cal.station.cl1, dimension = "time", indices = which(!is.na(cal.station.cl1$Data)))

cal.station.cl1$Dates$start <- as.POSIXct(cal.station.cl1$Dates$start,tz = "GMT")
cal.station.cl1$Dates$end <- as.POSIXct(cal.station.cl1$Dates$end,tz = "GMT")

index.cal.station.cl1 <- valueIndex1D(cal.station.cl1$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl1 <- c(index.cal.station.cl1, valueIndex1D(cal.station.cl1$Data[!is.na(cal.station.cl1$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl1.rv20max <- MaxReturnValue(cal.station.cl1)

index.cal.station.cl1 <- c(index.cal.station.cl1, index.cal.station.cl1.rv20max)

index.cal.station.pqm.cl1 <- index.cal.station.cl1


```


```{r}
cal.station.cl1 <- biasCorrection(y = station.obs.cl1, x = station.trmm.cl1, precipitation = TRUE,  method = "eqm")


cal.station.cl1 <- subsetDimension(cal.station.cl1, dimension = "time", indices = which(!is.na(cal.station.cl1$Data)))

cal.station.cl1$Dates$start <- as.POSIXct(cal.station.cl1$Dates$start,tz = "GMT")
cal.station.cl1$Dates$end <- as.POSIXct(cal.station.cl1$Dates$end,tz = "GMT")

index.cal.station.cl1 <- valueIndex1D(cal.station.cl1$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl1 <- c(index.cal.station.cl1, valueIndex1D(cal.station.cl1$Data[!is.na(cal.station.cl1$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl1.rv20max <- MaxReturnValue(cal.station.cl1)

index.cal.station.cl1 <- c(index.cal.station.cl1, index.cal.station.cl1.rv20max)

index.cal.station.eqm.cl1 <- index.cal.station.cl1


```

```{r}
cal.station.cl1 <- biasCorrection(y = station.obs.cl1, x = station.trmm.cl1, precipitation = TRUE,  method = "gpqm")


cal.station.cl1 <- subsetDimension(cal.station.cl1, dimension = "time", indices = which(!is.na(cal.station.cl1$Data)))

cal.station.cl1$Dates$start <- as.POSIXct(cal.station.cl1$Dates$start,tz = "GMT")
cal.station.cl1$Dates$end <- as.POSIXct(cal.station.cl1$Dates$end,tz = "GMT")

index.cal.station.cl1 <- valueIndex1D(cal.station.cl1$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl1 <- c(index.cal.station.cl1, valueIndex1D(cal.station.cl1$Data[!is.na(cal.station.cl1$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl1.rv20max <- MaxReturnValue(cal.station.cl1)

index.cal.station.cl1 <- c(index.cal.station.cl1, index.cal.station.cl1.rv20max)

index.cal.station.gpqm.cl1 <- index.cal.station.cl1


```


```{r}
cal.station.cl1 <- biasCorrection(y = station.obs.cl1, x = station.trmm.cl1, precipitation = TRUE,  method = "gpqm" , theta = .7)


cal.station.cl1 <- subsetDimension(cal.station.cl1, dimension = "time", indices = which(!is.na(cal.station.cl1$Data)))

cal.station.cl1$Dates$start <- as.POSIXct(cal.station.cl1$Dates$start,tz = "GMT")
cal.station.cl1$Dates$end <- as.POSIXct(cal.station.cl1$Dates$end,tz = "GMT")

index.cal.station.cl1 <- valueIndex1D(cal.station.cl1$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl1 <- c(index.cal.station.cl1, valueIndex1D(cal.station.cl1$Data[!is.na(cal.station.cl1$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl1.rv20max <- MaxReturnValue(cal.station.cl1)

index.cal.station.cl1 <- c(index.cal.station.cl1, index.cal.station.cl1.rv20max)

index.cal.station.gpqm2.cl1 <- index.cal.station.cl1


```



```{r}
measures <- list()
for (i in c(1:9)) {
  measures[[length(measures)+1]] <- c(abs(index.trmm.cl1[i]-index.obs.cl1[i]),abs(index.era5.cl1[i]-index.obs.cl1[i]),abs(index.cal.station.pqm.cl1[i]-index.obs.cl1[i]), abs(index.cal.station.eqm.cl1[i]-index.obs.cl1[i]), abs(index.cal.station.gpqm.cl1[i]-index.obs.cl1[i]), abs(index.cal.station.gpqm2.cl1[i]-index.obs.cl1[i])) 
}

```

```{r}
normalization <- function(measure){
  measure.norm <- c()
  #measure must be a vector with the value of a certain measure of different calibrations
  for (i in c(1:length(measure))) {
    measure.norm <- c(measure.norm, 1-((measure[i]-min(measure))/(max(measure)-min(measure))))
  }
  return(measure.norm)
}
```

```{r}
norm.vector <- list()
for (i in c(1:length(measures))) {
  norm.vector[[length(norm.vector)+1]] <- normalization(measures[[i]]) 
}
```

```{r}
score.trmm <- c()
for (i in c(1:9)) {
  score.trmm <- c(score.trmm, norm.vector[[i]][1]) 
}
score.trmm <- mean(score.trmm)

score.era5 <- c()
for (i in c(1:9)) {
  score.era5 <- c(score.era5, norm.vector[[i]][2]) 
}
score.era5 <- mean(score.era5)

score.pqm <- c()
for (i in c(1:9)) {
  score.pqm <- c(score.pqm, norm.vector[[i]][3]) 
}
score.pqm <- mean(score.pqm)


score.eqm <- c()
for (i in c(1:9)) {
  score.eqm <- c(score.eqm, norm.vector[[i]][4]) 
}
score.eqm <- mean(score.eqm)


score.gpqm <- c()
for (i in c(1:9)) {
  score.gpqm <- c(score.gpqm, norm.vector[[i]][5]) 
}
score.gpqm <- mean(score.gpqm)


score.gpqm2 <- c()
for (i in c(1:9)) {
  score.gpqm2 <- c(score.gpqm2, norm.vector[[i]][6]) 
}
score.gpqm2 <- mean(score.gpqm2)




scores <- c(score.trmm,score.era5, score.pqm, score.eqm, score.gpqm, score.gpqm2)
names(scores) <- c("TRMM","ERA5","PQM-WT1","EQM-WT1","GPQM-WT1","GPQM2-WT1")
scores <- sort(scores, decreasing = T)
scores
```
```{r}
scores.st3.wt1 <- scores
```
### WT2
```{r}
station.obs.cl2 <- subsetDimension(station.obs, dimension = "time", indices = which(kmModel5$cluster == 2))


station.trmm.cl2 <- subsetDimension(station.trmm, dimension = "time", indices = which(kmModel5$cluster == 2))

station.era5.cl2 <- subsetDimension(station.era5, dimension = "time", indices = which(kmModel5$cluster == 2))
```

```{r}
index.obs.cl2 <- valueIndex1D(station.obs.cl2$Data[!is.na(station.obs.cl2$Data)],index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))
index.obs.cl2 <- c(index.obs.cl2, valueIndex1D(station.obs.cl2$Data[!is.na(station.obs.cl2$Data)], index.codes = "P98WetAmount"))
index.obs.cl2.rv20max <- MaxReturnValue(station.obs.cl2)
index.obs.cl2 <- c(index.obs.cl2, index.obs.cl2.rv20max)

index.trmm.cl2 <- valueIndex1D(station.trmm.cl2$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.trmm.cl2.rv20max <- MaxReturnValue(station.trmm.cl2)
index.trmm.cl2 <- c(index.trmm.cl2, index.trmm.cl2.rv20max)

index.era5.cl2 <- valueIndex1D(station.era5.cl2$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.era5.cl2.rv20max <- MaxReturnValue(station.era5.cl2)
index.era5.cl2 <- c(index.era5.cl2, index.era5.cl2.rv20max)
```

```{r}
cal.station.cl2 <- biasCorrection(y = station.obs.cl2, x = station.trmm.cl2, precipitation = TRUE,  method = "pqm")


cal.station.cl2 <- subsetDimension(cal.station.cl2, dimension = "time", indices = which(!is.na(cal.station.cl2$Data)))

cal.station.cl2$Dates$start <- as.POSIXct(cal.station.cl2$Dates$start,tz = "GMT")
cal.station.cl2$Dates$end <- as.POSIXct(cal.station.cl2$Dates$end,tz = "GMT")

index.cal.station.cl2 <- valueIndex1D(cal.station.cl2$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl2 <- c(index.cal.station.cl2, valueIndex1D(cal.station.cl2$Data[!is.na(cal.station.cl2$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl2.rv20max <- MaxReturnValue(cal.station.cl2)

index.cal.station.cl2 <- c(index.cal.station.cl2, index.cal.station.cl2.rv20max)

index.cal.station.pqm.cl2 <- index.cal.station.cl2


```


```{r}
cal.station.cl2 <- biasCorrection(y = station.obs.cl2, x = station.trmm.cl2, precipitation = TRUE,  method = "eqm")


cal.station.cl2 <- subsetDimension(cal.station.cl2, dimension = "time", indices = which(!is.na(cal.station.cl2$Data)))

cal.station.cl2$Dates$start <- as.POSIXct(cal.station.cl2$Dates$start,tz = "GMT")
cal.station.cl2$Dates$end <- as.POSIXct(cal.station.cl2$Dates$end,tz = "GMT")

index.cal.station.cl2 <- valueIndex1D(cal.station.cl2$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl2 <- c(index.cal.station.cl2, valueIndex1D(cal.station.cl2$Data[!is.na(cal.station.cl2$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl2.rv20max <- MaxReturnValue(cal.station.cl2)

index.cal.station.cl2 <- c(index.cal.station.cl2, index.cal.station.cl2.rv20max)

index.cal.station.eqm.cl2 <- index.cal.station.cl2


```

```{r}
cal.station.cl2 <- biasCorrection(y = station.obs.cl2, x = station.trmm.cl2, precipitation = TRUE,  method = "gpqm")


cal.station.cl2 <- subsetDimension(cal.station.cl2, dimension = "time", indices = which(!is.na(cal.station.cl2$Data)))

cal.station.cl2$Dates$start <- as.POSIXct(cal.station.cl2$Dates$start,tz = "GMT")
cal.station.cl2$Dates$end <- as.POSIXct(cal.station.cl2$Dates$end,tz = "GMT")

index.cal.station.cl2 <- valueIndex1D(cal.station.cl2$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl2 <- c(index.cal.station.cl2, valueIndex1D(cal.station.cl2$Data[!is.na(cal.station.cl2$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl2.rv20max <- MaxReturnValue(cal.station.cl2)

index.cal.station.cl2 <- c(index.cal.station.cl2, index.cal.station.cl2.rv20max)

index.cal.station.gpqm.cl2 <- index.cal.station.cl2


```


```{r}
cal.station.cl2 <- biasCorrection(y = station.obs.cl2, x = station.trmm.cl2, precipitation = TRUE,  method = "gpqm" , theta = .7)


cal.station.cl2 <- subsetDimension(cal.station.cl2, dimension = "time", indices = which(!is.na(cal.station.cl2$Data)))

cal.station.cl2$Dates$start <- as.POSIXct(cal.station.cl2$Dates$start,tz = "GMT")
cal.station.cl2$Dates$end <- as.POSIXct(cal.station.cl2$Dates$end,tz = "GMT")

index.cal.station.cl2 <- valueIndex1D(cal.station.cl2$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl2 <- c(index.cal.station.cl2, valueIndex1D(cal.station.cl2$Data[!is.na(cal.station.cl2$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl2.rv20max <- MaxReturnValue(cal.station.cl2)

index.cal.station.cl2 <- c(index.cal.station.cl2, index.cal.station.cl2.rv20max)

index.cal.station.gpqm2.cl2 <- index.cal.station.cl2


```



```{r}
measures <- list()
for (i in c(1:9)) {
  measures[[length(measures)+1]] <- c(abs(index.trmm.cl2[i]-index.obs.cl2[i]),abs(index.era5.cl2[i]-index.obs.cl2[i]),abs(index.cal.station.pqm.cl2[i]-index.obs.cl2[i]), abs(index.cal.station.eqm.cl2[i]-index.obs.cl2[i]), abs(index.cal.station.gpqm.cl2[i]-index.obs.cl2[i]), abs(index.cal.station.gpqm2.cl2[i]-index.obs.cl2[i])) 
}

```

```{r}
norm.vector <- list()
for (i in c(1:length(measures))) {
  norm.vector[[length(norm.vector)+1]] <- normalization(measures[[i]]) 
}
```

```{r}
score.trmm <- c()
for (i in c(1:9)) {
  score.trmm <- c(score.trmm, norm.vector[[i]][1]) 
}
score.trmm <- mean(score.trmm)

score.era5 <- c()
for (i in c(1:9)) {
  score.era5 <- c(score.era5, norm.vector[[i]][2]) 
}
score.era5 <- mean(score.era5)

score.pqm <- c()
for (i in c(1:9)) {
  score.pqm <- c(score.pqm, norm.vector[[i]][3]) 
}
score.pqm <- mean(score.pqm)


score.eqm <- c()
for (i in c(1:9)) {
  score.eqm <- c(score.eqm, norm.vector[[i]][4]) 
}
score.eqm <- mean(score.eqm)


score.gpqm <- c()
for (i in c(1:9)) {
  score.gpqm <- c(score.gpqm, norm.vector[[i]][5]) 
}
score.gpqm <- mean(score.gpqm)

score.gpqm2 <- c()
for (i in c(1:9)) {
  score.gpqm2 <- c(score.gpqm2, norm.vector[[i]][6]) 
}
score.gpqm2 <- mean(score.gpqm2)

scores <- c(score.trmm, score.era5, score.pqm, score.eqm, score.gpqm, score.gpqm2)
names(scores) <- c("TRMM","ERA5","PQM-WT1","EQM-WT1","GPQM-WT1","GPQM2-WT1")
scores <- sort(scores, decreasing = T)
scores
```
```{r}
scores.st3.wt2 <- scores
```
### WT3

```{r}
station.obs.cl3 <- subsetDimension(station.obs, dimension = "time", indices = which(kmModel5$cluster == 3))


station.trmm.cl3 <- subsetDimension(station.trmm, dimension = "time", indices = which(kmModel5$cluster == 3))

station.era5.cl3 <- subsetDimension(station.era5, dimension = "time", indices = which(kmModel5$cluster == 3))
```

```{r}
index.obs.cl3 <- valueIndex1D(station.obs.cl3$Data[!is.na(station.obs.cl3$Data)],index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))
index.obs.cl3 <- c(index.obs.cl3, valueIndex1D(station.obs.cl3$Data[!is.na(station.obs.cl3$Data)], index.codes = "P98WetAmount"))
index.obs.cl3.rv20max <- MaxReturnValue(station.obs.cl3)
index.obs.cl3 <- c(index.obs.cl3, index.obs.cl3.rv20max)

index.trmm.cl3 <- valueIndex1D(station.trmm.cl3$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.trmm.cl3.rv20max <- MaxReturnValue(station.trmm.cl3)
index.trmm.cl3 <- c(index.trmm.cl3, index.trmm.cl3.rv20max)

index.era5.cl3 <- valueIndex1D(station.era5.cl3$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.era5.cl3.rv20max <- MaxReturnValue(station.era5.cl3)
index.era5.cl3 <- c(index.era5.cl3, index.era5.cl3.rv20max)
```

```{r}
cal.station.cl3 <- biasCorrection(y = station.obs.cl3, x = station.trmm.cl3, precipitation = TRUE,  method = "pqm")


cal.station.cl3 <- subsetDimension(cal.station.cl3, dimension = "time", indices = which(!is.na(cal.station.cl3$Data)))

cal.station.cl3$Dates$start <- as.POSIXct(cal.station.cl3$Dates$start,tz = "GMT")
cal.station.cl3$Dates$end <- as.POSIXct(cal.station.cl3$Dates$end,tz = "GMT")

index.cal.station.cl3 <- valueIndex1D(cal.station.cl3$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl3 <- c(index.cal.station.cl3, valueIndex1D(cal.station.cl3$Data[!is.na(cal.station.cl3$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl3.rv20max <- MaxReturnValue(cal.station.cl3)

index.cal.station.cl3 <- c(index.cal.station.cl3, index.cal.station.cl3.rv20max)

index.cal.station.pqm.cl3 <- index.cal.station.cl3


```


```{r}
cal.station.cl3 <- biasCorrection(y = station.obs.cl3, x = station.trmm.cl3, precipitation = TRUE,  method = "eqm")


cal.station.cl3 <- subsetDimension(cal.station.cl3, dimension = "time", indices = which(!is.na(cal.station.cl3$Data)))

cal.station.cl3$Dates$start <- as.POSIXct(cal.station.cl3$Dates$start,tz = "GMT")
cal.station.cl3$Dates$end <- as.POSIXct(cal.station.cl3$Dates$end,tz = "GMT")

index.cal.station.cl3 <- valueIndex1D(cal.station.cl3$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl3 <- c(index.cal.station.cl3, valueIndex1D(cal.station.cl3$Data[!is.na(cal.station.cl3$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl3.rv20max <- MaxReturnValue(cal.station.cl3)

index.cal.station.cl3 <- c(index.cal.station.cl3, index.cal.station.cl3.rv20max)

index.cal.station.eqm.cl3 <- index.cal.station.cl3


```

```{r}
cal.station.cl3 <- biasCorrection(y = station.obs.cl3, x = station.trmm.cl3, precipitation = TRUE,  method = "gpqm")


cal.station.cl3 <- subsetDimension(cal.station.cl3, dimension = "time", indices = which(!is.na(cal.station.cl3$Data)))

cal.station.cl3$Dates$start <- as.POSIXct(cal.station.cl3$Dates$start,tz = "GMT")
cal.station.cl3$Dates$end <- as.POSIXct(cal.station.cl3$Dates$end,tz = "GMT")

index.cal.station.cl3 <- valueIndex1D(cal.station.cl3$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl3 <- c(index.cal.station.cl3, valueIndex1D(cal.station.cl3$Data[!is.na(cal.station.cl3$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl3.rv20max <- MaxReturnValue(cal.station.cl3)

index.cal.station.cl3 <- c(index.cal.station.cl3, index.cal.station.cl3.rv20max)

index.cal.station.gpqm.cl3 <- index.cal.station.cl3


```


```{r}
cal.station.cl3 <- biasCorrection(y = station.obs.cl3, x = station.trmm.cl3, precipitation = TRUE,  method = "gpqm" , theta = .7)


cal.station.cl3 <- subsetDimension(cal.station.cl3, dimension = "time", indices = which(!is.na(cal.station.cl3$Data)))

cal.station.cl3$Dates$start <- as.POSIXct(cal.station.cl3$Dates$start,tz = "GMT")
cal.station.cl3$Dates$end <- as.POSIXct(cal.station.cl3$Dates$end,tz = "GMT")

index.cal.station.cl3 <- valueIndex1D(cal.station.cl3$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl3 <- c(index.cal.station.cl3, valueIndex1D(cal.station.cl3$Data[!is.na(cal.station.cl3$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl3.rv20max <- MaxReturnValue(cal.station.cl3)

index.cal.station.cl3 <- c(index.cal.station.cl3, index.cal.station.cl3.rv20max)

index.cal.station.gpqm2.cl3 <- index.cal.station.cl3


```



```{r}
measures <- list()
for (i in c(1:9)) {
  measures[[length(measures)+1]] <- c(abs(index.trmm.cl3[i]-index.obs.cl3[i]),abs(index.era5.cl3[i]-index.obs.cl3[i]),abs(index.cal.station.pqm.cl3[i]-index.obs.cl3[i]), abs(index.cal.station.eqm.cl3[i]-index.obs.cl3[i]), abs(index.cal.station.gpqm.cl3[i]-index.obs.cl3[i]), abs(index.cal.station.gpqm2.cl3[i]-index.obs.cl3[i])) 
}

```

```{r}
norm.vector <- list()
for (i in c(1:length(measures))) {
  norm.vector[[length(norm.vector)+1]] <- normalization(measures[[i]]) 
}
```

```{r}
score.trmm <- c()
for (i in c(1:9)) {
  score.trmm <- c(score.trmm, norm.vector[[i]][1]) 
}
score.trmm <- mean(score.trmm)

score.era5 <- c()
for (i in c(1:9)) {
  score.era5 <- c(score.era5, norm.vector[[i]][2]) 
}
score.era5 <- mean(score.era5)

score.pqm <- c()
for (i in c(1:9)) {
  score.pqm <- c(score.pqm, norm.vector[[i]][3]) 
}
score.pqm <- mean(score.pqm)


score.eqm <- c()
for (i in c(1:9)) {
  score.eqm <- c(score.eqm, norm.vector[[i]][4]) 
}
score.eqm <- mean(score.eqm)


score.gpqm <- c()
for (i in c(1:9)) {
  score.gpqm <- c(score.gpqm, norm.vector[[i]][5]) 
}
score.gpqm <- mean(score.gpqm)

score.gpqm2 <- c()
for (i in c(1:9)) {
  score.gpqm2 <- c(score.gpqm2, norm.vector[[i]][6]) 
}
score.gpqm2 <- mean(score.gpqm2)


scores <- c(score.trmm,score.era5, score.pqm, score.eqm, score.gpqm, score.gpqm2)
names(scores) <- c("TRMM","ERA5","PQM-WT3","EQM-WT3","GPQM-WT3","GPQM2-WT3")
scores <- sort(scores, decreasing = T)
scores
```
```{r}
scores.st3.wt3 <- scores
```
### WT4

```{r}
station.obs.cl4 <- subsetDimension(station.obs, dimension = "time", indices = which(kmModel5$cluster == 4))


station.trmm.cl4 <- subsetDimension(station.trmm, dimension = "time", indices = which(kmModel5$cluster == 4))

station.era5.cl4 <- subsetDimension(station.era5, dimension = "time", indices = which(kmModel5$cluster == 4))
```

```{r}
index.obs.cl4 <- valueIndex1D(station.obs.cl4$Data[!is.na(station.obs.cl4$Data)],index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))
index.obs.cl4 <- c(index.obs.cl4, valueIndex1D(station.obs.cl4$Data[!is.na(station.obs.cl4$Data)], index.codes = "P98WetAmount"))
index.obs.cl4.rv20max <- MaxReturnValue(station.obs.cl4)
index.obs.cl4 <- c(index.obs.cl4, index.obs.cl4.rv20max)

index.trmm.cl4 <- valueIndex1D(station.trmm.cl4$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.trmm.cl4.rv20max <- MaxReturnValue(station.trmm.cl4)
index.trmm.cl4 <- c(index.trmm.cl4, index.trmm.cl4.rv20max)

index.era5.cl4 <- valueIndex1D(station.era5.cl4$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.era5.cl4.rv20max <- MaxReturnValue(station.era5.cl4)
index.era5.cl4 <- c(index.era5.cl4, index.era5.cl4.rv20max)
```

```{r}
cal.station.cl4 <- biasCorrection(y = station.obs.cl4, x = station.trmm.cl4, precipitation = TRUE,  method = "pqm")


cal.station.cl4 <- subsetDimension(cal.station.cl4, dimension = "time", indices = which(!is.na(cal.station.cl4$Data)))

cal.station.cl4$Dates$start <- as.POSIXct(cal.station.cl4$Dates$start,tz = "GMT")
cal.station.cl4$Dates$end <- as.POSIXct(cal.station.cl4$Dates$end,tz = "GMT")

index.cal.station.cl4 <- valueIndex1D(cal.station.cl4$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl4 <- c(index.cal.station.cl4, valueIndex1D(cal.station.cl4$Data[!is.na(cal.station.cl4$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl4.rv20max <- MaxReturnValue(cal.station.cl4)

index.cal.station.cl4 <- c(index.cal.station.cl4, index.cal.station.cl4.rv20max)

index.cal.station.pqm.cl4 <- index.cal.station.cl4


```


```{r}
cal.station.cl4 <- biasCorrection(y = station.obs.cl4, x = station.trmm.cl4, precipitation = TRUE,  method = "eqm")


cal.station.cl4 <- subsetDimension(cal.station.cl4, dimension = "time", indices = which(!is.na(cal.station.cl4$Data)))

cal.station.cl4$Dates$start <- as.POSIXct(cal.station.cl4$Dates$start,tz = "GMT")
cal.station.cl4$Dates$end <- as.POSIXct(cal.station.cl4$Dates$end,tz = "GMT")

index.cal.station.cl4 <- valueIndex1D(cal.station.cl4$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl4 <- c(index.cal.station.cl4, valueIndex1D(cal.station.cl4$Data[!is.na(cal.station.cl4$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl4.rv20max <- MaxReturnValue(cal.station.cl4)

index.cal.station.cl4 <- c(index.cal.station.cl4, index.cal.station.cl4.rv20max)

index.cal.station.eqm.cl4 <- index.cal.station.cl4


```

```{r}
cal.station.cl4 <- biasCorrection(y = station.obs.cl4, x = station.trmm.cl4, precipitation = TRUE,  method = "gpqm")


cal.station.cl4 <- subsetDimension(cal.station.cl4, dimension = "time", indices = which(!is.na(cal.station.cl4$Data)))

cal.station.cl4$Dates$start <- as.POSIXct(cal.station.cl4$Dates$start,tz = "GMT")
cal.station.cl4$Dates$end <- as.POSIXct(cal.station.cl4$Dates$end,tz = "GMT")

index.cal.station.cl4 <- valueIndex1D(cal.station.cl4$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl4 <- c(index.cal.station.cl4, valueIndex1D(cal.station.cl4$Data[!is.na(cal.station.cl4$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl4.rv20max <- MaxReturnValue(cal.station.cl4)

index.cal.station.cl4 <- c(index.cal.station.cl4, index.cal.station.cl4.rv20max)

index.cal.station.gpqm.cl4 <- index.cal.station.cl4


```


```{r}
cal.station.cl4 <- biasCorrection(y = station.obs.cl4, x = station.trmm.cl4, precipitation = TRUE,  method = "gpqm" , theta = .7)


cal.station.cl4 <- subsetDimension(cal.station.cl4, dimension = "time", indices = which(!is.na(cal.station.cl4$Data)))

cal.station.cl4$Dates$start <- as.POSIXct(cal.station.cl4$Dates$start,tz = "GMT")
cal.station.cl4$Dates$end <- as.POSIXct(cal.station.cl4$Dates$end,tz = "GMT")

index.cal.station.cl4 <- valueIndex1D(cal.station.cl4$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl4 <- c(index.cal.station.cl4, valueIndex1D(cal.station.cl4$Data[!is.na(cal.station.cl4$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl4.rv20max <- MaxReturnValue(cal.station.cl4)

index.cal.station.cl4 <- c(index.cal.station.cl4, index.cal.station.cl4.rv20max)

index.cal.station.gpqm2.cl4 <- index.cal.station.cl4


```



```{r}
measures <- list()
for (i in c(1:9)) {
  measures[[length(measures)+1]] <- c(abs(index.trmm.cl4[i]-index.obs.cl4[i]),abs(index.era5.cl4[i]-index.obs.cl4[i]),abs(index.cal.station.pqm.cl4[i]-index.obs.cl4[i]), abs(index.cal.station.eqm.cl4[i]-index.obs.cl4[i]), abs(index.cal.station.gpqm.cl4[i]-index.obs.cl4[i]), abs(index.cal.station.gpqm2.cl4[i]-index.obs.cl4[i])) 
}

```

```{r}
norm.vector <- list()
for (i in c(1:length(measures))) {
  norm.vector[[length(norm.vector)+1]] <- normalization(measures[[i]]) 
}
```

```{r}
score.trmm <- c()
for (i in c(1:9)) {
  score.trmm <- c(score.trmm, norm.vector[[i]][1]) 
}
score.trmm <- mean(score.trmm)

score.era5 <- c()
for (i in c(1:9)) {
  score.era5 <- c(score.era5, norm.vector[[i]][2]) 
}
score.era5 <- mean(score.era5)

score.pqm <- c()
for (i in c(1:9)) {
  score.pqm <- c(score.pqm, norm.vector[[i]][3]) 
}
score.pqm <- mean(score.pqm)


score.eqm <- c()
for (i in c(1:9)) {
  score.eqm <- c(score.eqm, norm.vector[[i]][4]) 
}
score.eqm <- mean(score.eqm)


score.gpqm <- c()
for (i in c(1:9)) {
  score.gpqm <- c(score.gpqm, norm.vector[[i]][5]) 
}
score.gpqm <- mean(score.gpqm)

score.gpqm.cl5 <- c()


score.gpqm2 <- c()
for (i in c(1:9)) {
  score.gpqm2 <- c(score.gpqm2, norm.vector[[i]][6]) 
}
score.gpqm2 <- mean(score.gpqm2)



scores <- c(score.trmm,score.era5, score.pqm, score.eqm, score.gpqm, score.gpqm2)
names(scores) <- c("TRMM","ERA5","PQM-WT4","EQM-WT4","GPQM-WT4","GPQM2-WT4")
scores <- sort(scores, decreasing = T)
scores
```
```{r}
scores.st3.wt4 <- scores
```
### WT5

```{r}
station.obs.cl5 <- subsetDimension(station.obs, dimension = "time", indices = which(kmModel5$cluster == 5))


station.trmm.cl5 <- subsetDimension(station.trmm, dimension = "time", indices = which(kmModel5$cluster == 5))

station.era5.cl5 <- subsetDimension(station.era5, dimension = "time", indices = which(kmModel5$cluster == 5))
```

```{r}
index.obs.cl5 <- valueIndex1D(station.obs.cl5$Data[!is.na(station.obs.cl5$Data)],index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))
index.obs.cl5 <- c(index.obs.cl5, valueIndex1D(station.obs.cl5$Data[!is.na(station.obs.cl5$Data)], index.codes = "P98WetAmount"))
index.obs.cl5.rv20max <- MaxReturnValue(station.obs.cl5)
index.obs.cl5 <- c(index.obs.cl5, index.obs.cl5.rv20max)

index.trmm.cl5 <- valueIndex1D(station.trmm.cl5$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.trmm.cl5.rv20max <- MaxReturnValue(station.trmm.cl5)
index.trmm.cl5 <- c(index.trmm.cl5, index.trmm.cl5.rv20max)

index.era5.cl5 <- valueIndex1D(station.era5.cl5$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.era5.cl5.rv20max <- MaxReturnValue(station.era5.cl5)
index.era5.cl5 <- c(index.era5.cl5, index.era5.cl5.rv20max)
```

```{r}
cal.station.cl5 <- biasCorrection(y = station.obs.cl5, x = station.trmm.cl5, precipitation = TRUE,  method = "pqm")


cal.station.cl5 <- subsetDimension(cal.station.cl5, dimension = "time", indices = which(!is.na(cal.station.cl5$Data)))

cal.station.cl5$Dates$start <- as.POSIXct(cal.station.cl5$Dates$start,tz = "GMT")
cal.station.cl5$Dates$end <- as.POSIXct(cal.station.cl5$Dates$end,tz = "GMT")

index.cal.station.cl5 <- valueIndex1D(cal.station.cl5$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl5 <- c(index.cal.station.cl5, valueIndex1D(cal.station.cl5$Data[!is.na(cal.station.cl5$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl5.rv20max <- MaxReturnValue(cal.station.cl5)

index.cal.station.cl5 <- c(index.cal.station.cl5, index.cal.station.cl5.rv20max)

index.cal.station.pqm.cl5 <- index.cal.station.cl5


```


```{r}
cal.station.cl5 <- biasCorrection(y = station.obs.cl5, x = station.trmm.cl5, precipitation = TRUE,  method = "eqm")


cal.station.cl5 <- subsetDimension(cal.station.cl5, dimension = "time", indices = which(!is.na(cal.station.cl5$Data)))

cal.station.cl5$Dates$start <- as.POSIXct(cal.station.cl5$Dates$start,tz = "GMT")
cal.station.cl5$Dates$end <- as.POSIXct(cal.station.cl5$Dates$end,tz = "GMT")

index.cal.station.cl5 <- valueIndex1D(cal.station.cl5$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl5 <- c(index.cal.station.cl5, valueIndex1D(cal.station.cl5$Data[!is.na(cal.station.cl5$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl5.rv20max <- MaxReturnValue(cal.station.cl5)

index.cal.station.cl5 <- c(index.cal.station.cl5, index.cal.station.cl5.rv20max)

index.cal.station.eqm.cl5 <- index.cal.station.cl5


```

```{r}
cal.station.cl5 <- biasCorrection(y = station.obs.cl5, x = station.trmm.cl5, precipitation = TRUE,  method = "gpqm")


cal.station.cl5 <- subsetDimension(cal.station.cl5, dimension = "time", indices = which(!is.na(cal.station.cl5$Data)))

cal.station.cl5$Dates$start <- as.POSIXct(cal.station.cl5$Dates$start,tz = "GMT")
cal.station.cl5$Dates$end <- as.POSIXct(cal.station.cl5$Dates$end,tz = "GMT")

index.cal.station.cl5 <- valueIndex1D(cal.station.cl5$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl5 <- c(index.cal.station.cl5, valueIndex1D(cal.station.cl5$Data[!is.na(cal.station.cl5$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl5.rv20max <- MaxReturnValue(cal.station.cl5)

index.cal.station.cl5 <- c(index.cal.station.cl5, index.cal.station.cl5.rv20max)

index.cal.station.gpqm.cl5 <- index.cal.station.cl5


```


```{r}
cal.station.cl5 <- biasCorrection(y = station.obs.cl5, x = station.trmm.cl5, precipitation = TRUE,  method = "gpqm" , theta = .7)


cal.station.cl5 <- subsetDimension(cal.station.cl5, dimension = "time", indices = which(!is.na(cal.station.cl5$Data)))

cal.station.cl5$Dates$start <- as.POSIXct(cal.station.cl5$Dates$start,tz = "GMT")
cal.station.cl5$Dates$end <- as.POSIXct(cal.station.cl5$Dates$end,tz = "GMT")

index.cal.station.cl5 <- valueIndex1D(cal.station.cl5$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl5 <- c(index.cal.station.cl5, valueIndex1D(cal.station.cl5$Data[!is.na(cal.station.cl5$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl5.rv20max <- MaxReturnValue(cal.station.cl5)

index.cal.station.cl5 <- c(index.cal.station.cl5, index.cal.station.cl5.rv20max)

index.cal.station.gpqm2.cl5 <- index.cal.station.cl5


```



```{r}
measures <- list()
for (i in c(1:9)) {
  measures[[length(measures)+1]] <- c(abs(index.trmm.cl5[i]-index.obs.cl5[i]),abs(index.era5.cl5[i]-index.obs.cl5[i]),abs(index.cal.station.pqm.cl5[i]-index.obs.cl5[i]), abs(index.cal.station.eqm.cl5[i]-index.obs.cl5[i]), abs(index.cal.station.gpqm.cl5[i]-index.obs.cl5[i]), abs(index.cal.station.gpqm2.cl5[i]-index.obs.cl5[i])) 
}

```

```{r}
norm.vector <- list()
for (i in c(1:length(measures))) {
  norm.vector[[length(norm.vector)+1]] <- normalization(measures[[i]]) 
}
```

```{r}
score.trmm <- c()
for (i in c(1:9)) {
  score.trmm <- c(score.trmm, norm.vector[[i]][1]) 
}
score.trmm <- mean(score.trmm)

score.era5 <- c()
for (i in c(1:9)) {
  score.era5 <- c(score.era5, norm.vector[[i]][1]) 
}
score.era5 <- mean(score.era5)

score.pqm <- c()
for (i in c(1:9)) {
  score.pqm <- c(score.pqm, norm.vector[[i]][2]) 
}
score.pqm <- mean(score.pqm)


score.eqm <- c()
for (i in c(1:9)) {
  score.eqm <- c(score.eqm, norm.vector[[i]][3]) 
}
score.eqm <- mean(score.eqm)


score.gpqm <- c()
for (i in c(1:9)) {
  score.gpqm <- c(score.gpqm, norm.vector[[i]][4]) 
}
score.gpqm <- mean(score.gpqm)



score.gpqm2 <- c()
for (i in c(1:9)) {
  score.gpqm2 <- c(score.gpqm2, norm.vector[[i]][5]) 
}
score.gpqm2 <- mean(score.gpqm2)


scores <- c(score.trmm, score.era5, score.pqm, score.eqm, score.gpqm, score.gpqm2)
names(scores) <- c("TRMM","ERA5","PQM-WT5","EQM-WT5","GPQM-WT5","GPQM2-WT5")
scores <- sort(scores, decreasing = T)
scores
```
```{r}
scores.st3.wt5 <- scores
```
## Bells Beach, New Zealand


```{r}
i=4

station.trmm <- subsetGrid(precip_trmm, station.id = precip_trmm$Metadata$station_id[i])
station.obs <- subsetGrid(precip_obs, station.id = precip_trmm$Metadata$station_id[i])

idx <- which.min(abs(pp_reanalysis$xyCoords$x - station.obs$xyCoords$x))
lon <- pp_reanalysis$xyCoords$x[idx]
  
idx2 <- which.min(abs(pp_reanalysis$xyCoords$y - station.obs$xyCoords$y))
lat <- pp_reanalysis$xyCoords$y[idx2]
  
station.era5 <- subsetGrid(pp_reanalysis, lonLim = lon, latLim = lat)
```


````{r}
index.obs <- valueIndex1D(station.obs$Data[!is.na(station.obs$Data)],index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))
index.obs <- c(index.obs, valueIndex1D(station.obs$Data[!is.na(station.obs$Data)], index.codes = "P98WetAmount"))
index.obs.rv20max <- MaxReturnValue(station.obs)
index.obs <- c(index.obs, index.obs.rv20max)

index.trmm <- valueIndex1D(station.trmm$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.trmm.rv20max <- MaxReturnValue(station.trmm)
index.trmm <- c(index.trmm, index.trmm.rv20max)

index.era5 <- valueIndex1D(station.era5$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.era5.rv20max <- MaxReturnValue(station.era5)
index.era5 <- c(index.era5, index.era5.rv20max)

```



### WT1

```{r}
station.obs.cl1 <- subsetDimension(station.obs, dimension = "time", indices = which(kmModel5$cluster == 1))


station.trmm.cl1 <- subsetDimension(station.trmm, dimension = "time", indices = which(kmModel5$cluster == 1))

station.era5.cl1 <- subsetDimension(station.era5, dimension = "time", indices = which(kmModel5$cluster == 1))
```

```{r}
index.obs.cl1 <- valueIndex1D(station.obs.cl1$Data[!is.na(station.obs.cl1$Data)],index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))
index.obs.cl1 <- c(index.obs.cl1, valueIndex1D(station.obs.cl1$Data[!is.na(station.obs.cl1$Data)], index.codes = "P98WetAmount"))
index.obs.cl1.rv20max <- MaxReturnValue(station.obs.cl1)
index.obs.cl1 <- c(index.obs.cl1, index.obs.cl1.rv20max)

index.trmm.cl1 <- valueIndex1D(station.trmm.cl1$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.trmm.cl1.rv20max <- MaxReturnValue(station.trmm.cl1)
index.trmm.cl1 <- c(index.trmm.cl1, index.trmm.cl1.rv20max)

index.era5.cl1 <- valueIndex1D(station.era5.cl1$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.era5.cl1.rv20max <- MaxReturnValue(station.era5.cl1)
index.era5.cl1 <- c(index.era5.cl1, index.era5.cl1.rv20max)
```

```{r}
cal.station.cl1 <- biasCorrection(y = station.obs.cl1, x = station.trmm.cl1, precipitation = TRUE,  method = "pqm")


cal.station.cl1 <- subsetDimension(cal.station.cl1, dimension = "time", indices = which(!is.na(cal.station.cl1$Data)))

cal.station.cl1$Dates$start <- as.POSIXct(cal.station.cl1$Dates$start,tz = "GMT")
cal.station.cl1$Dates$end <- as.POSIXct(cal.station.cl1$Dates$end,tz = "GMT")

index.cal.station.cl1 <- valueIndex1D(cal.station.cl1$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl1 <- c(index.cal.station.cl1, valueIndex1D(cal.station.cl1$Data[!is.na(cal.station.cl1$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl1.rv20max <- MaxReturnValue(cal.station.cl1)

index.cal.station.cl1 <- c(index.cal.station.cl1, index.cal.station.cl1.rv20max)

index.cal.station.pqm.cl1 <- index.cal.station.cl1


```


```{r}
cal.station.cl1 <- biasCorrection(y = station.obs.cl1, x = station.trmm.cl1, precipitation = TRUE,  method = "eqm")


cal.station.cl1 <- subsetDimension(cal.station.cl1, dimension = "time", indices = which(!is.na(cal.station.cl1$Data)))

cal.station.cl1$Dates$start <- as.POSIXct(cal.station.cl1$Dates$start,tz = "GMT")
cal.station.cl1$Dates$end <- as.POSIXct(cal.station.cl1$Dates$end,tz = "GMT")

index.cal.station.cl1 <- valueIndex1D(cal.station.cl1$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl1 <- c(index.cal.station.cl1, valueIndex1D(cal.station.cl1$Data[!is.na(cal.station.cl1$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl1.rv20max <- MaxReturnValue(cal.station.cl1)

index.cal.station.cl1 <- c(index.cal.station.cl1, index.cal.station.cl1.rv20max)

index.cal.station.eqm.cl1 <- index.cal.station.cl1


```

```{r}
cal.station.cl1 <- biasCorrection(y = station.obs.cl1, x = station.trmm.cl1, precipitation = TRUE,  method = "gpqm")


cal.station.cl1 <- subsetDimension(cal.station.cl1, dimension = "time", indices = which(!is.na(cal.station.cl1$Data)))

cal.station.cl1$Dates$start <- as.POSIXct(cal.station.cl1$Dates$start,tz = "GMT")
cal.station.cl1$Dates$end <- as.POSIXct(cal.station.cl1$Dates$end,tz = "GMT")

index.cal.station.cl1 <- valueIndex1D(cal.station.cl1$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl1 <- c(index.cal.station.cl1, valueIndex1D(cal.station.cl1$Data[!is.na(cal.station.cl1$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl1.rv20max <- MaxReturnValue(cal.station.cl1)

index.cal.station.cl1 <- c(index.cal.station.cl1, index.cal.station.cl1.rv20max)

index.cal.station.gpqm.cl1 <- index.cal.station.cl1


```


```{r}
cal.station.cl1 <- biasCorrection(y = station.obs.cl1, x = station.trmm.cl1, precipitation = TRUE,  method = "gpqm" , theta = .7)


cal.station.cl1 <- subsetDimension(cal.station.cl1, dimension = "time", indices = which(!is.na(cal.station.cl1$Data)))

cal.station.cl1$Dates$start <- as.POSIXct(cal.station.cl1$Dates$start,tz = "GMT")
cal.station.cl1$Dates$end <- as.POSIXct(cal.station.cl1$Dates$end,tz = "GMT")

index.cal.station.cl1 <- valueIndex1D(cal.station.cl1$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl1 <- c(index.cal.station.cl1, valueIndex1D(cal.station.cl1$Data[!is.na(cal.station.cl1$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl1.rv20max <- MaxReturnValue(cal.station.cl1)

index.cal.station.cl1 <- c(index.cal.station.cl1, index.cal.station.cl1.rv20max)

index.cal.station.gpqm2.cl1 <- index.cal.station.cl1


```



```{r}
measures <- list()
for (i in c(1:9)) {
  measures[[length(measures)+1]] <- c(abs(index.trmm.cl1[i]-index.obs.cl1[i]),abs(index.era5.cl1[i]-index.obs.cl1[i]),abs(index.cal.station.pqm.cl1[i]-index.obs.cl1[i]), abs(index.cal.station.eqm.cl1[i]-index.obs.cl1[i]), abs(index.cal.station.gpqm.cl1[i]-index.obs.cl1[i]), abs(index.cal.station.gpqm2.cl1[i]-index.obs.cl1[i])) 
}

```

```{r}
normalization <- function(measure){
  measure.norm <- c()
  #measure must be a vector with the value of a certain measure of different calibrations
  for (i in c(1:length(measure))) {
    measure.norm <- c(measure.norm, 1-((measure[i]-min(measure))/(max(measure)-min(measure))))
  }
  return(measure.norm)
}
```

```{r}
norm.vector <- list()
for (i in c(1:length(measures))) {
  norm.vector[[length(norm.vector)+1]] <- normalization(measures[[i]]) 
}
```

```{r}
score.trmm <- c()
for (i in c(1:9)) {
  score.trmm <- c(score.trmm, norm.vector[[i]][1]) 
}
score.trmm <- mean(score.trmm)

score.era5 <- c()
for (i in c(1:9)) {
  score.era5 <- c(score.era5, norm.vector[[i]][2]) 
}
score.era5 <- mean(score.era5)

score.pqm <- c()
for (i in c(1:9)) {
  score.pqm <- c(score.pqm, norm.vector[[i]][3]) 
}
score.pqm <- mean(score.pqm)


score.eqm <- c()
for (i in c(1:9)) {
  score.eqm <- c(score.eqm, norm.vector[[i]][4]) 
}
score.eqm <- mean(score.eqm)


score.gpqm <- c()
for (i in c(1:9)) {
  score.gpqm <- c(score.gpqm, norm.vector[[i]][5]) 
}
score.gpqm <- mean(score.gpqm)


score.gpqm2 <- c()
for (i in c(1:9)) {
  score.gpqm2 <- c(score.gpqm2, norm.vector[[i]][6]) 
}
score.gpqm2 <- mean(score.gpqm2)




scores <- c(score.trmm,score.era5, score.pqm, score.eqm, score.gpqm, score.gpqm2)
names(scores) <- c("TRMM","ERA5","PQM-WT1","EQM-WT1","GPQM-WT1","GPQM2-WT1")
scores <- sort(scores, decreasing = T)
scores
```
```{r}
scores.st4.wt1 <- scores
```
### WT2
```{r}
station.obs.cl2 <- subsetDimension(station.obs, dimension = "time", indices = which(kmModel5$cluster == 2))


station.trmm.cl2 <- subsetDimension(station.trmm, dimension = "time", indices = which(kmModel5$cluster == 2))

station.era5.cl2 <- subsetDimension(station.era5, dimension = "time", indices = which(kmModel5$cluster == 2))
```

```{r}
index.obs.cl2 <- valueIndex1D(station.obs.cl2$Data[!is.na(station.obs.cl2$Data)],index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))
index.obs.cl2 <- c(index.obs.cl2, valueIndex1D(station.obs.cl2$Data[!is.na(station.obs.cl2$Data)], index.codes = "P98WetAmount"))
index.obs.cl2.rv20max <- MaxReturnValue(station.obs.cl2)
index.obs.cl2 <- c(index.obs.cl2, index.obs.cl2.rv20max)

index.trmm.cl2 <- valueIndex1D(station.trmm.cl2$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.trmm.cl2.rv20max <- MaxReturnValue(station.trmm.cl2)
index.trmm.cl2 <- c(index.trmm.cl2, index.trmm.cl2.rv20max)

index.era5.cl2 <- valueIndex1D(station.era5.cl2$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.era5.cl2.rv20max <- MaxReturnValue(station.era5.cl2)
index.era5.cl2 <- c(index.era5.cl2, index.era5.cl2.rv20max)
```

```{r}
cal.station.cl2 <- biasCorrection(y = station.obs.cl2, x = station.trmm.cl2, precipitation = TRUE,  method = "pqm")


cal.station.cl2 <- subsetDimension(cal.station.cl2, dimension = "time", indices = which(!is.na(cal.station.cl2$Data)))

cal.station.cl2$Dates$start <- as.POSIXct(cal.station.cl2$Dates$start,tz = "GMT")
cal.station.cl2$Dates$end <- as.POSIXct(cal.station.cl2$Dates$end,tz = "GMT")

index.cal.station.cl2 <- valueIndex1D(cal.station.cl2$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl2 <- c(index.cal.station.cl2, valueIndex1D(cal.station.cl2$Data[!is.na(cal.station.cl2$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl2.rv20max <- MaxReturnValue(cal.station.cl2)

index.cal.station.cl2 <- c(index.cal.station.cl2, index.cal.station.cl2.rv20max)

index.cal.station.pqm.cl2 <- index.cal.station.cl2


```


```{r}
cal.station.cl2 <- biasCorrection(y = station.obs.cl2, x = station.trmm.cl2, precipitation = TRUE,  method = "eqm")


cal.station.cl2 <- subsetDimension(cal.station.cl2, dimension = "time", indices = which(!is.na(cal.station.cl2$Data)))

cal.station.cl2$Dates$start <- as.POSIXct(cal.station.cl2$Dates$start,tz = "GMT")
cal.station.cl2$Dates$end <- as.POSIXct(cal.station.cl2$Dates$end,tz = "GMT")

index.cal.station.cl2 <- valueIndex1D(cal.station.cl2$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl2 <- c(index.cal.station.cl2, valueIndex1D(cal.station.cl2$Data[!is.na(cal.station.cl2$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl2.rv20max <- MaxReturnValue(cal.station.cl2)

index.cal.station.cl2 <- c(index.cal.station.cl2, index.cal.station.cl2.rv20max)

index.cal.station.eqm.cl2 <- index.cal.station.cl2


```

```{r}
cal.station.cl2 <- biasCorrection(y = station.obs.cl2, x = station.trmm.cl2, precipitation = TRUE,  method = "gpqm")


cal.station.cl2 <- subsetDimension(cal.station.cl2, dimension = "time", indices = which(!is.na(cal.station.cl2$Data)))

cal.station.cl2$Dates$start <- as.POSIXct(cal.station.cl2$Dates$start,tz = "GMT")
cal.station.cl2$Dates$end <- as.POSIXct(cal.station.cl2$Dates$end,tz = "GMT")

index.cal.station.cl2 <- valueIndex1D(cal.station.cl2$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl2 <- c(index.cal.station.cl2, valueIndex1D(cal.station.cl2$Data[!is.na(cal.station.cl2$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl2.rv20max <- MaxReturnValue(cal.station.cl2)

index.cal.station.cl2 <- c(index.cal.station.cl2, index.cal.station.cl2.rv20max)

index.cal.station.gpqm.cl2 <- index.cal.station.cl2


```


```{r}
cal.station.cl2 <- biasCorrection(y = station.obs.cl2, x = station.trmm.cl2, precipitation = TRUE,  method = "gpqm" , theta = .7)


cal.station.cl2 <- subsetDimension(cal.station.cl2, dimension = "time", indices = which(!is.na(cal.station.cl2$Data)))

cal.station.cl2$Dates$start <- as.POSIXct(cal.station.cl2$Dates$start,tz = "GMT")
cal.station.cl2$Dates$end <- as.POSIXct(cal.station.cl2$Dates$end,tz = "GMT")

index.cal.station.cl2 <- valueIndex1D(cal.station.cl2$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl2 <- c(index.cal.station.cl2, valueIndex1D(cal.station.cl2$Data[!is.na(cal.station.cl2$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl2.rv20max <- MaxReturnValue(cal.station.cl2)

index.cal.station.cl2 <- c(index.cal.station.cl2, index.cal.station.cl2.rv20max)

index.cal.station.gpqm2.cl2 <- index.cal.station.cl2


```



```{r}
measures <- list()
for (i in c(1:9)) {
  measures[[length(measures)+1]] <- c(abs(index.trmm.cl2[i]-index.obs.cl2[i]),abs(index.era5.cl2[i]-index.obs.cl2[i]),abs(index.cal.station.pqm.cl2[i]-index.obs.cl2[i]), abs(index.cal.station.eqm.cl2[i]-index.obs.cl2[i]), abs(index.cal.station.gpqm.cl2[i]-index.obs.cl2[i]), abs(index.cal.station.gpqm2.cl2[i]-index.obs.cl2[i])) 
}

```

```{r}
norm.vector <- list()
for (i in c(1:length(measures))) {
  norm.vector[[length(norm.vector)+1]] <- normalization(measures[[i]]) 
}
```

```{r}
score.trmm <- c()
for (i in c(1:9)) {
  score.trmm <- c(score.trmm, norm.vector[[i]][1]) 
}
score.trmm <- mean(score.trmm)

score.era5 <- c()
for (i in c(1:9)) {
  score.era5 <- c(score.era5, norm.vector[[i]][2]) 
}
score.era5 <- mean(score.era5)

score.pqm <- c()
for (i in c(1:9)) {
  score.pqm <- c(score.pqm, norm.vector[[i]][3]) 
}
score.pqm <- mean(score.pqm)


score.eqm <- c()
for (i in c(1:9)) {
  score.eqm <- c(score.eqm, norm.vector[[i]][4]) 
}
score.eqm <- mean(score.eqm)


score.gpqm <- c()
for (i in c(1:9)) {
  score.gpqm <- c(score.gpqm, norm.vector[[i]][5]) 
}
score.gpqm <- mean(score.gpqm)

score.gpqm2 <- c()
for (i in c(1:9)) {
  score.gpqm2 <- c(score.gpqm2, norm.vector[[i]][6]) 
}
score.gpqm2 <- mean(score.gpqm2)

scores <- c(score.trmm, score.era5, score.pqm, score.eqm, score.gpqm, score.gpqm2)
names(scores) <- c("TRMM","ERA5","PQM-WT1","EQM-WT1","GPQM-WT1","GPQM2-WT1")
scores <- sort(scores, decreasing = T)
scores
```
```{r}
scores.st4.wt2 <- scores
```
### WT3

```{r}
station.obs.cl3 <- subsetDimension(station.obs, dimension = "time", indices = which(kmModel5$cluster == 3))


station.trmm.cl3 <- subsetDimension(station.trmm, dimension = "time", indices = which(kmModel5$cluster == 3))

station.era5.cl3 <- subsetDimension(station.era5, dimension = "time", indices = which(kmModel5$cluster == 3))
```

```{r}
index.obs.cl3 <- valueIndex1D(station.obs.cl3$Data[!is.na(station.obs.cl3$Data)],index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))
index.obs.cl3 <- c(index.obs.cl3, valueIndex1D(station.obs.cl3$Data[!is.na(station.obs.cl3$Data)], index.codes = "P98WetAmount"))
index.obs.cl3.rv20max <- MaxReturnValue(station.obs.cl3)
index.obs.cl3 <- c(index.obs.cl3, index.obs.cl3.rv20max)

index.trmm.cl3 <- valueIndex1D(station.trmm.cl3$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.trmm.cl3.rv20max <- MaxReturnValue(station.trmm.cl3)
index.trmm.cl3 <- c(index.trmm.cl3, index.trmm.cl3.rv20max)

index.era5.cl3 <- valueIndex1D(station.era5.cl3$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.era5.cl3.rv20max <- MaxReturnValue(station.era5.cl3)
index.era5.cl3 <- c(index.era5.cl3, index.era5.cl3.rv20max)
```

```{r}
cal.station.cl3 <- biasCorrection(y = station.obs.cl3, x = station.trmm.cl3, precipitation = TRUE,  method = "pqm")


cal.station.cl3 <- subsetDimension(cal.station.cl3, dimension = "time", indices = which(!is.na(cal.station.cl3$Data)))

cal.station.cl3$Dates$start <- as.POSIXct(cal.station.cl3$Dates$start,tz = "GMT")
cal.station.cl3$Dates$end <- as.POSIXct(cal.station.cl3$Dates$end,tz = "GMT")

index.cal.station.cl3 <- valueIndex1D(cal.station.cl3$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl3 <- c(index.cal.station.cl3, valueIndex1D(cal.station.cl3$Data[!is.na(cal.station.cl3$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl3.rv20max <- MaxReturnValue(cal.station.cl3)

index.cal.station.cl3 <- c(index.cal.station.cl3, index.cal.station.cl3.rv20max)

index.cal.station.pqm.cl3 <- index.cal.station.cl3


```


```{r}
cal.station.cl3 <- biasCorrection(y = station.obs.cl3, x = station.trmm.cl3, precipitation = TRUE,  method = "eqm")


cal.station.cl3 <- subsetDimension(cal.station.cl3, dimension = "time", indices = which(!is.na(cal.station.cl3$Data)))

cal.station.cl3$Dates$start <- as.POSIXct(cal.station.cl3$Dates$start,tz = "GMT")
cal.station.cl3$Dates$end <- as.POSIXct(cal.station.cl3$Dates$end,tz = "GMT")

index.cal.station.cl3 <- valueIndex1D(cal.station.cl3$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl3 <- c(index.cal.station.cl3, valueIndex1D(cal.station.cl3$Data[!is.na(cal.station.cl3$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl3.rv20max <- MaxReturnValue(cal.station.cl3)

index.cal.station.cl3 <- c(index.cal.station.cl3, index.cal.station.cl3.rv20max)

index.cal.station.eqm.cl3 <- index.cal.station.cl3


```

```{r}
cal.station.cl3 <- biasCorrection(y = station.obs.cl3, x = station.trmm.cl3, precipitation = TRUE,  method = "gpqm")


cal.station.cl3 <- subsetDimension(cal.station.cl3, dimension = "time", indices = which(!is.na(cal.station.cl3$Data)))

cal.station.cl3$Dates$start <- as.POSIXct(cal.station.cl3$Dates$start,tz = "GMT")
cal.station.cl3$Dates$end <- as.POSIXct(cal.station.cl3$Dates$end,tz = "GMT")

index.cal.station.cl3 <- valueIndex1D(cal.station.cl3$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl3 <- c(index.cal.station.cl3, valueIndex1D(cal.station.cl3$Data[!is.na(cal.station.cl3$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl3.rv20max <- MaxReturnValue(cal.station.cl3)

index.cal.station.cl3 <- c(index.cal.station.cl3, index.cal.station.cl3.rv20max)

index.cal.station.gpqm.cl3 <- index.cal.station.cl3


```


```{r}
cal.station.cl3 <- biasCorrection(y = station.obs.cl3, x = station.trmm.cl3, precipitation = TRUE,  method = "gpqm" , theta = .7)


cal.station.cl3 <- subsetDimension(cal.station.cl3, dimension = "time", indices = which(!is.na(cal.station.cl3$Data)))

cal.station.cl3$Dates$start <- as.POSIXct(cal.station.cl3$Dates$start,tz = "GMT")
cal.station.cl3$Dates$end <- as.POSIXct(cal.station.cl3$Dates$end,tz = "GMT")

index.cal.station.cl3 <- valueIndex1D(cal.station.cl3$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl3 <- c(index.cal.station.cl3, valueIndex1D(cal.station.cl3$Data[!is.na(cal.station.cl3$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl3.rv20max <- MaxReturnValue(cal.station.cl3)

index.cal.station.cl3 <- c(index.cal.station.cl3, index.cal.station.cl3.rv20max)

index.cal.station.gpqm2.cl3 <- index.cal.station.cl3


```



```{r}
measures <- list()
for (i in c(1:9)) {
  measures[[length(measures)+1]] <- c(abs(index.trmm.cl3[i]-index.obs.cl3[i]),abs(index.era5.cl3[i]-index.obs.cl3[i]),abs(index.cal.station.pqm.cl3[i]-index.obs.cl3[i]), abs(index.cal.station.eqm.cl3[i]-index.obs.cl3[i]), abs(index.cal.station.gpqm.cl3[i]-index.obs.cl3[i]), abs(index.cal.station.gpqm2.cl3[i]-index.obs.cl3[i])) 
}

```

```{r}
norm.vector <- list()
for (i in c(1:length(measures))) {
  norm.vector[[length(norm.vector)+1]] <- normalization(measures[[i]]) 
}
```

```{r}
score.trmm <- c()
for (i in c(1:9)) {
  score.trmm <- c(score.trmm, norm.vector[[i]][1]) 
}
score.trmm <- mean(score.trmm)

score.era5 <- c()
for (i in c(1:9)) {
  score.era5 <- c(score.era5, norm.vector[[i]][2]) 
}
score.era5 <- mean(score.era5)

score.pqm <- c()
for (i in c(1:9)) {
  score.pqm <- c(score.pqm, norm.vector[[i]][3]) 
}
score.pqm <- mean(score.pqm)


score.eqm <- c()
for (i in c(1:9)) {
  score.eqm <- c(score.eqm, norm.vector[[i]][4]) 
}
score.eqm <- mean(score.eqm)


score.gpqm <- c()
for (i in c(1:9)) {
  score.gpqm <- c(score.gpqm, norm.vector[[i]][5]) 
}
score.gpqm <- mean(score.gpqm)

score.gpqm2 <- c()
for (i in c(1:9)) {
  score.gpqm2 <- c(score.gpqm2, norm.vector[[i]][6]) 
}
score.gpqm2 <- mean(score.gpqm2)


scores <- c(score.trmm,score.era5, score.pqm, score.eqm, score.gpqm, score.gpqm2)
names(scores) <- c("TRMM","ERA5","PQM-WT3","EQM-WT3","GPQM-WT3","GPQM2-WT3")
scores <- sort(scores, decreasing = T)
scores
```
```{r}
scores.st4.wt3 <- scores
```
### WT4

```{r}
station.obs.cl4 <- subsetDimension(station.obs, dimension = "time", indices = which(kmModel5$cluster == 4))


station.trmm.cl4 <- subsetDimension(station.trmm, dimension = "time", indices = which(kmModel5$cluster == 4))

station.era5.cl4 <- subsetDimension(station.era5, dimension = "time", indices = which(kmModel5$cluster == 4))
```

```{r}
index.obs.cl4 <- valueIndex1D(station.obs.cl4$Data[!is.na(station.obs.cl4$Data)],index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))
index.obs.cl4 <- c(index.obs.cl4, valueIndex1D(station.obs.cl4$Data[!is.na(station.obs.cl4$Data)], index.codes = "P98WetAmount"))
index.obs.cl4.rv20max <- MaxReturnValue(station.obs.cl4)
index.obs.cl4 <- c(index.obs.cl4, index.obs.cl4.rv20max)

index.trmm.cl4 <- valueIndex1D(station.trmm.cl4$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.trmm.cl4.rv20max <- MaxReturnValue(station.trmm.cl4)
index.trmm.cl4 <- c(index.trmm.cl4, index.trmm.cl4.rv20max)

index.era5.cl4 <- valueIndex1D(station.era5.cl4$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.era5.cl4.rv20max <- MaxReturnValue(station.era5.cl4)
index.era5.cl4 <- c(index.era5.cl4, index.era5.cl4.rv20max)
```

```{r}
cal.station.cl4 <- biasCorrection(y = station.obs.cl4, x = station.trmm.cl4, precipitation = TRUE,  method = "pqm")


cal.station.cl4 <- subsetDimension(cal.station.cl4, dimension = "time", indices = which(!is.na(cal.station.cl4$Data)))

cal.station.cl4$Dates$start <- as.POSIXct(cal.station.cl4$Dates$start,tz = "GMT")
cal.station.cl4$Dates$end <- as.POSIXct(cal.station.cl4$Dates$end,tz = "GMT")

index.cal.station.cl4 <- valueIndex1D(cal.station.cl4$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl4 <- c(index.cal.station.cl4, valueIndex1D(cal.station.cl4$Data[!is.na(cal.station.cl4$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl4.rv20max <- MaxReturnValue(cal.station.cl4)

index.cal.station.cl4 <- c(index.cal.station.cl4, index.cal.station.cl4.rv20max)

index.cal.station.pqm.cl4 <- index.cal.station.cl4


```


```{r}
cal.station.cl4 <- biasCorrection(y = station.obs.cl4, x = station.trmm.cl4, precipitation = TRUE,  method = "eqm")


cal.station.cl4 <- subsetDimension(cal.station.cl4, dimension = "time", indices = which(!is.na(cal.station.cl4$Data)))

cal.station.cl4$Dates$start <- as.POSIXct(cal.station.cl4$Dates$start,tz = "GMT")
cal.station.cl4$Dates$end <- as.POSIXct(cal.station.cl4$Dates$end,tz = "GMT")

index.cal.station.cl4 <- valueIndex1D(cal.station.cl4$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl4 <- c(index.cal.station.cl4, valueIndex1D(cal.station.cl4$Data[!is.na(cal.station.cl4$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl4.rv20max <- MaxReturnValue(cal.station.cl4)

index.cal.station.cl4 <- c(index.cal.station.cl4, index.cal.station.cl4.rv20max)

index.cal.station.eqm.cl4 <- index.cal.station.cl4


```

```{r}
cal.station.cl4 <- biasCorrection(y = station.obs.cl4, x = station.trmm.cl4, precipitation = TRUE,  method = "gpqm")


cal.station.cl4 <- subsetDimension(cal.station.cl4, dimension = "time", indices = which(!is.na(cal.station.cl4$Data)))

cal.station.cl4$Dates$start <- as.POSIXct(cal.station.cl4$Dates$start,tz = "GMT")
cal.station.cl4$Dates$end <- as.POSIXct(cal.station.cl4$Dates$end,tz = "GMT")

index.cal.station.cl4 <- valueIndex1D(cal.station.cl4$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl4 <- c(index.cal.station.cl4, valueIndex1D(cal.station.cl4$Data[!is.na(cal.station.cl4$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl4.rv20max <- MaxReturnValue(cal.station.cl4)

index.cal.station.cl4 <- c(index.cal.station.cl4, index.cal.station.cl4.rv20max)

index.cal.station.gpqm.cl4 <- index.cal.station.cl4


```


```{r}
cal.station.cl4 <- biasCorrection(y = station.obs.cl4, x = station.trmm.cl4, precipitation = TRUE,  method = "gpqm" , theta = .7)


cal.station.cl4 <- subsetDimension(cal.station.cl4, dimension = "time", indices = which(!is.na(cal.station.cl4$Data)))

cal.station.cl4$Dates$start <- as.POSIXct(cal.station.cl4$Dates$start,tz = "GMT")
cal.station.cl4$Dates$end <- as.POSIXct(cal.station.cl4$Dates$end,tz = "GMT")

index.cal.station.cl4 <- valueIndex1D(cal.station.cl4$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl4 <- c(index.cal.station.cl4, valueIndex1D(cal.station.cl4$Data[!is.na(cal.station.cl4$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl4.rv20max <- MaxReturnValue(cal.station.cl4)

index.cal.station.cl4 <- c(index.cal.station.cl4, index.cal.station.cl4.rv20max)

index.cal.station.gpqm2.cl4 <- index.cal.station.cl4


```



```{r}
measures <- list()
for (i in c(1:9)) {
  measures[[length(measures)+1]] <- c(abs(index.trmm.cl4[i]-index.obs.cl4[i]),abs(index.era5.cl4[i]-index.obs.cl4[i]),abs(index.cal.station.pqm.cl4[i]-index.obs.cl4[i]), abs(index.cal.station.eqm.cl4[i]-index.obs.cl4[i]), abs(index.cal.station.gpqm.cl4[i]-index.obs.cl4[i]), abs(index.cal.station.gpqm2.cl4[i]-index.obs.cl4[i])) 
}

```

```{r}
norm.vector <- list()
for (i in c(1:length(measures))) {
  norm.vector[[length(norm.vector)+1]] <- normalization(measures[[i]]) 
}
```

```{r}
score.trmm <- c()
for (i in c(1:9)) {
  score.trmm <- c(score.trmm, norm.vector[[i]][1]) 
}
score.trmm <- mean(score.trmm)

score.era5 <- c()
for (i in c(1:9)) {
  score.era5 <- c(score.era5, norm.vector[[i]][2]) 
}
score.era5 <- mean(score.era5)

score.pqm <- c()
for (i in c(1:9)) {
  score.pqm <- c(score.pqm, norm.vector[[i]][3]) 
}
score.pqm <- mean(score.pqm)


score.eqm <- c()
for (i in c(1:9)) {
  score.eqm <- c(score.eqm, norm.vector[[i]][4]) 
}
score.eqm <- mean(score.eqm)


score.gpqm <- c()
for (i in c(1:9)) {
  score.gpqm <- c(score.gpqm, norm.vector[[i]][5]) 
}
score.gpqm <- mean(score.gpqm)

score.gpqm.cl5 <- c()


score.gpqm2 <- c()
for (i in c(1:9)) {
  score.gpqm2 <- c(score.gpqm2, norm.vector[[i]][6]) 
}
score.gpqm2 <- mean(score.gpqm2)



scores <- c(score.trmm,score.era5, score.pqm, score.eqm, score.gpqm, score.gpqm2)
names(scores) <- c("TRMM","ERA5","PQM-WT4","EQM-WT4","GPQM-WT4","GPQM2-WT4")
scores <- sort(scores, decreasing = T)
scores
```
```{r}
scores.st4.wt4 <- scores
```
### WT5

```{r}
station.obs.cl5 <- subsetDimension(station.obs, dimension = "time", indices = which(kmModel5$cluster == 5))


station.trmm.cl5 <- subsetDimension(station.trmm, dimension = "time", indices = which(kmModel5$cluster == 5))

station.era5.cl5 <- subsetDimension(station.era5, dimension = "time", indices = which(kmModel5$cluster == 5))
```

```{r}
index.obs.cl5 <- valueIndex1D(station.obs.cl5$Data[!is.na(station.obs.cl5$Data)],index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))
index.obs.cl5 <- c(index.obs.cl5, valueIndex1D(station.obs.cl5$Data[!is.na(station.obs.cl5$Data)], index.codes = "P98WetAmount"))
index.obs.cl5.rv20max <- MaxReturnValue(station.obs.cl5)
index.obs.cl5 <- c(index.obs.cl5, index.obs.cl5.rv20max)

index.trmm.cl5 <- valueIndex1D(station.trmm.cl5$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.trmm.cl5.rv20max <- MaxReturnValue(station.trmm.cl5)
index.trmm.cl5 <- c(index.trmm.cl5, index.trmm.cl5.rv20max)

index.era5.cl5 <- valueIndex1D(station.era5.cl5$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.era5.cl5.rv20max <- MaxReturnValue(station.era5.cl5)
index.era5.cl5 <- c(index.era5.cl5, index.era5.cl5.rv20max)
```

```{r}
cal.station.cl5 <- biasCorrection(y = station.obs.cl5, x = station.trmm.cl5, precipitation = TRUE,  method = "pqm")


cal.station.cl5 <- subsetDimension(cal.station.cl5, dimension = "time", indices = which(!is.na(cal.station.cl5$Data)))

cal.station.cl5$Dates$start <- as.POSIXct(cal.station.cl5$Dates$start,tz = "GMT")
cal.station.cl5$Dates$end <- as.POSIXct(cal.station.cl5$Dates$end,tz = "GMT")

index.cal.station.cl5 <- valueIndex1D(cal.station.cl5$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl5 <- c(index.cal.station.cl5, valueIndex1D(cal.station.cl5$Data[!is.na(cal.station.cl5$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl5.rv20max <- MaxReturnValue(cal.station.cl5)

index.cal.station.cl5 <- c(index.cal.station.cl5, index.cal.station.cl5.rv20max)

index.cal.station.pqm.cl5 <- index.cal.station.cl5


```


```{r}
cal.station.cl5 <- biasCorrection(y = station.obs.cl5, x = station.trmm.cl5, precipitation = TRUE,  method = "eqm")


cal.station.cl5 <- subsetDimension(cal.station.cl5, dimension = "time", indices = which(!is.na(cal.station.cl5$Data)))

cal.station.cl5$Dates$start <- as.POSIXct(cal.station.cl5$Dates$start,tz = "GMT")
cal.station.cl5$Dates$end <- as.POSIXct(cal.station.cl5$Dates$end,tz = "GMT")

index.cal.station.cl5 <- valueIndex1D(cal.station.cl5$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl5 <- c(index.cal.station.cl5, valueIndex1D(cal.station.cl5$Data[!is.na(cal.station.cl5$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl5.rv20max <- MaxReturnValue(cal.station.cl5)

index.cal.station.cl5 <- c(index.cal.station.cl5, index.cal.station.cl5.rv20max)

index.cal.station.eqm.cl5 <- index.cal.station.cl5


```

```{r}
cal.station.cl5 <- biasCorrection(y = station.obs.cl5, x = station.trmm.cl5, precipitation = TRUE,  method = "gpqm")


cal.station.cl5 <- subsetDimension(cal.station.cl5, dimension = "time", indices = which(!is.na(cal.station.cl5$Data)))

cal.station.cl5$Dates$start <- as.POSIXct(cal.station.cl5$Dates$start,tz = "GMT")
cal.station.cl5$Dates$end <- as.POSIXct(cal.station.cl5$Dates$end,tz = "GMT")

index.cal.station.cl5 <- valueIndex1D(cal.station.cl5$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl5 <- c(index.cal.station.cl5, valueIndex1D(cal.station.cl5$Data[!is.na(cal.station.cl5$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl5.rv20max <- MaxReturnValue(cal.station.cl5)

index.cal.station.cl5 <- c(index.cal.station.cl5, index.cal.station.cl5.rv20max)

index.cal.station.gpqm.cl5 <- index.cal.station.cl5


```


```{r}
cal.station.cl5 <- biasCorrection(y = station.obs.cl5, x = station.trmm.cl5, precipitation = TRUE,  method = "gpqm" , theta = .7)


cal.station.cl5 <- subsetDimension(cal.station.cl5, dimension = "time", indices = which(!is.na(cal.station.cl5$Data)))

cal.station.cl5$Dates$start <- as.POSIXct(cal.station.cl5$Dates$start,tz = "GMT")
cal.station.cl5$Dates$end <- as.POSIXct(cal.station.cl5$Dates$end,tz = "GMT")

index.cal.station.cl5 <- valueIndex1D(cal.station.cl5$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl5 <- c(index.cal.station.cl5, valueIndex1D(cal.station.cl5$Data[!is.na(cal.station.cl5$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl5.rv20max <- MaxReturnValue(cal.station.cl5)

index.cal.station.cl5 <- c(index.cal.station.cl5, index.cal.station.cl5.rv20max)

index.cal.station.gpqm2.cl5 <- index.cal.station.cl5


```



```{r}
measures <- list()
for (i in c(1:9)) {
  measures[[length(measures)+1]] <- c(abs(index.trmm.cl5[i]-index.obs.cl5[i]),abs(index.era5.cl5[i]-index.obs.cl5[i]),abs(index.cal.station.pqm.cl5[i]-index.obs.cl5[i]), abs(index.cal.station.eqm.cl5[i]-index.obs.cl5[i]), abs(index.cal.station.gpqm.cl5[i]-index.obs.cl5[i]), abs(index.cal.station.gpqm2.cl5[i]-index.obs.cl5[i])) 
}

```

```{r}
norm.vector <- list()
for (i in c(1:length(measures))) {
  norm.vector[[length(norm.vector)+1]] <- normalization(measures[[i]]) 
}
```

```{r}
score.trmm <- c()
for (i in c(1:9)) {
  score.trmm <- c(score.trmm, norm.vector[[i]][1]) 
}
score.trmm <- mean(score.trmm)

score.era5 <- c()
for (i in c(1:9)) {
  score.era5 <- c(score.era5, norm.vector[[i]][1]) 
}
score.era5 <- mean(score.era5)

score.pqm <- c()
for (i in c(1:9)) {
  score.pqm <- c(score.pqm, norm.vector[[i]][2]) 
}
score.pqm <- mean(score.pqm)


score.eqm <- c()
for (i in c(1:9)) {
  score.eqm <- c(score.eqm, norm.vector[[i]][3]) 
}
score.eqm <- mean(score.eqm)


score.gpqm <- c()
for (i in c(1:9)) {
  score.gpqm <- c(score.gpqm, norm.vector[[i]][4]) 
}
score.gpqm <- mean(score.gpqm)



score.gpqm2 <- c()
for (i in c(1:9)) {
  score.gpqm2 <- c(score.gpqm2, norm.vector[[i]][5]) 
}
score.gpqm2 <- mean(score.gpqm2)


scores <- c(score.trmm, score.era5, score.pqm, score.eqm, score.gpqm, score.gpqm2)
names(scores) <- c("TRMM","ERA5","PQM-WT5","EQM-WT5","GPQM-WT5","GPQM2-WT5")
scores <- sort(scores, decreasing = T)
scores
```

```{r}
scores.st4.wt5 <- scores
```

## ocean buoy?


```{r}
i=5

station.trmm <- subsetGrid(precip_trmm, station.id = precip_trmm$Metadata$station_id[i])
station.obs <- subsetGrid(precip_obs, station.id = precip_trmm$Metadata$station_id[i])

idx <- which.min(abs(pp_reanalysis$xyCoords$x - station.obs$xyCoords$x))
lon <- pp_reanalysis$xyCoords$x[idx]
  
idx2 <- which.min(abs(pp_reanalysis$xyCoords$y - station.obs$xyCoords$y))
lat <- pp_reanalysis$xyCoords$y[idx2]
  
station.era5 <- subsetGrid(pp_reanalysis, lonLim = lon, latLim = lat)
```


````{r}
index.obs <- valueIndex1D(station.obs$Data[!is.na(station.obs$Data)],index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))
index.obs <- c(index.obs, valueIndex1D(station.obs$Data[!is.na(station.obs$Data)], index.codes = "P98WetAmount"))
index.obs.rv20max <- MaxReturnValue(station.obs)
index.obs <- c(index.obs, index.obs.rv20max)

index.trmm <- valueIndex1D(station.trmm$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.trmm.rv20max <- MaxReturnValue(station.trmm)
index.trmm <- c(index.trmm, index.trmm.rv20max)

index.era5 <- valueIndex1D(station.era5$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.era5.rv20max <- MaxReturnValue(station.era5)
index.era5 <- c(index.era5, index.era5.rv20max)

```



### WT1

```{r}
station.obs.cl1 <- subsetDimension(station.obs, dimension = "time", indices = which(kmModel5$cluster == 1))


station.trmm.cl1 <- subsetDimension(station.trmm, dimension = "time", indices = which(kmModel5$cluster == 1))

station.era5.cl1 <- subsetDimension(station.era5, dimension = "time", indices = which(kmModel5$cluster == 1))
```

```{r}
index.obs.cl1 <- valueIndex1D(station.obs.cl1$Data[!is.na(station.obs.cl1$Data)],index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))
index.obs.cl1 <- c(index.obs.cl1, valueIndex1D(station.obs.cl1$Data[!is.na(station.obs.cl1$Data)], index.codes = "P98WetAmount"))
index.obs.cl1.rv20max <- MaxReturnValue(station.obs.cl1)
index.obs.cl1 <- c(index.obs.cl1, index.obs.cl1.rv20max)

index.trmm.cl1 <- valueIndex1D(station.trmm.cl1$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.trmm.cl1.rv20max <- MaxReturnValue(station.trmm.cl1)
index.trmm.cl1 <- c(index.trmm.cl1, index.trmm.cl1.rv20max)

index.era5.cl1 <- valueIndex1D(station.era5.cl1$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.era5.cl1.rv20max <- MaxReturnValue(station.era5.cl1)
index.era5.cl1 <- c(index.era5.cl1, index.era5.cl1.rv20max)
```

```{r}
cal.station.cl1 <- biasCorrection(y = station.obs.cl1, x = station.trmm.cl1, precipitation = TRUE,  method = "pqm")


cal.station.cl1 <- subsetDimension(cal.station.cl1, dimension = "time", indices = which(!is.na(cal.station.cl1$Data)))

cal.station.cl1$Dates$start <- as.POSIXct(cal.station.cl1$Dates$start,tz = "GMT")
cal.station.cl1$Dates$end <- as.POSIXct(cal.station.cl1$Dates$end,tz = "GMT")

index.cal.station.cl1 <- valueIndex1D(cal.station.cl1$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl1 <- c(index.cal.station.cl1, valueIndex1D(cal.station.cl1$Data[!is.na(cal.station.cl1$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl1.rv20max <- MaxReturnValue(cal.station.cl1)

index.cal.station.cl1 <- c(index.cal.station.cl1, index.cal.station.cl1.rv20max)

index.cal.station.pqm.cl1 <- index.cal.station.cl1


```


```{r}
cal.station.cl1 <- biasCorrection(y = station.obs.cl1, x = station.trmm.cl1, precipitation = TRUE,  method = "eqm")


cal.station.cl1 <- subsetDimension(cal.station.cl1, dimension = "time", indices = which(!is.na(cal.station.cl1$Data)))

cal.station.cl1$Dates$start <- as.POSIXct(cal.station.cl1$Dates$start,tz = "GMT")
cal.station.cl1$Dates$end <- as.POSIXct(cal.station.cl1$Dates$end,tz = "GMT")

index.cal.station.cl1 <- valueIndex1D(cal.station.cl1$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl1 <- c(index.cal.station.cl1, valueIndex1D(cal.station.cl1$Data[!is.na(cal.station.cl1$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl1.rv20max <- MaxReturnValue(cal.station.cl1)

index.cal.station.cl1 <- c(index.cal.station.cl1, index.cal.station.cl1.rv20max)

index.cal.station.eqm.cl1 <- index.cal.station.cl1


```

```{r}
cal.station.cl1 <- biasCorrection(y = station.obs.cl1, x = station.trmm.cl1, precipitation = TRUE,  method = "gpqm")


cal.station.cl1 <- subsetDimension(cal.station.cl1, dimension = "time", indices = which(!is.na(cal.station.cl1$Data)))

cal.station.cl1$Dates$start <- as.POSIXct(cal.station.cl1$Dates$start,tz = "GMT")
cal.station.cl1$Dates$end <- as.POSIXct(cal.station.cl1$Dates$end,tz = "GMT")

index.cal.station.cl1 <- valueIndex1D(cal.station.cl1$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl1 <- c(index.cal.station.cl1, valueIndex1D(cal.station.cl1$Data[!is.na(cal.station.cl1$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl1.rv20max <- MaxReturnValue(cal.station.cl1)

index.cal.station.cl1 <- c(index.cal.station.cl1, index.cal.station.cl1.rv20max)

index.cal.station.gpqm.cl1 <- index.cal.station.cl1


```


```{r}
cal.station.cl1 <- biasCorrection(y = station.obs.cl1, x = station.trmm.cl1, precipitation = TRUE,  method = "gpqm" , theta = .7)


cal.station.cl1 <- subsetDimension(cal.station.cl1, dimension = "time", indices = which(!is.na(cal.station.cl1$Data)))

cal.station.cl1$Dates$start <- as.POSIXct(cal.station.cl1$Dates$start,tz = "GMT")
cal.station.cl1$Dates$end <- as.POSIXct(cal.station.cl1$Dates$end,tz = "GMT")

index.cal.station.cl1 <- valueIndex1D(cal.station.cl1$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl1 <- c(index.cal.station.cl1, valueIndex1D(cal.station.cl1$Data[!is.na(cal.station.cl1$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl1.rv20max <- MaxReturnValue(cal.station.cl1)

index.cal.station.cl1 <- c(index.cal.station.cl1, index.cal.station.cl1.rv20max)

index.cal.station.gpqm2.cl1 <- index.cal.station.cl1


```



```{r}
measures <- list()
for (i in c(1:9)) {
  measures[[length(measures)+1]] <- c(abs(index.trmm.cl1[i]-index.obs.cl1[i]),abs(index.era5.cl1[i]-index.obs.cl1[i]),abs(index.cal.station.pqm.cl1[i]-index.obs.cl1[i]), abs(index.cal.station.eqm.cl1[i]-index.obs.cl1[i]), abs(index.cal.station.gpqm.cl1[i]-index.obs.cl1[i]), abs(index.cal.station.gpqm2.cl1[i]-index.obs.cl1[i])) 
}

```

```{r}
normalization <- function(measure){
  measure.norm <- c()
  #measure must be a vector with the value of a certain measure of different calibrations
  for (i in c(1:length(measure))) {
    measure.norm <- c(measure.norm, 1-((measure[i]-min(measure))/(max(measure)-min(measure))))
  }
  return(measure.norm)
}
```

```{r}
norm.vector <- list()
for (i in c(1:length(measures))) {
  norm.vector[[length(norm.vector)+1]] <- normalization(measures[[i]]) 
}
```

```{r}
score.trmm <- c()
for (i in c(1:9)) {
  score.trmm <- c(score.trmm, norm.vector[[i]][1]) 
}
score.trmm <- mean(score.trmm)

score.era5 <- c()
for (i in c(1:9)) {
  score.era5 <- c(score.era5, norm.vector[[i]][2]) 
}
score.era5 <- mean(score.era5)

score.pqm <- c()
for (i in c(1:9)) {
  score.pqm <- c(score.pqm, norm.vector[[i]][3]) 
}
score.pqm <- mean(score.pqm)


score.eqm <- c()
for (i in c(1:9)) {
  score.eqm <- c(score.eqm, norm.vector[[i]][4]) 
}
score.eqm <- mean(score.eqm)


score.gpqm <- c()
for (i in c(1:9)) {
  score.gpqm <- c(score.gpqm, norm.vector[[i]][5]) 
}
score.gpqm <- mean(score.gpqm)


score.gpqm2 <- c()
for (i in c(1:9)) {
  score.gpqm2 <- c(score.gpqm2, norm.vector[[i]][6]) 
}
score.gpqm2 <- mean(score.gpqm2)




scores <- c(score.trmm,score.era5, score.pqm, score.eqm, score.gpqm, score.gpqm2)
names(scores) <- c("TRMM","ERA5","PQM-WT1","EQM-WT1","GPQM-WT1","GPQM2-WT1")
scores <- sort(scores, decreasing = T)
scores
```
```{r}
scores.st5.wt1 <- scores
```
### WT2
```{r}
station.obs.cl2 <- subsetDimension(station.obs, dimension = "time", indices = which(kmModel5$cluster == 2))


station.trmm.cl2 <- subsetDimension(station.trmm, dimension = "time", indices = which(kmModel5$cluster == 2))

station.era5.cl2 <- subsetDimension(station.era5, dimension = "time", indices = which(kmModel5$cluster == 2))
```

```{r}
index.obs.cl2 <- valueIndex1D(station.obs.cl2$Data[!is.na(station.obs.cl2$Data)],index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))
index.obs.cl2 <- c(index.obs.cl2, valueIndex1D(station.obs.cl2$Data[!is.na(station.obs.cl2$Data)], index.codes = "P98WetAmount"))
index.obs.cl2.rv20max <- MaxReturnValue(station.obs.cl2)
index.obs.cl2 <- c(index.obs.cl2, index.obs.cl2.rv20max)

index.trmm.cl2 <- valueIndex1D(station.trmm.cl2$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.trmm.cl2.rv20max <- MaxReturnValue(station.trmm.cl2)
index.trmm.cl2 <- c(index.trmm.cl2, index.trmm.cl2.rv20max)

index.era5.cl2 <- valueIndex1D(station.era5.cl2$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.era5.cl2.rv20max <- MaxReturnValue(station.era5.cl2)
index.era5.cl2 <- c(index.era5.cl2, index.era5.cl2.rv20max)
```

```{r}
cal.station.cl2 <- biasCorrection(y = station.obs.cl2, x = station.trmm.cl2, precipitation = TRUE,  method = "pqm")


cal.station.cl2 <- subsetDimension(cal.station.cl2, dimension = "time", indices = which(!is.na(cal.station.cl2$Data)))

cal.station.cl2$Dates$start <- as.POSIXct(cal.station.cl2$Dates$start,tz = "GMT")
cal.station.cl2$Dates$end <- as.POSIXct(cal.station.cl2$Dates$end,tz = "GMT")

index.cal.station.cl2 <- valueIndex1D(cal.station.cl2$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl2 <- c(index.cal.station.cl2, valueIndex1D(cal.station.cl2$Data[!is.na(cal.station.cl2$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl2.rv20max <- MaxReturnValue(cal.station.cl2)

index.cal.station.cl2 <- c(index.cal.station.cl2, index.cal.station.cl2.rv20max)

index.cal.station.pqm.cl2 <- index.cal.station.cl2


```


```{r}
cal.station.cl2 <- biasCorrection(y = station.obs.cl2, x = station.trmm.cl2, precipitation = TRUE,  method = "eqm")


cal.station.cl2 <- subsetDimension(cal.station.cl2, dimension = "time", indices = which(!is.na(cal.station.cl2$Data)))

cal.station.cl2$Dates$start <- as.POSIXct(cal.station.cl2$Dates$start,tz = "GMT")
cal.station.cl2$Dates$end <- as.POSIXct(cal.station.cl2$Dates$end,tz = "GMT")

index.cal.station.cl2 <- valueIndex1D(cal.station.cl2$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl2 <- c(index.cal.station.cl2, valueIndex1D(cal.station.cl2$Data[!is.na(cal.station.cl2$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl2.rv20max <- MaxReturnValue(cal.station.cl2)

index.cal.station.cl2 <- c(index.cal.station.cl2, index.cal.station.cl2.rv20max)

index.cal.station.eqm.cl2 <- index.cal.station.cl2


```

```{r}
cal.station.cl2 <- biasCorrection(y = station.obs.cl2, x = station.trmm.cl2, precipitation = TRUE,  method = "gpqm")


cal.station.cl2 <- subsetDimension(cal.station.cl2, dimension = "time", indices = which(!is.na(cal.station.cl2$Data)))

cal.station.cl2$Dates$start <- as.POSIXct(cal.station.cl2$Dates$start,tz = "GMT")
cal.station.cl2$Dates$end <- as.POSIXct(cal.station.cl2$Dates$end,tz = "GMT")

index.cal.station.cl2 <- valueIndex1D(cal.station.cl2$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl2 <- c(index.cal.station.cl2, valueIndex1D(cal.station.cl2$Data[!is.na(cal.station.cl2$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl2.rv20max <- MaxReturnValue(cal.station.cl2)

index.cal.station.cl2 <- c(index.cal.station.cl2, index.cal.station.cl2.rv20max)

index.cal.station.gpqm.cl2 <- index.cal.station.cl2


```


```{r}
cal.station.cl2 <- biasCorrection(y = station.obs.cl2, x = station.trmm.cl2, precipitation = TRUE,  method = "gpqm" , theta = .7)


cal.station.cl2 <- subsetDimension(cal.station.cl2, dimension = "time", indices = which(!is.na(cal.station.cl2$Data)))

cal.station.cl2$Dates$start <- as.POSIXct(cal.station.cl2$Dates$start,tz = "GMT")
cal.station.cl2$Dates$end <- as.POSIXct(cal.station.cl2$Dates$end,tz = "GMT")

index.cal.station.cl2 <- valueIndex1D(cal.station.cl2$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl2 <- c(index.cal.station.cl2, valueIndex1D(cal.station.cl2$Data[!is.na(cal.station.cl2$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl2.rv20max <- MaxReturnValue(cal.station.cl2)

index.cal.station.cl2 <- c(index.cal.station.cl2, index.cal.station.cl2.rv20max)

index.cal.station.gpqm2.cl2 <- index.cal.station.cl2


```



```{r}
measures <- list()
for (i in c(1:9)) {
  measures[[length(measures)+1]] <- c(abs(index.trmm.cl2[i]-index.obs.cl2[i]),abs(index.era5.cl2[i]-index.obs.cl2[i]),abs(index.cal.station.pqm.cl2[i]-index.obs.cl2[i]), abs(index.cal.station.eqm.cl2[i]-index.obs.cl2[i]), abs(index.cal.station.gpqm.cl2[i]-index.obs.cl2[i]), abs(index.cal.station.gpqm2.cl2[i]-index.obs.cl2[i])) 
}

```

```{r}
norm.vector <- list()
for (i in c(1:length(measures))) {
  norm.vector[[length(norm.vector)+1]] <- normalization(measures[[i]]) 
}
```

```{r}
score.trmm <- c()
for (i in c(1:9)) {
  score.trmm <- c(score.trmm, norm.vector[[i]][1]) 
}
score.trmm <- mean(score.trmm)

score.era5 <- c()
for (i in c(1:9)) {
  score.era5 <- c(score.era5, norm.vector[[i]][2]) 
}
score.era5 <- mean(score.era5)

score.pqm <- c()
for (i in c(1:9)) {
  score.pqm <- c(score.pqm, norm.vector[[i]][3]) 
}
score.pqm <- mean(score.pqm)


score.eqm <- c()
for (i in c(1:9)) {
  score.eqm <- c(score.eqm, norm.vector[[i]][4]) 
}
score.eqm <- mean(score.eqm)


score.gpqm <- c()
for (i in c(1:9)) {
  score.gpqm <- c(score.gpqm, norm.vector[[i]][5]) 
}
score.gpqm <- mean(score.gpqm)

score.gpqm2 <- c()
for (i in c(1:9)) {
  score.gpqm2 <- c(score.gpqm2, norm.vector[[i]][6]) 
}
score.gpqm2 <- mean(score.gpqm2)

scores <- c(score.trmm, score.era5, score.pqm, score.eqm, score.gpqm, score.gpqm2)
names(scores) <- c("TRMM","ERA5","PQM-WT1","EQM-WT1","GPQM-WT1","GPQM2-WT1")
scores <- sort(scores, decreasing = T)
scores
```
```{r}
scores.st5.wt2 <- scores
```
### WT3

```{r}
station.obs.cl3 <- subsetDimension(station.obs, dimension = "time", indices = which(kmModel5$cluster == 3))


station.trmm.cl3 <- subsetDimension(station.trmm, dimension = "time", indices = which(kmModel5$cluster == 3))

station.era5.cl3 <- subsetDimension(station.era5, dimension = "time", indices = which(kmModel5$cluster == 3))
```

```{r}
index.obs.cl3 <- valueIndex1D(station.obs.cl3$Data[!is.na(station.obs.cl3$Data)],index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))
index.obs.cl3 <- c(index.obs.cl3, valueIndex1D(station.obs.cl3$Data[!is.na(station.obs.cl3$Data)], index.codes = "P98WetAmount"))
index.obs.cl3.rv20max <- MaxReturnValue(station.obs.cl3)
index.obs.cl3 <- c(index.obs.cl3, index.obs.cl3.rv20max)

index.trmm.cl3 <- valueIndex1D(station.trmm.cl3$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.trmm.cl3.rv20max <- MaxReturnValue(station.trmm.cl3)
index.trmm.cl3 <- c(index.trmm.cl3, index.trmm.cl3.rv20max)

index.era5.cl3 <- valueIndex1D(station.era5.cl3$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.era5.cl3.rv20max <- MaxReturnValue(station.era5.cl3)
index.era5.cl3 <- c(index.era5.cl3, index.era5.cl3.rv20max)
```

```{r}
cal.station.cl3 <- biasCorrection(y = station.obs.cl3, x = station.trmm.cl3, precipitation = TRUE,  method = "pqm")


cal.station.cl3 <- subsetDimension(cal.station.cl3, dimension = "time", indices = which(!is.na(cal.station.cl3$Data)))

cal.station.cl3$Dates$start <- as.POSIXct(cal.station.cl3$Dates$start,tz = "GMT")
cal.station.cl3$Dates$end <- as.POSIXct(cal.station.cl3$Dates$end,tz = "GMT")

index.cal.station.cl3 <- valueIndex1D(cal.station.cl3$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl3 <- c(index.cal.station.cl3, valueIndex1D(cal.station.cl3$Data[!is.na(cal.station.cl3$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl3.rv20max <- MaxReturnValue(cal.station.cl3)

index.cal.station.cl3 <- c(index.cal.station.cl3, index.cal.station.cl3.rv20max)

index.cal.station.pqm.cl3 <- index.cal.station.cl3


```


```{r}
cal.station.cl3 <- biasCorrection(y = station.obs.cl3, x = station.trmm.cl3, precipitation = TRUE,  method = "eqm")


cal.station.cl3 <- subsetDimension(cal.station.cl3, dimension = "time", indices = which(!is.na(cal.station.cl3$Data)))

cal.station.cl3$Dates$start <- as.POSIXct(cal.station.cl3$Dates$start,tz = "GMT")
cal.station.cl3$Dates$end <- as.POSIXct(cal.station.cl3$Dates$end,tz = "GMT")

index.cal.station.cl3 <- valueIndex1D(cal.station.cl3$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl3 <- c(index.cal.station.cl3, valueIndex1D(cal.station.cl3$Data[!is.na(cal.station.cl3$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl3.rv20max <- MaxReturnValue(cal.station.cl3)

index.cal.station.cl3 <- c(index.cal.station.cl3, index.cal.station.cl3.rv20max)

index.cal.station.eqm.cl3 <- index.cal.station.cl3


```

```{r}
cal.station.cl3 <- biasCorrection(y = station.obs.cl3, x = station.trmm.cl3, precipitation = TRUE,  method = "gpqm")


cal.station.cl3 <- subsetDimension(cal.station.cl3, dimension = "time", indices = which(!is.na(cal.station.cl3$Data)))

cal.station.cl3$Dates$start <- as.POSIXct(cal.station.cl3$Dates$start,tz = "GMT")
cal.station.cl3$Dates$end <- as.POSIXct(cal.station.cl3$Dates$end,tz = "GMT")

index.cal.station.cl3 <- valueIndex1D(cal.station.cl3$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl3 <- c(index.cal.station.cl3, valueIndex1D(cal.station.cl3$Data[!is.na(cal.station.cl3$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl3.rv20max <- MaxReturnValue(cal.station.cl3)

index.cal.station.cl3 <- c(index.cal.station.cl3, index.cal.station.cl3.rv20max)

index.cal.station.gpqm.cl3 <- index.cal.station.cl3


```


```{r}
cal.station.cl3 <- biasCorrection(y = station.obs.cl3, x = station.trmm.cl3, precipitation = TRUE,  method = "gpqm" , theta = .7)


cal.station.cl3 <- subsetDimension(cal.station.cl3, dimension = "time", indices = which(!is.na(cal.station.cl3$Data)))

cal.station.cl3$Dates$start <- as.POSIXct(cal.station.cl3$Dates$start,tz = "GMT")
cal.station.cl3$Dates$end <- as.POSIXct(cal.station.cl3$Dates$end,tz = "GMT")

index.cal.station.cl3 <- valueIndex1D(cal.station.cl3$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl3 <- c(index.cal.station.cl3, valueIndex1D(cal.station.cl3$Data[!is.na(cal.station.cl3$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl3.rv20max <- MaxReturnValue(cal.station.cl3)

index.cal.station.cl3 <- c(index.cal.station.cl3, index.cal.station.cl3.rv20max)

index.cal.station.gpqm2.cl3 <- index.cal.station.cl3


```



```{r}
measures <- list()
for (i in c(1:9)) {
  measures[[length(measures)+1]] <- c(abs(index.trmm.cl3[i]-index.obs.cl3[i]),abs(index.era5.cl3[i]-index.obs.cl3[i]),abs(index.cal.station.pqm.cl3[i]-index.obs.cl3[i]), abs(index.cal.station.eqm.cl3[i]-index.obs.cl3[i]), abs(index.cal.station.gpqm.cl3[i]-index.obs.cl3[i]), abs(index.cal.station.gpqm2.cl3[i]-index.obs.cl3[i])) 
}

```

```{r}
norm.vector <- list()
for (i in c(1:length(measures))) {
  norm.vector[[length(norm.vector)+1]] <- normalization(measures[[i]]) 
}
```

```{r}
score.trmm <- c()
for (i in c(1:9)) {
  score.trmm <- c(score.trmm, norm.vector[[i]][1]) 
}
score.trmm <- mean(score.trmm)

score.era5 <- c()
for (i in c(1:9)) {
  score.era5 <- c(score.era5, norm.vector[[i]][2]) 
}
score.era5 <- mean(score.era5)

score.pqm <- c()
for (i in c(1:9)) {
  score.pqm <- c(score.pqm, norm.vector[[i]][3]) 
}
score.pqm <- mean(score.pqm)


score.eqm <- c()
for (i in c(1:9)) {
  score.eqm <- c(score.eqm, norm.vector[[i]][4]) 
}
score.eqm <- mean(score.eqm)


score.gpqm <- c()
for (i in c(1:9)) {
  score.gpqm <- c(score.gpqm, norm.vector[[i]][5]) 
}
score.gpqm <- mean(score.gpqm)

score.gpqm2 <- c()
for (i in c(1:9)) {
  score.gpqm2 <- c(score.gpqm2, norm.vector[[i]][6]) 
}
score.gpqm2 <- mean(score.gpqm2)


scores <- c(score.trmm,score.era5, score.pqm, score.eqm, score.gpqm, score.gpqm2)
names(scores) <- c("TRMM","ERA5","PQM-WT3","EQM-WT3","GPQM-WT3","GPQM2-WT3")
scores <- sort(scores, decreasing = T)
scores
```

```{r}
scores.st5.wt3 <- scores
```

### WT4

```{r}
station.obs.cl4 <- subsetDimension(station.obs, dimension = "time", indices = which(kmModel5$cluster == 4))


station.trmm.cl4 <- subsetDimension(station.trmm, dimension = "time", indices = which(kmModel5$cluster == 4))

station.era5.cl4 <- subsetDimension(station.era5, dimension = "time", indices = which(kmModel5$cluster == 4))
```

```{r}
index.obs.cl4 <- valueIndex1D(station.obs.cl4$Data[!is.na(station.obs.cl4$Data)],index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))
index.obs.cl4 <- c(index.obs.cl4, valueIndex1D(station.obs.cl4$Data[!is.na(station.obs.cl4$Data)], index.codes = "P98WetAmount"))
index.obs.cl4.rv20max <- MaxReturnValue(station.obs.cl4)
index.obs.cl4 <- c(index.obs.cl4, index.obs.cl4.rv20max)

index.trmm.cl4 <- valueIndex1D(station.trmm.cl4$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.trmm.cl4.rv20max <- MaxReturnValue(station.trmm.cl4)
index.trmm.cl4 <- c(index.trmm.cl4, index.trmm.cl4.rv20max)

index.era5.cl4 <- valueIndex1D(station.era5.cl4$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.era5.cl4.rv20max <- MaxReturnValue(station.era5.cl4)
index.era5.cl4 <- c(index.era5.cl4, index.era5.cl4.rv20max)
```

```{r}
cal.station.cl4 <- biasCorrection(y = station.obs.cl4, x = station.trmm.cl4, precipitation = TRUE,  method = "pqm")


cal.station.cl4 <- subsetDimension(cal.station.cl4, dimension = "time", indices = which(!is.na(cal.station.cl4$Data)))

cal.station.cl4$Dates$start <- as.POSIXct(cal.station.cl4$Dates$start,tz = "GMT")
cal.station.cl4$Dates$end <- as.POSIXct(cal.station.cl4$Dates$end,tz = "GMT")

index.cal.station.cl4 <- valueIndex1D(cal.station.cl4$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl4 <- c(index.cal.station.cl4, valueIndex1D(cal.station.cl4$Data[!is.na(cal.station.cl4$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl4.rv20max <- MaxReturnValue(cal.station.cl4)

index.cal.station.cl4 <- c(index.cal.station.cl4, index.cal.station.cl4.rv20max)

index.cal.station.pqm.cl4 <- index.cal.station.cl4


```


```{r}
cal.station.cl4 <- biasCorrection(y = station.obs.cl4, x = station.trmm.cl4, precipitation = TRUE,  method = "eqm")


cal.station.cl4 <- subsetDimension(cal.station.cl4, dimension = "time", indices = which(!is.na(cal.station.cl4$Data)))

cal.station.cl4$Dates$start <- as.POSIXct(cal.station.cl4$Dates$start,tz = "GMT")
cal.station.cl4$Dates$end <- as.POSIXct(cal.station.cl4$Dates$end,tz = "GMT")

index.cal.station.cl4 <- valueIndex1D(cal.station.cl4$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl4 <- c(index.cal.station.cl4, valueIndex1D(cal.station.cl4$Data[!is.na(cal.station.cl4$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl4.rv20max <- MaxReturnValue(cal.station.cl4)

index.cal.station.cl4 <- c(index.cal.station.cl4, index.cal.station.cl4.rv20max)

index.cal.station.eqm.cl4 <- index.cal.station.cl4


```

```{r}
cal.station.cl4 <- biasCorrection(y = station.obs.cl4, x = station.trmm.cl4, precipitation = TRUE,  method = "gpqm")


cal.station.cl4 <- subsetDimension(cal.station.cl4, dimension = "time", indices = which(!is.na(cal.station.cl4$Data)))

cal.station.cl4$Dates$start <- as.POSIXct(cal.station.cl4$Dates$start,tz = "GMT")
cal.station.cl4$Dates$end <- as.POSIXct(cal.station.cl4$Dates$end,tz = "GMT")

index.cal.station.cl4 <- valueIndex1D(cal.station.cl4$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl4 <- c(index.cal.station.cl4, valueIndex1D(cal.station.cl4$Data[!is.na(cal.station.cl4$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl4.rv20max <- MaxReturnValue(cal.station.cl4)

index.cal.station.cl4 <- c(index.cal.station.cl4, index.cal.station.cl4.rv20max)

index.cal.station.gpqm.cl4 <- index.cal.station.cl4


```


```{r}
cal.station.cl4 <- biasCorrection(y = station.obs.cl4, x = station.trmm.cl4, precipitation = TRUE,  method = "gpqm" , theta = .7)


cal.station.cl4 <- subsetDimension(cal.station.cl4, dimension = "time", indices = which(!is.na(cal.station.cl4$Data)))

cal.station.cl4$Dates$start <- as.POSIXct(cal.station.cl4$Dates$start,tz = "GMT")
cal.station.cl4$Dates$end <- as.POSIXct(cal.station.cl4$Dates$end,tz = "GMT")

index.cal.station.cl4 <- valueIndex1D(cal.station.cl4$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl4 <- c(index.cal.station.cl4, valueIndex1D(cal.station.cl4$Data[!is.na(cal.station.cl4$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl4.rv20max <- MaxReturnValue(cal.station.cl4)

index.cal.station.cl4 <- c(index.cal.station.cl4, index.cal.station.cl4.rv20max)

index.cal.station.gpqm2.cl4 <- index.cal.station.cl4


```



```{r}
measures <- list()
for (i in c(1:9)) {
  measures[[length(measures)+1]] <- c(abs(index.trmm.cl4[i]-index.obs.cl4[i]),abs(index.era5.cl4[i]-index.obs.cl4[i]),abs(index.cal.station.pqm.cl4[i]-index.obs.cl4[i]), abs(index.cal.station.eqm.cl4[i]-index.obs.cl4[i]), abs(index.cal.station.gpqm.cl4[i]-index.obs.cl4[i]), abs(index.cal.station.gpqm2.cl4[i]-index.obs.cl4[i])) 
}

```

```{r}
norm.vector <- list()
for (i in c(1:length(measures))) {
  norm.vector[[length(norm.vector)+1]] <- normalization(measures[[i]]) 
}
```

```{r}
score.trmm <- c()
for (i in c(1:9)) {
  score.trmm <- c(score.trmm, norm.vector[[i]][1]) 
}
score.trmm <- mean(score.trmm)

score.era5 <- c()
for (i in c(1:9)) {
  score.era5 <- c(score.era5, norm.vector[[i]][2]) 
}
score.era5 <- mean(score.era5)

score.pqm <- c()
for (i in c(1:9)) {
  score.pqm <- c(score.pqm, norm.vector[[i]][3]) 
}
score.pqm <- mean(score.pqm)


score.eqm <- c()
for (i in c(1:9)) {
  score.eqm <- c(score.eqm, norm.vector[[i]][4]) 
}
score.eqm <- mean(score.eqm)


score.gpqm <- c()
for (i in c(1:9)) {
  score.gpqm <- c(score.gpqm, norm.vector[[i]][5]) 
}
score.gpqm <- mean(score.gpqm)

score.gpqm.cl5 <- c()


score.gpqm2 <- c()
for (i in c(1:9)) {
  score.gpqm2 <- c(score.gpqm2, norm.vector[[i]][6]) 
}
score.gpqm2 <- mean(score.gpqm2)



scores <- c(score.trmm,score.era5, score.pqm, score.eqm, score.gpqm, score.gpqm2)
names(scores) <- c("TRMM","ERA5","PQM-WT4","EQM-WT4","GPQM-WT4","GPQM2-WT4")
scores <- sort(scores, decreasing = T)
scores
```
```{r}
scores.st5.wt4 <- scores
```
### WT5

```{r}
station.obs.cl5 <- subsetDimension(station.obs, dimension = "time", indices = which(kmModel5$cluster == 5))


station.trmm.cl5 <- subsetDimension(station.trmm, dimension = "time", indices = which(kmModel5$cluster == 5))

station.era5.cl5 <- subsetDimension(station.era5, dimension = "time", indices = which(kmModel5$cluster == 5))
```

```{r}
index.obs.cl5 <- valueIndex1D(station.obs.cl5$Data[!is.na(station.obs.cl5$Data)],index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))
index.obs.cl5 <- c(index.obs.cl5, valueIndex1D(station.obs.cl5$Data[!is.na(station.obs.cl5$Data)], index.codes = "P98WetAmount"))
index.obs.cl5.rv20max <- MaxReturnValue(station.obs.cl5)
index.obs.cl5 <- c(index.obs.cl5, index.obs.cl5.rv20max)

index.trmm.cl5 <- valueIndex1D(station.trmm.cl5$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.trmm.cl5.rv20max <- MaxReturnValue(station.trmm.cl5)
index.trmm.cl5 <- c(index.trmm.cl5, index.trmm.cl5.rv20max)

index.era5.cl5 <- valueIndex1D(station.era5.cl5$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.era5.cl5.rv20max <- MaxReturnValue(station.era5.cl5)
index.era5.cl5 <- c(index.era5.cl5, index.era5.cl5.rv20max)
```

```{r}
cal.station.cl5 <- biasCorrection(y = station.obs.cl5, x = station.trmm.cl5, precipitation = TRUE,  method = "pqm")


cal.station.cl5 <- subsetDimension(cal.station.cl5, dimension = "time", indices = which(!is.na(cal.station.cl5$Data)))

cal.station.cl5$Dates$start <- as.POSIXct(cal.station.cl5$Dates$start,tz = "GMT")
cal.station.cl5$Dates$end <- as.POSIXct(cal.station.cl5$Dates$end,tz = "GMT")

index.cal.station.cl5 <- valueIndex1D(cal.station.cl5$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl5 <- c(index.cal.station.cl5, valueIndex1D(cal.station.cl5$Data[!is.na(cal.station.cl5$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl5.rv20max <- MaxReturnValue(cal.station.cl5)

index.cal.station.cl5 <- c(index.cal.station.cl5, index.cal.station.cl5.rv20max)

index.cal.station.pqm.cl5 <- index.cal.station.cl5


```


```{r}
cal.station.cl5 <- biasCorrection(y = station.obs.cl5, x = station.trmm.cl5, precipitation = TRUE,  method = "eqm")


cal.station.cl5 <- subsetDimension(cal.station.cl5, dimension = "time", indices = which(!is.na(cal.station.cl5$Data)))

cal.station.cl5$Dates$start <- as.POSIXct(cal.station.cl5$Dates$start,tz = "GMT")
cal.station.cl5$Dates$end <- as.POSIXct(cal.station.cl5$Dates$end,tz = "GMT")

index.cal.station.cl5 <- valueIndex1D(cal.station.cl5$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl5 <- c(index.cal.station.cl5, valueIndex1D(cal.station.cl5$Data[!is.na(cal.station.cl5$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl5.rv20max <- MaxReturnValue(cal.station.cl5)

index.cal.station.cl5 <- c(index.cal.station.cl5, index.cal.station.cl5.rv20max)

index.cal.station.eqm.cl5 <- index.cal.station.cl5


```

```{r}
cal.station.cl5 <- biasCorrection(y = station.obs.cl5, x = station.trmm.cl5, precipitation = TRUE,  method = "gpqm")


cal.station.cl5 <- subsetDimension(cal.station.cl5, dimension = "time", indices = which(!is.na(cal.station.cl5$Data)))

cal.station.cl5$Dates$start <- as.POSIXct(cal.station.cl5$Dates$start,tz = "GMT")
cal.station.cl5$Dates$end <- as.POSIXct(cal.station.cl5$Dates$end,tz = "GMT")

index.cal.station.cl5 <- valueIndex1D(cal.station.cl5$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl5 <- c(index.cal.station.cl5, valueIndex1D(cal.station.cl5$Data[!is.na(cal.station.cl5$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl5.rv20max <- MaxReturnValue(cal.station.cl5)

index.cal.station.cl5 <- c(index.cal.station.cl5, index.cal.station.cl5.rv20max)

index.cal.station.gpqm.cl5 <- index.cal.station.cl5


```


```{r}
cal.station.cl5 <- biasCorrection(y = station.obs.cl5, x = station.trmm.cl5, precipitation = TRUE,  method = "gpqm" , theta = .7)


cal.station.cl5 <- subsetDimension(cal.station.cl5, dimension = "time", indices = which(!is.na(cal.station.cl5$Data)))

cal.station.cl5$Dates$start <- as.POSIXct(cal.station.cl5$Dates$start,tz = "GMT")
cal.station.cl5$Dates$end <- as.POSIXct(cal.station.cl5$Dates$end,tz = "GMT")

index.cal.station.cl5 <- valueIndex1D(cal.station.cl5$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl5 <- c(index.cal.station.cl5, valueIndex1D(cal.station.cl5$Data[!is.na(cal.station.cl5$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl5.rv20max <- MaxReturnValue(cal.station.cl5)

index.cal.station.cl5 <- c(index.cal.station.cl5, index.cal.station.cl5.rv20max)

index.cal.station.gpqm2.cl5 <- index.cal.station.cl5


```



```{r}
measures <- list()
for (i in c(1:9)) {
  measures[[length(measures)+1]] <- c(abs(index.trmm.cl5[i]-index.obs.cl5[i]),abs(index.era5.cl5[i]-index.obs.cl5[i]),abs(index.cal.station.pqm.cl5[i]-index.obs.cl5[i]), abs(index.cal.station.eqm.cl5[i]-index.obs.cl5[i]), abs(index.cal.station.gpqm.cl5[i]-index.obs.cl5[i]), abs(index.cal.station.gpqm2.cl5[i]-index.obs.cl5[i])) 
}

```

```{r}
norm.vector <- list()
for (i in c(1:length(measures))) {
  norm.vector[[length(norm.vector)+1]] <- normalization(measures[[i]]) 
}
```

```{r}
score.trmm <- c()
for (i in c(1:9)) {
  score.trmm <- c(score.trmm, norm.vector[[i]][1]) 
}
score.trmm <- mean(score.trmm)

score.era5 <- c()
for (i in c(1:9)) {
  score.era5 <- c(score.era5, norm.vector[[i]][1]) 
}
score.era5 <- mean(score.era5)

score.pqm <- c()
for (i in c(1:9)) {
  score.pqm <- c(score.pqm, norm.vector[[i]][2]) 
}
score.pqm <- mean(score.pqm)


score.eqm <- c()
for (i in c(1:9)) {
  score.eqm <- c(score.eqm, norm.vector[[i]][3]) 
}
score.eqm <- mean(score.eqm)


score.gpqm <- c()
for (i in c(1:9)) {
  score.gpqm <- c(score.gpqm, norm.vector[[i]][4]) 
}
score.gpqm <- mean(score.gpqm)



score.gpqm2 <- c()
for (i in c(1:9)) {
  score.gpqm2 <- c(score.gpqm2, norm.vector[[i]][5]) 
}
score.gpqm2 <- mean(score.gpqm2)


scores <- c(score.trmm, score.era5, score.pqm, score.eqm, score.gpqm, score.gpqm2)
names(scores) <- c("TRMM","ERA5","PQM-WT5","EQM-WT5","GPQM-WT5","GPQM2-WT5")
scores <- sort(scores, decreasing = T)
scores
```

```{r}
scores.st5.wt5 <- scores
```

## Aoloau, American Samoa


```{r}
i=6

station.trmm <- subsetGrid(precip_trmm, station.id = precip_trmm$Metadata$station_id[i])
station.obs <- subsetGrid(precip_obs, station.id = precip_trmm$Metadata$station_id[i])

idx <- which.min(abs(pp_reanalysis$xyCoords$x - station.obs$xyCoords$x))
lon <- pp_reanalysis$xyCoords$x[idx]
  
idx2 <- which.min(abs(pp_reanalysis$xyCoords$y - station.obs$xyCoords$y))
lat <- pp_reanalysis$xyCoords$y[idx2]
  
station.era5 <- subsetGrid(pp_reanalysis, lonLim = lon, latLim = lat)
```


````{r}
index.obs <- valueIndex1D(station.obs$Data[!is.na(station.obs$Data)],index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))
index.obs <- c(index.obs, valueIndex1D(station.obs$Data[!is.na(station.obs$Data)], index.codes = "P98WetAmount"))
index.obs.rv20max <- MaxReturnValue(station.obs)
index.obs <- c(index.obs, index.obs.rv20max)

index.trmm <- valueIndex1D(station.trmm$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.trmm.rv20max <- MaxReturnValue(station.trmm)
index.trmm <- c(index.trmm, index.trmm.rv20max)

index.era5 <- valueIndex1D(station.era5$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.era5.rv20max <- MaxReturnValue(station.era5)
index.era5 <- c(index.era5, index.era5.rv20max)

```



### WT1

```{r}
station.obs.cl1 <- subsetDimension(station.obs, dimension = "time", indices = which(kmModel5$cluster == 1))


station.trmm.cl1 <- subsetDimension(station.trmm, dimension = "time", indices = which(kmModel5$cluster == 1))

station.era5.cl1 <- subsetDimension(station.era5, dimension = "time", indices = which(kmModel5$cluster == 1))
```

```{r}
index.obs.cl1 <- valueIndex1D(station.obs.cl1$Data[!is.na(station.obs.cl1$Data)],index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))
index.obs.cl1 <- c(index.obs.cl1, valueIndex1D(station.obs.cl1$Data[!is.na(station.obs.cl1$Data)], index.codes = "P98WetAmount"))
index.obs.cl1.rv20max <- MaxReturnValue(station.obs.cl1)
index.obs.cl1 <- c(index.obs.cl1, index.obs.cl1.rv20max)

index.trmm.cl1 <- valueIndex1D(station.trmm.cl1$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.trmm.cl1.rv20max <- MaxReturnValue(station.trmm.cl1)
index.trmm.cl1 <- c(index.trmm.cl1, index.trmm.cl1.rv20max)

index.era5.cl1 <- valueIndex1D(station.era5.cl1$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.era5.cl1.rv20max <- MaxReturnValue(station.era5.cl1)
index.era5.cl1 <- c(index.era5.cl1, index.era5.cl1.rv20max)
```

```{r}
cal.station.cl1 <- biasCorrection(y = station.obs.cl1, x = station.trmm.cl1, precipitation = TRUE,  method = "pqm")


cal.station.cl1 <- subsetDimension(cal.station.cl1, dimension = "time", indices = which(!is.na(cal.station.cl1$Data)))

cal.station.cl1$Dates$start <- as.POSIXct(cal.station.cl1$Dates$start,tz = "GMT")
cal.station.cl1$Dates$end <- as.POSIXct(cal.station.cl1$Dates$end,tz = "GMT")

index.cal.station.cl1 <- valueIndex1D(cal.station.cl1$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl1 <- c(index.cal.station.cl1, valueIndex1D(cal.station.cl1$Data[!is.na(cal.station.cl1$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl1.rv20max <- MaxReturnValue(cal.station.cl1)

index.cal.station.cl1 <- c(index.cal.station.cl1, index.cal.station.cl1.rv20max)

index.cal.station.pqm.cl1 <- index.cal.station.cl1


```


```{r}
cal.station.cl1 <- biasCorrection(y = station.obs.cl1, x = station.trmm.cl1, precipitation = TRUE,  method = "eqm")


cal.station.cl1 <- subsetDimension(cal.station.cl1, dimension = "time", indices = which(!is.na(cal.station.cl1$Data)))

cal.station.cl1$Dates$start <- as.POSIXct(cal.station.cl1$Dates$start,tz = "GMT")
cal.station.cl1$Dates$end <- as.POSIXct(cal.station.cl1$Dates$end,tz = "GMT")

index.cal.station.cl1 <- valueIndex1D(cal.station.cl1$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl1 <- c(index.cal.station.cl1, valueIndex1D(cal.station.cl1$Data[!is.na(cal.station.cl1$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl1.rv20max <- MaxReturnValue(cal.station.cl1)

index.cal.station.cl1 <- c(index.cal.station.cl1, index.cal.station.cl1.rv20max)

index.cal.station.eqm.cl1 <- index.cal.station.cl1


```

```{r}
cal.station.cl1 <- biasCorrection(y = station.obs.cl1, x = station.trmm.cl1, precipitation = TRUE,  method = "gpqm")


cal.station.cl1 <- subsetDimension(cal.station.cl1, dimension = "time", indices = which(!is.na(cal.station.cl1$Data)))

cal.station.cl1$Dates$start <- as.POSIXct(cal.station.cl1$Dates$start,tz = "GMT")
cal.station.cl1$Dates$end <- as.POSIXct(cal.station.cl1$Dates$end,tz = "GMT")

index.cal.station.cl1 <- valueIndex1D(cal.station.cl1$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl1 <- c(index.cal.station.cl1, valueIndex1D(cal.station.cl1$Data[!is.na(cal.station.cl1$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl1.rv20max <- MaxReturnValue(cal.station.cl1)

index.cal.station.cl1 <- c(index.cal.station.cl1, index.cal.station.cl1.rv20max)

index.cal.station.gpqm.cl1 <- index.cal.station.cl1


```


```{r}
cal.station.cl1 <- biasCorrection(y = station.obs.cl1, x = station.trmm.cl1, precipitation = TRUE,  method = "gpqm" , theta = .7)


cal.station.cl1 <- subsetDimension(cal.station.cl1, dimension = "time", indices = which(!is.na(cal.station.cl1$Data)))

cal.station.cl1$Dates$start <- as.POSIXct(cal.station.cl1$Dates$start,tz = "GMT")
cal.station.cl1$Dates$end <- as.POSIXct(cal.station.cl1$Dates$end,tz = "GMT")

index.cal.station.cl1 <- valueIndex1D(cal.station.cl1$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl1 <- c(index.cal.station.cl1, valueIndex1D(cal.station.cl1$Data[!is.na(cal.station.cl1$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl1.rv20max <- MaxReturnValue(cal.station.cl1)

index.cal.station.cl1 <- c(index.cal.station.cl1, index.cal.station.cl1.rv20max)

index.cal.station.gpqm2.cl1 <- index.cal.station.cl1


```



```{r}
measures <- list()
for (i in c(1:9)) {
  measures[[length(measures)+1]] <- c(abs(index.trmm.cl1[i]-index.obs.cl1[i]),abs(index.era5.cl1[i]-index.obs.cl1[i]),abs(index.cal.station.pqm.cl1[i]-index.obs.cl1[i]), abs(index.cal.station.eqm.cl1[i]-index.obs.cl1[i]), abs(index.cal.station.gpqm.cl1[i]-index.obs.cl1[i]), abs(index.cal.station.gpqm2.cl1[i]-index.obs.cl1[i])) 
}

```

```{r}
normalization <- function(measure){
  measure.norm <- c()
  #measure must be a vector with the value of a certain measure of different calibrations
  for (i in c(1:length(measure))) {
    measure.norm <- c(measure.norm, 1-((measure[i]-min(measure))/(max(measure)-min(measure))))
  }
  return(measure.norm)
}
```

```{r}
norm.vector <- list()
for (i in c(1:length(measures))) {
  norm.vector[[length(norm.vector)+1]] <- normalization(measures[[i]]) 
}
```

```{r}
score.trmm <- c()
for (i in c(1:9)) {
  score.trmm <- c(score.trmm, norm.vector[[i]][1]) 
}
score.trmm <- mean(score.trmm)

score.era5 <- c()
for (i in c(1:9)) {
  score.era5 <- c(score.era5, norm.vector[[i]][2]) 
}
score.era5 <- mean(score.era5)

score.pqm <- c()
for (i in c(1:9)) {
  score.pqm <- c(score.pqm, norm.vector[[i]][3]) 
}
score.pqm <- mean(score.pqm)


score.eqm <- c()
for (i in c(1:9)) {
  score.eqm <- c(score.eqm, norm.vector[[i]][4]) 
}
score.eqm <- mean(score.eqm)


score.gpqm <- c()
for (i in c(1:9)) {
  score.gpqm <- c(score.gpqm, norm.vector[[i]][5]) 
}
score.gpqm <- mean(score.gpqm)


score.gpqm2 <- c()
for (i in c(1:9)) {
  score.gpqm2 <- c(score.gpqm2, norm.vector[[i]][6]) 
}
score.gpqm2 <- mean(score.gpqm2)




scores <- c(score.trmm,score.era5, score.pqm, score.eqm, score.gpqm, score.gpqm2)
names(scores) <- c("TRMM","ERA5","PQM-WT1","EQM-WT1","GPQM-WT1","GPQM2-WT1")
scores <- sort(scores, decreasing = T)
scores
```
```{r}
scores.st6.wt1 <- scores
```
### WT2
```{r}
station.obs.cl2 <- subsetDimension(station.obs, dimension = "time", indices = which(kmModel5$cluster == 2))


station.trmm.cl2 <- subsetDimension(station.trmm, dimension = "time", indices = which(kmModel5$cluster == 2))

station.era5.cl2 <- subsetDimension(station.era5, dimension = "time", indices = which(kmModel5$cluster == 2))
```

```{r}
index.obs.cl2 <- valueIndex1D(station.obs.cl2$Data[!is.na(station.obs.cl2$Data)],index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))
index.obs.cl2 <- c(index.obs.cl2, valueIndex1D(station.obs.cl2$Data[!is.na(station.obs.cl2$Data)], index.codes = "P98WetAmount"))
index.obs.cl2.rv20max <- MaxReturnValue(station.obs.cl2)
index.obs.cl2 <- c(index.obs.cl2, index.obs.cl2.rv20max)

index.trmm.cl2 <- valueIndex1D(station.trmm.cl2$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.trmm.cl2.rv20max <- MaxReturnValue(station.trmm.cl2)
index.trmm.cl2 <- c(index.trmm.cl2, index.trmm.cl2.rv20max)

index.era5.cl2 <- valueIndex1D(station.era5.cl2$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.era5.cl2.rv20max <- MaxReturnValue(station.era5.cl2)
index.era5.cl2 <- c(index.era5.cl2, index.era5.cl2.rv20max)
```

```{r}
cal.station.cl2 <- biasCorrection(y = station.obs.cl2, x = station.trmm.cl2, precipitation = TRUE,  method = "pqm")


cal.station.cl2 <- subsetDimension(cal.station.cl2, dimension = "time", indices = which(!is.na(cal.station.cl2$Data)))

cal.station.cl2$Dates$start <- as.POSIXct(cal.station.cl2$Dates$start,tz = "GMT")
cal.station.cl2$Dates$end <- as.POSIXct(cal.station.cl2$Dates$end,tz = "GMT")

index.cal.station.cl2 <- valueIndex1D(cal.station.cl2$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl2 <- c(index.cal.station.cl2, valueIndex1D(cal.station.cl2$Data[!is.na(cal.station.cl2$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl2.rv20max <- MaxReturnValue(cal.station.cl2)

index.cal.station.cl2 <- c(index.cal.station.cl2, index.cal.station.cl2.rv20max)

index.cal.station.pqm.cl2 <- index.cal.station.cl2


```


```{r}
cal.station.cl2 <- biasCorrection(y = station.obs.cl2, x = station.trmm.cl2, precipitation = TRUE,  method = "eqm")


cal.station.cl2 <- subsetDimension(cal.station.cl2, dimension = "time", indices = which(!is.na(cal.station.cl2$Data)))

cal.station.cl2$Dates$start <- as.POSIXct(cal.station.cl2$Dates$start,tz = "GMT")
cal.station.cl2$Dates$end <- as.POSIXct(cal.station.cl2$Dates$end,tz = "GMT")

index.cal.station.cl2 <- valueIndex1D(cal.station.cl2$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl2 <- c(index.cal.station.cl2, valueIndex1D(cal.station.cl2$Data[!is.na(cal.station.cl2$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl2.rv20max <- MaxReturnValue(cal.station.cl2)

index.cal.station.cl2 <- c(index.cal.station.cl2, index.cal.station.cl2.rv20max)

index.cal.station.eqm.cl2 <- index.cal.station.cl2


```

```{r}
cal.station.cl2 <- biasCorrection(y = station.obs.cl2, x = station.trmm.cl2, precipitation = TRUE,  method = "gpqm")


cal.station.cl2 <- subsetDimension(cal.station.cl2, dimension = "time", indices = which(!is.na(cal.station.cl2$Data)))

cal.station.cl2$Dates$start <- as.POSIXct(cal.station.cl2$Dates$start,tz = "GMT")
cal.station.cl2$Dates$end <- as.POSIXct(cal.station.cl2$Dates$end,tz = "GMT")

index.cal.station.cl2 <- valueIndex1D(cal.station.cl2$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl2 <- c(index.cal.station.cl2, valueIndex1D(cal.station.cl2$Data[!is.na(cal.station.cl2$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl2.rv20max <- MaxReturnValue(cal.station.cl2)

index.cal.station.cl2 <- c(index.cal.station.cl2, index.cal.station.cl2.rv20max)

index.cal.station.gpqm.cl2 <- index.cal.station.cl2


```


```{r}
cal.station.cl2 <- biasCorrection(y = station.obs.cl2, x = station.trmm.cl2, precipitation = TRUE,  method = "gpqm" , theta = .7)


cal.station.cl2 <- subsetDimension(cal.station.cl2, dimension = "time", indices = which(!is.na(cal.station.cl2$Data)))

cal.station.cl2$Dates$start <- as.POSIXct(cal.station.cl2$Dates$start,tz = "GMT")
cal.station.cl2$Dates$end <- as.POSIXct(cal.station.cl2$Dates$end,tz = "GMT")

index.cal.station.cl2 <- valueIndex1D(cal.station.cl2$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl2 <- c(index.cal.station.cl2, valueIndex1D(cal.station.cl2$Data[!is.na(cal.station.cl2$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl2.rv20max <- MaxReturnValue(cal.station.cl2)

index.cal.station.cl2 <- c(index.cal.station.cl2, index.cal.station.cl2.rv20max)

index.cal.station.gpqm2.cl2 <- index.cal.station.cl2


```



```{r}
measures <- list()
for (i in c(1:9)) {
  measures[[length(measures)+1]] <- c(abs(index.trmm.cl2[i]-index.obs.cl2[i]),abs(index.era5.cl2[i]-index.obs.cl2[i]),abs(index.cal.station.pqm.cl2[i]-index.obs.cl2[i]), abs(index.cal.station.eqm.cl2[i]-index.obs.cl2[i]), abs(index.cal.station.gpqm.cl2[i]-index.obs.cl2[i]), abs(index.cal.station.gpqm2.cl2[i]-index.obs.cl2[i])) 
}

```

```{r}
norm.vector <- list()
for (i in c(1:length(measures))) {
  norm.vector[[length(norm.vector)+1]] <- normalization(measures[[i]]) 
}
```

```{r}
score.trmm <- c()
for (i in c(1:9)) {
  score.trmm <- c(score.trmm, norm.vector[[i]][1]) 
}
score.trmm <- mean(score.trmm)

score.era5 <- c()
for (i in c(1:9)) {
  score.era5 <- c(score.era5, norm.vector[[i]][2]) 
}
score.era5 <- mean(score.era5)

score.pqm <- c()
for (i in c(1:9)) {
  score.pqm <- c(score.pqm, norm.vector[[i]][3]) 
}
score.pqm <- mean(score.pqm)


score.eqm <- c()
for (i in c(1:9)) {
  score.eqm <- c(score.eqm, norm.vector[[i]][4]) 
}
score.eqm <- mean(score.eqm)


score.gpqm <- c()
for (i in c(1:9)) {
  score.gpqm <- c(score.gpqm, norm.vector[[i]][5]) 
}
score.gpqm <- mean(score.gpqm)

score.gpqm2 <- c()
for (i in c(1:9)) {
  score.gpqm2 <- c(score.gpqm2, norm.vector[[i]][6]) 
}
score.gpqm2 <- mean(score.gpqm2)

scores <- c(score.trmm, score.era5, score.pqm, score.eqm, score.gpqm, score.gpqm2)
names(scores) <- c("TRMM","ERA5","PQM-WT1","EQM-WT1","GPQM-WT1","GPQM2-WT1")
scores <- sort(scores, decreasing = T)
scores
```
```{r}
scores.st6.wt2 <- scores
```
### WT3

```{r}
station.obs.cl3 <- subsetDimension(station.obs, dimension = "time", indices = which(kmModel5$cluster == 3))


station.trmm.cl3 <- subsetDimension(station.trmm, dimension = "time", indices = which(kmModel5$cluster == 3))

station.era5.cl3 <- subsetDimension(station.era5, dimension = "time", indices = which(kmModel5$cluster == 3))
```

```{r}
index.obs.cl3 <- valueIndex1D(station.obs.cl3$Data[!is.na(station.obs.cl3$Data)],index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))
index.obs.cl3 <- c(index.obs.cl3, valueIndex1D(station.obs.cl3$Data[!is.na(station.obs.cl3$Data)], index.codes = "P98WetAmount"))
index.obs.cl3.rv20max <- MaxReturnValue(station.obs.cl3)
index.obs.cl3 <- c(index.obs.cl3, index.obs.cl3.rv20max)

index.trmm.cl3 <- valueIndex1D(station.trmm.cl3$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.trmm.cl3.rv20max <- MaxReturnValue(station.trmm.cl3)
index.trmm.cl3 <- c(index.trmm.cl3, index.trmm.cl3.rv20max)

index.era5.cl3 <- valueIndex1D(station.era5.cl3$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.era5.cl3.rv20max <- MaxReturnValue(station.era5.cl3)
index.era5.cl3 <- c(index.era5.cl3, index.era5.cl3.rv20max)
```

```{r}
cal.station.cl3 <- biasCorrection(y = station.obs.cl3, x = station.trmm.cl3, precipitation = TRUE,  method = "pqm")


cal.station.cl3 <- subsetDimension(cal.station.cl3, dimension = "time", indices = which(!is.na(cal.station.cl3$Data)))

cal.station.cl3$Dates$start <- as.POSIXct(cal.station.cl3$Dates$start,tz = "GMT")
cal.station.cl3$Dates$end <- as.POSIXct(cal.station.cl3$Dates$end,tz = "GMT")

index.cal.station.cl3 <- valueIndex1D(cal.station.cl3$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl3 <- c(index.cal.station.cl3, valueIndex1D(cal.station.cl3$Data[!is.na(cal.station.cl3$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl3.rv20max <- MaxReturnValue(cal.station.cl3)

index.cal.station.cl3 <- c(index.cal.station.cl3, index.cal.station.cl3.rv20max)

index.cal.station.pqm.cl3 <- index.cal.station.cl3


```


```{r}
cal.station.cl3 <- biasCorrection(y = station.obs.cl3, x = station.trmm.cl3, precipitation = TRUE,  method = "eqm")


cal.station.cl3 <- subsetDimension(cal.station.cl3, dimension = "time", indices = which(!is.na(cal.station.cl3$Data)))

cal.station.cl3$Dates$start <- as.POSIXct(cal.station.cl3$Dates$start,tz = "GMT")
cal.station.cl3$Dates$end <- as.POSIXct(cal.station.cl3$Dates$end,tz = "GMT")

index.cal.station.cl3 <- valueIndex1D(cal.station.cl3$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl3 <- c(index.cal.station.cl3, valueIndex1D(cal.station.cl3$Data[!is.na(cal.station.cl3$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl3.rv20max <- MaxReturnValue(cal.station.cl3)

index.cal.station.cl3 <- c(index.cal.station.cl3, index.cal.station.cl3.rv20max)

index.cal.station.eqm.cl3 <- index.cal.station.cl3


```

```{r}
cal.station.cl3 <- biasCorrection(y = station.obs.cl3, x = station.trmm.cl3, precipitation = TRUE,  method = "gpqm")


cal.station.cl3 <- subsetDimension(cal.station.cl3, dimension = "time", indices = which(!is.na(cal.station.cl3$Data)))

cal.station.cl3$Dates$start <- as.POSIXct(cal.station.cl3$Dates$start,tz = "GMT")
cal.station.cl3$Dates$end <- as.POSIXct(cal.station.cl3$Dates$end,tz = "GMT")

index.cal.station.cl3 <- valueIndex1D(cal.station.cl3$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl3 <- c(index.cal.station.cl3, valueIndex1D(cal.station.cl3$Data[!is.na(cal.station.cl3$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl3.rv20max <- MaxReturnValue(cal.station.cl3)

index.cal.station.cl3 <- c(index.cal.station.cl3, index.cal.station.cl3.rv20max)

index.cal.station.gpqm.cl3 <- index.cal.station.cl3


```


```{r}
cal.station.cl3 <- biasCorrection(y = station.obs.cl3, x = station.trmm.cl3, precipitation = TRUE,  method = "gpqm" , theta = .7)


cal.station.cl3 <- subsetDimension(cal.station.cl3, dimension = "time", indices = which(!is.na(cal.station.cl3$Data)))

cal.station.cl3$Dates$start <- as.POSIXct(cal.station.cl3$Dates$start,tz = "GMT")
cal.station.cl3$Dates$end <- as.POSIXct(cal.station.cl3$Dates$end,tz = "GMT")

index.cal.station.cl3 <- valueIndex1D(cal.station.cl3$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl3 <- c(index.cal.station.cl3, valueIndex1D(cal.station.cl3$Data[!is.na(cal.station.cl3$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl3.rv20max <- MaxReturnValue(cal.station.cl3)

index.cal.station.cl3 <- c(index.cal.station.cl3, index.cal.station.cl3.rv20max)

index.cal.station.gpqm2.cl3 <- index.cal.station.cl3


```



```{r}
measures <- list()
for (i in c(1:9)) {
  measures[[length(measures)+1]] <- c(abs(index.trmm.cl3[i]-index.obs.cl3[i]),abs(index.era5.cl3[i]-index.obs.cl3[i]),abs(index.cal.station.pqm.cl3[i]-index.obs.cl3[i]), abs(index.cal.station.eqm.cl3[i]-index.obs.cl3[i]), abs(index.cal.station.gpqm.cl3[i]-index.obs.cl3[i]), abs(index.cal.station.gpqm2.cl3[i]-index.obs.cl3[i])) 
}

```

```{r}
norm.vector <- list()
for (i in c(1:length(measures))) {
  norm.vector[[length(norm.vector)+1]] <- normalization(measures[[i]]) 
}
```

```{r}
score.trmm <- c()
for (i in c(1:9)) {
  score.trmm <- c(score.trmm, norm.vector[[i]][1]) 
}
score.trmm <- mean(score.trmm)

score.era5 <- c()
for (i in c(1:9)) {
  score.era5 <- c(score.era5, norm.vector[[i]][2]) 
}
score.era5 <- mean(score.era5)

score.pqm <- c()
for (i in c(1:9)) {
  score.pqm <- c(score.pqm, norm.vector[[i]][3]) 
}
score.pqm <- mean(score.pqm)


score.eqm <- c()
for (i in c(1:9)) {
  score.eqm <- c(score.eqm, norm.vector[[i]][4]) 
}
score.eqm <- mean(score.eqm)


score.gpqm <- c()
for (i in c(1:9)) {
  score.gpqm <- c(score.gpqm, norm.vector[[i]][5]) 
}
score.gpqm <- mean(score.gpqm)

score.gpqm2 <- c()
for (i in c(1:9)) {
  score.gpqm2 <- c(score.gpqm2, norm.vector[[i]][6]) 
}
score.gpqm2 <- mean(score.gpqm2)


scores <- c(score.trmm,score.era5, score.pqm, score.eqm, score.gpqm, score.gpqm2)
names(scores) <- c("TRMM","ERA5","PQM-WT3","EQM-WT3","GPQM-WT3","GPQM2-WT3")
scores <- sort(scores, decreasing = T)
scores
```
```{r}
scores.st6.wt3 <- scores
```
### WT4

```{r}
station.obs.cl4 <- subsetDimension(station.obs, dimension = "time", indices = which(kmModel5$cluster == 4))


station.trmm.cl4 <- subsetDimension(station.trmm, dimension = "time", indices = which(kmModel5$cluster == 4))

station.era5.cl4 <- subsetDimension(station.era5, dimension = "time", indices = which(kmModel5$cluster == 4))
```

```{r}
index.obs.cl4 <- valueIndex1D(station.obs.cl4$Data[!is.na(station.obs.cl4$Data)],index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))
index.obs.cl4 <- c(index.obs.cl4, valueIndex1D(station.obs.cl4$Data[!is.na(station.obs.cl4$Data)], index.codes = "P98WetAmount"))
index.obs.cl4.rv20max <- MaxReturnValue(station.obs.cl4)
index.obs.cl4 <- c(index.obs.cl4, index.obs.cl4.rv20max)

index.trmm.cl4 <- valueIndex1D(station.trmm.cl4$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.trmm.cl4.rv20max <- MaxReturnValue(station.trmm.cl4)
index.trmm.cl4 <- c(index.trmm.cl4, index.trmm.cl4.rv20max)

index.era5.cl4 <- valueIndex1D(station.era5.cl4$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.era5.cl4.rv20max <- MaxReturnValue(station.era5.cl4)
index.era5.cl4 <- c(index.era5.cl4, index.era5.cl4.rv20max)
```

```{r}
cal.station.cl4 <- biasCorrection(y = station.obs.cl4, x = station.trmm.cl4, precipitation = TRUE,  method = "pqm")


cal.station.cl4 <- subsetDimension(cal.station.cl4, dimension = "time", indices = which(!is.na(cal.station.cl4$Data)))

cal.station.cl4$Dates$start <- as.POSIXct(cal.station.cl4$Dates$start,tz = "GMT")
cal.station.cl4$Dates$end <- as.POSIXct(cal.station.cl4$Dates$end,tz = "GMT")

index.cal.station.cl4 <- valueIndex1D(cal.station.cl4$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl4 <- c(index.cal.station.cl4, valueIndex1D(cal.station.cl4$Data[!is.na(cal.station.cl4$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl4.rv20max <- MaxReturnValue(cal.station.cl4)

index.cal.station.cl4 <- c(index.cal.station.cl4, index.cal.station.cl4.rv20max)

index.cal.station.pqm.cl4 <- index.cal.station.cl4


```


```{r}
cal.station.cl4 <- biasCorrection(y = station.obs.cl4, x = station.trmm.cl4, precipitation = TRUE,  method = "eqm")


cal.station.cl4 <- subsetDimension(cal.station.cl4, dimension = "time", indices = which(!is.na(cal.station.cl4$Data)))

cal.station.cl4$Dates$start <- as.POSIXct(cal.station.cl4$Dates$start,tz = "GMT")
cal.station.cl4$Dates$end <- as.POSIXct(cal.station.cl4$Dates$end,tz = "GMT")

index.cal.station.cl4 <- valueIndex1D(cal.station.cl4$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl4 <- c(index.cal.station.cl4, valueIndex1D(cal.station.cl4$Data[!is.na(cal.station.cl4$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl4.rv20max <- MaxReturnValue(cal.station.cl4)

index.cal.station.cl4 <- c(index.cal.station.cl4, index.cal.station.cl4.rv20max)

index.cal.station.eqm.cl4 <- index.cal.station.cl4


```

```{r}
cal.station.cl4 <- biasCorrection(y = station.obs.cl4, x = station.trmm.cl4, precipitation = TRUE,  method = "gpqm")


cal.station.cl4 <- subsetDimension(cal.station.cl4, dimension = "time", indices = which(!is.na(cal.station.cl4$Data)))

cal.station.cl4$Dates$start <- as.POSIXct(cal.station.cl4$Dates$start,tz = "GMT")
cal.station.cl4$Dates$end <- as.POSIXct(cal.station.cl4$Dates$end,tz = "GMT")

index.cal.station.cl4 <- valueIndex1D(cal.station.cl4$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl4 <- c(index.cal.station.cl4, valueIndex1D(cal.station.cl4$Data[!is.na(cal.station.cl4$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl4.rv20max <- MaxReturnValue(cal.station.cl4)

index.cal.station.cl4 <- c(index.cal.station.cl4, index.cal.station.cl4.rv20max)

index.cal.station.gpqm.cl4 <- index.cal.station.cl4


```


```{r}
cal.station.cl4 <- biasCorrection(y = station.obs.cl4, x = station.trmm.cl4, precipitation = TRUE,  method = "gpqm" , theta = .7)


cal.station.cl4 <- subsetDimension(cal.station.cl4, dimension = "time", indices = which(!is.na(cal.station.cl4$Data)))

cal.station.cl4$Dates$start <- as.POSIXct(cal.station.cl4$Dates$start,tz = "GMT")
cal.station.cl4$Dates$end <- as.POSIXct(cal.station.cl4$Dates$end,tz = "GMT")

index.cal.station.cl4 <- valueIndex1D(cal.station.cl4$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl4 <- c(index.cal.station.cl4, valueIndex1D(cal.station.cl4$Data[!is.na(cal.station.cl4$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl4.rv20max <- MaxReturnValue(cal.station.cl4)

index.cal.station.cl4 <- c(index.cal.station.cl4, index.cal.station.cl4.rv20max)

index.cal.station.gpqm2.cl4 <- index.cal.station.cl4


```



```{r}
measures <- list()
for (i in c(1:9)) {
  measures[[length(measures)+1]] <- c(abs(index.trmm.cl4[i]-index.obs.cl4[i]),abs(index.era5.cl4[i]-index.obs.cl4[i]),abs(index.cal.station.pqm.cl4[i]-index.obs.cl4[i]), abs(index.cal.station.eqm.cl4[i]-index.obs.cl4[i]), abs(index.cal.station.gpqm.cl4[i]-index.obs.cl4[i]), abs(index.cal.station.gpqm2.cl4[i]-index.obs.cl4[i])) 
}

```

```{r}
norm.vector <- list()
for (i in c(1:length(measures))) {
  norm.vector[[length(norm.vector)+1]] <- normalization(measures[[i]]) 
}
```

```{r}
score.trmm <- c()
for (i in c(1:9)) {
  score.trmm <- c(score.trmm, norm.vector[[i]][1]) 
}
score.trmm <- mean(score.trmm)

score.era5 <- c()
for (i in c(1:9)) {
  score.era5 <- c(score.era5, norm.vector[[i]][2]) 
}
score.era5 <- mean(score.era5)

score.pqm <- c()
for (i in c(1:9)) {
  score.pqm <- c(score.pqm, norm.vector[[i]][3]) 
}
score.pqm <- mean(score.pqm)


score.eqm <- c()
for (i in c(1:9)) {
  score.eqm <- c(score.eqm, norm.vector[[i]][4]) 
}
score.eqm <- mean(score.eqm)


score.gpqm <- c()
for (i in c(1:9)) {
  score.gpqm <- c(score.gpqm, norm.vector[[i]][5]) 
}
score.gpqm <- mean(score.gpqm)

score.gpqm.cl5 <- c()


score.gpqm2 <- c()
for (i in c(1:9)) {
  score.gpqm2 <- c(score.gpqm2, norm.vector[[i]][6]) 
}
score.gpqm2 <- mean(score.gpqm2)



scores <- c(score.trmm,score.era5, score.pqm, score.eqm, score.gpqm, score.gpqm2)
names(scores) <- c("TRMM","ERA5","PQM-WT4","EQM-WT4","GPQM-WT4","GPQM2-WT4")
scores <- sort(scores, decreasing = T)
scores
```
```{r}
scores.st6.wt4 <- scores
```
### WT5

```{r}
station.obs.cl5 <- subsetDimension(station.obs, dimension = "time", indices = which(kmModel5$cluster == 5))


station.trmm.cl5 <- subsetDimension(station.trmm, dimension = "time", indices = which(kmModel5$cluster == 5))

station.era5.cl5 <- subsetDimension(station.era5, dimension = "time", indices = which(kmModel5$cluster == 5))
```

```{r}
index.obs.cl5 <- valueIndex1D(station.obs.cl5$Data[!is.na(station.obs.cl5$Data)],index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))
index.obs.cl5 <- c(index.obs.cl5, valueIndex1D(station.obs.cl5$Data[!is.na(station.obs.cl5$Data)], index.codes = "P98WetAmount"))
index.obs.cl5.rv20max <- MaxReturnValue(station.obs.cl5)
index.obs.cl5 <- c(index.obs.cl5, index.obs.cl5.rv20max)

index.trmm.cl5 <- valueIndex1D(station.trmm.cl5$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.trmm.cl5.rv20max <- MaxReturnValue(station.trmm.cl5)
index.trmm.cl5 <- c(index.trmm.cl5, index.trmm.cl5.rv20max)

index.era5.cl5 <- valueIndex1D(station.era5.cl5$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.era5.cl5.rv20max <- MaxReturnValue(station.era5.cl5)
index.era5.cl5 <- c(index.era5.cl5, index.era5.cl5.rv20max)
```

```{r}
cal.station.cl5 <- biasCorrection(y = station.obs.cl5, x = station.trmm.cl5, precipitation = TRUE,  method = "pqm")


cal.station.cl5 <- subsetDimension(cal.station.cl5, dimension = "time", indices = which(!is.na(cal.station.cl5$Data)))

cal.station.cl5$Dates$start <- as.POSIXct(cal.station.cl5$Dates$start,tz = "GMT")
cal.station.cl5$Dates$end <- as.POSIXct(cal.station.cl5$Dates$end,tz = "GMT")

index.cal.station.cl5 <- valueIndex1D(cal.station.cl5$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl5 <- c(index.cal.station.cl5, valueIndex1D(cal.station.cl5$Data[!is.na(cal.station.cl5$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl5.rv20max <- MaxReturnValue(cal.station.cl5)

index.cal.station.cl5 <- c(index.cal.station.cl5, index.cal.station.cl5.rv20max)

index.cal.station.pqm.cl5 <- index.cal.station.cl5


```


```{r}
cal.station.cl5 <- biasCorrection(y = station.obs.cl5, x = station.trmm.cl5, precipitation = TRUE,  method = "eqm")


cal.station.cl5 <- subsetDimension(cal.station.cl5, dimension = "time", indices = which(!is.na(cal.station.cl5$Data)))

cal.station.cl5$Dates$start <- as.POSIXct(cal.station.cl5$Dates$start,tz = "GMT")
cal.station.cl5$Dates$end <- as.POSIXct(cal.station.cl5$Dates$end,tz = "GMT")

index.cal.station.cl5 <- valueIndex1D(cal.station.cl5$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl5 <- c(index.cal.station.cl5, valueIndex1D(cal.station.cl5$Data[!is.na(cal.station.cl5$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl5.rv20max <- MaxReturnValue(cal.station.cl5)

index.cal.station.cl5 <- c(index.cal.station.cl5, index.cal.station.cl5.rv20max)

index.cal.station.eqm.cl5 <- index.cal.station.cl5


```

```{r}
cal.station.cl5 <- biasCorrection(y = station.obs.cl5, x = station.trmm.cl5, precipitation = TRUE,  method = "gpqm")


cal.station.cl5 <- subsetDimension(cal.station.cl5, dimension = "time", indices = which(!is.na(cal.station.cl5$Data)))

cal.station.cl5$Dates$start <- as.POSIXct(cal.station.cl5$Dates$start,tz = "GMT")
cal.station.cl5$Dates$end <- as.POSIXct(cal.station.cl5$Dates$end,tz = "GMT")

index.cal.station.cl5 <- valueIndex1D(cal.station.cl5$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl5 <- c(index.cal.station.cl5, valueIndex1D(cal.station.cl5$Data[!is.na(cal.station.cl5$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl5.rv20max <- MaxReturnValue(cal.station.cl5)

index.cal.station.cl5 <- c(index.cal.station.cl5, index.cal.station.cl5.rv20max)

index.cal.station.gpqm.cl5 <- index.cal.station.cl5


```


```{r}
cal.station.cl5 <- biasCorrection(y = station.obs.cl5, x = station.trmm.cl5, precipitation = TRUE,  method = "gpqm" , theta = .7)


cal.station.cl5 <- subsetDimension(cal.station.cl5, dimension = "time", indices = which(!is.na(cal.station.cl5$Data)))

cal.station.cl5$Dates$start <- as.POSIXct(cal.station.cl5$Dates$start,tz = "GMT")
cal.station.cl5$Dates$end <- as.POSIXct(cal.station.cl5$Dates$end,tz = "GMT")

index.cal.station.cl5 <- valueIndex1D(cal.station.cl5$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl5 <- c(index.cal.station.cl5, valueIndex1D(cal.station.cl5$Data[!is.na(cal.station.cl5$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl5.rv20max <- MaxReturnValue(cal.station.cl5)

index.cal.station.cl5 <- c(index.cal.station.cl5, index.cal.station.cl5.rv20max)

index.cal.station.gpqm2.cl5 <- index.cal.station.cl5


```



```{r}
measures <- list()
for (i in c(1:9)) {
  measures[[length(measures)+1]] <- c(abs(index.trmm.cl5[i]-index.obs.cl5[i]),abs(index.era5.cl5[i]-index.obs.cl5[i]),abs(index.cal.station.pqm.cl5[i]-index.obs.cl5[i]), abs(index.cal.station.eqm.cl5[i]-index.obs.cl5[i]), abs(index.cal.station.gpqm.cl5[i]-index.obs.cl5[i]), abs(index.cal.station.gpqm2.cl5[i]-index.obs.cl5[i])) 
}

```

```{r}
norm.vector <- list()
for (i in c(1:length(measures))) {
  norm.vector[[length(norm.vector)+1]] <- normalization(measures[[i]]) 
}
```

```{r}
score.trmm <- c()
for (i in c(1:9)) {
  score.trmm <- c(score.trmm, norm.vector[[i]][1]) 
}
score.trmm <- mean(score.trmm)

score.era5 <- c()
for (i in c(1:9)) {
  score.era5 <- c(score.era5, norm.vector[[i]][1]) 
}
score.era5 <- mean(score.era5)

score.pqm <- c()
for (i in c(1:9)) {
  score.pqm <- c(score.pqm, norm.vector[[i]][2]) 
}
score.pqm <- mean(score.pqm)


score.eqm <- c()
for (i in c(1:9)) {
  score.eqm <- c(score.eqm, norm.vector[[i]][3]) 
}
score.eqm <- mean(score.eqm)


score.gpqm <- c()
for (i in c(1:9)) {
  score.gpqm <- c(score.gpqm, norm.vector[[i]][4]) 
}
score.gpqm <- mean(score.gpqm)



score.gpqm2 <- c()
for (i in c(1:9)) {
  score.gpqm2 <- c(score.gpqm2, norm.vector[[i]][5]) 
}
score.gpqm2 <- mean(score.gpqm2)


scores <- c(score.trmm, score.era5, score.pqm, score.eqm, score.gpqm, score.gpqm2)
names(scores) <- c("TRMM","ERA5","PQM-WT5","EQM-WT5","GPQM-WT5","GPQM2-WT5")
scores <- sort(scores, decreasing = T)
scores
```

```{r}
scores.st6.wt5 <- scores
```
## Nu'uuli, American Samoa


```{r}
i=7

station.trmm <- subsetGrid(precip_trmm, station.id = precip_trmm$Metadata$station_id[i])
station.obs <- subsetGrid(precip_obs, station.id = precip_trmm$Metadata$station_id[i])

idx <- which.min(abs(pp_reanalysis$xyCoords$x - station.obs$xyCoords$x))
lon <- pp_reanalysis$xyCoords$x[idx]
  
idx2 <- which.min(abs(pp_reanalysis$xyCoords$y - station.obs$xyCoords$y))
lat <- pp_reanalysis$xyCoords$y[idx2]
  
station.era5 <- subsetGrid(pp_reanalysis, lonLim = lon, latLim = lat)
```


````{r}
index.obs <- valueIndex1D(station.obs$Data[!is.na(station.obs$Data)],index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))
index.obs <- c(index.obs, valueIndex1D(station.obs$Data[!is.na(station.obs$Data)], index.codes = "P98WetAmount"))
index.obs.rv20max <- MaxReturnValue(station.obs)
index.obs <- c(index.obs, index.obs.rv20max)

index.trmm <- valueIndex1D(station.trmm$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.trmm.rv20max <- MaxReturnValue(station.trmm)
index.trmm <- c(index.trmm, index.trmm.rv20max)

index.era5 <- valueIndex1D(station.era5$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.era5.rv20max <- MaxReturnValue(station.era5)
index.era5 <- c(index.era5, index.era5.rv20max)

```



### WT1

```{r}
station.obs.cl1 <- subsetDimension(station.obs, dimension = "time", indices = which(kmModel5$cluster == 1))


station.trmm.cl1 <- subsetDimension(station.trmm, dimension = "time", indices = which(kmModel5$cluster == 1))

station.era5.cl1 <- subsetDimension(station.era5, dimension = "time", indices = which(kmModel5$cluster == 1))
```

```{r}
index.obs.cl1 <- valueIndex1D(station.obs.cl1$Data[!is.na(station.obs.cl1$Data)],index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))
index.obs.cl1 <- c(index.obs.cl1, valueIndex1D(station.obs.cl1$Data[!is.na(station.obs.cl1$Data)], index.codes = "P98WetAmount"))
index.obs.cl1.rv20max <- MaxReturnValue(station.obs.cl1)
index.obs.cl1 <- c(index.obs.cl1, index.obs.cl1.rv20max)

index.trmm.cl1 <- valueIndex1D(station.trmm.cl1$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.trmm.cl1.rv20max <- MaxReturnValue(station.trmm.cl1)
index.trmm.cl1 <- c(index.trmm.cl1, index.trmm.cl1.rv20max)

index.era5.cl1 <- valueIndex1D(station.era5.cl1$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.era5.cl1.rv20max <- MaxReturnValue(station.era5.cl1)
index.era5.cl1 <- c(index.era5.cl1, index.era5.cl1.rv20max)
```

```{r}
cal.station.cl1 <- biasCorrection(y = station.obs.cl1, x = station.trmm.cl1, precipitation = TRUE,  method = "pqm")


cal.station.cl1 <- subsetDimension(cal.station.cl1, dimension = "time", indices = which(!is.na(cal.station.cl1$Data)))

cal.station.cl1$Dates$start <- as.POSIXct(cal.station.cl1$Dates$start,tz = "GMT")
cal.station.cl1$Dates$end <- as.POSIXct(cal.station.cl1$Dates$end,tz = "GMT")

index.cal.station.cl1 <- valueIndex1D(cal.station.cl1$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl1 <- c(index.cal.station.cl1, valueIndex1D(cal.station.cl1$Data[!is.na(cal.station.cl1$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl1.rv20max <- MaxReturnValue(cal.station.cl1)

index.cal.station.cl1 <- c(index.cal.station.cl1, index.cal.station.cl1.rv20max)

index.cal.station.pqm.cl1 <- index.cal.station.cl1


```


```{r}
cal.station.cl1 <- biasCorrection(y = station.obs.cl1, x = station.trmm.cl1, precipitation = TRUE,  method = "eqm")


cal.station.cl1 <- subsetDimension(cal.station.cl1, dimension = "time", indices = which(!is.na(cal.station.cl1$Data)))

cal.station.cl1$Dates$start <- as.POSIXct(cal.station.cl1$Dates$start,tz = "GMT")
cal.station.cl1$Dates$end <- as.POSIXct(cal.station.cl1$Dates$end,tz = "GMT")

index.cal.station.cl1 <- valueIndex1D(cal.station.cl1$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl1 <- c(index.cal.station.cl1, valueIndex1D(cal.station.cl1$Data[!is.na(cal.station.cl1$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl1.rv20max <- MaxReturnValue(cal.station.cl1)

index.cal.station.cl1 <- c(index.cal.station.cl1, index.cal.station.cl1.rv20max)

index.cal.station.eqm.cl1 <- index.cal.station.cl1


```

```{r}
cal.station.cl1 <- biasCorrection(y = station.obs.cl1, x = station.trmm.cl1, precipitation = TRUE,  method = "gpqm")


cal.station.cl1 <- subsetDimension(cal.station.cl1, dimension = "time", indices = which(!is.na(cal.station.cl1$Data)))

cal.station.cl1$Dates$start <- as.POSIXct(cal.station.cl1$Dates$start,tz = "GMT")
cal.station.cl1$Dates$end <- as.POSIXct(cal.station.cl1$Dates$end,tz = "GMT")

index.cal.station.cl1 <- valueIndex1D(cal.station.cl1$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl1 <- c(index.cal.station.cl1, valueIndex1D(cal.station.cl1$Data[!is.na(cal.station.cl1$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl1.rv20max <- MaxReturnValue(cal.station.cl1)

index.cal.station.cl1 <- c(index.cal.station.cl1, index.cal.station.cl1.rv20max)

index.cal.station.gpqm.cl1 <- index.cal.station.cl1


```


```{r}
cal.station.cl1 <- biasCorrection(y = station.obs.cl1, x = station.trmm.cl1, precipitation = TRUE,  method = "gpqm" , theta = .7)


cal.station.cl1 <- subsetDimension(cal.station.cl1, dimension = "time", indices = which(!is.na(cal.station.cl1$Data)))

cal.station.cl1$Dates$start <- as.POSIXct(cal.station.cl1$Dates$start,tz = "GMT")
cal.station.cl1$Dates$end <- as.POSIXct(cal.station.cl1$Dates$end,tz = "GMT")

index.cal.station.cl1 <- valueIndex1D(cal.station.cl1$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl1 <- c(index.cal.station.cl1, valueIndex1D(cal.station.cl1$Data[!is.na(cal.station.cl1$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl1.rv20max <- MaxReturnValue(cal.station.cl1)

index.cal.station.cl1 <- c(index.cal.station.cl1, index.cal.station.cl1.rv20max)

index.cal.station.gpqm2.cl1 <- index.cal.station.cl1


```



```{r}
measures <- list()
for (i in c(1:9)) {
  measures[[length(measures)+1]] <- c(abs(index.trmm.cl1[i]-index.obs.cl1[i]),abs(index.era5.cl1[i]-index.obs.cl1[i]),abs(index.cal.station.pqm.cl1[i]-index.obs.cl1[i]), abs(index.cal.station.eqm.cl1[i]-index.obs.cl1[i]), abs(index.cal.station.gpqm.cl1[i]-index.obs.cl1[i]), abs(index.cal.station.gpqm2.cl1[i]-index.obs.cl1[i])) 
}

```

```{r}
normalization <- function(measure){
  measure.norm <- c()
  #measure must be a vector with the value of a certain measure of different calibrations
  for (i in c(1:length(measure))) {
    measure.norm <- c(measure.norm, 1-((measure[i]-min(measure))/(max(measure)-min(measure))))
  }
  return(measure.norm)
}
```

```{r}
norm.vector <- list()
for (i in c(1:length(measures))) {
  norm.vector[[length(norm.vector)+1]] <- normalization(measures[[i]]) 
}
```

```{r}
score.trmm <- c()
for (i in c(1:9)) {
  score.trmm <- c(score.trmm, norm.vector[[i]][1]) 
}
score.trmm <- mean(score.trmm)

score.era5 <- c()
for (i in c(1:9)) {
  score.era5 <- c(score.era5, norm.vector[[i]][2]) 
}
score.era5 <- mean(score.era5)

score.pqm <- c()
for (i in c(1:9)) {
  score.pqm <- c(score.pqm, norm.vector[[i]][3]) 
}
score.pqm <- mean(score.pqm)


score.eqm <- c()
for (i in c(1:9)) {
  score.eqm <- c(score.eqm, norm.vector[[i]][4]) 
}
score.eqm <- mean(score.eqm)


score.gpqm <- c()
for (i in c(1:9)) {
  score.gpqm <- c(score.gpqm, norm.vector[[i]][5]) 
}
score.gpqm <- mean(score.gpqm)


score.gpqm2 <- c()
for (i in c(1:9)) {
  score.gpqm2 <- c(score.gpqm2, norm.vector[[i]][6]) 
}
score.gpqm2 <- mean(score.gpqm2)




scores <- c(score.trmm,score.era5, score.pqm, score.eqm, score.gpqm, score.gpqm2)
names(scores) <- c("TRMM","ERA5","PQM-WT1","EQM-WT1","GPQM-WT1","GPQM2-WT1")
scores <- sort(scores, decreasing = T)
scores
```
```{r}
scores.st7.wt1 <- scores
```
### WT2
```{r}
station.obs.cl2 <- subsetDimension(station.obs, dimension = "time", indices = which(kmModel5$cluster == 2))


station.trmm.cl2 <- subsetDimension(station.trmm, dimension = "time", indices = which(kmModel5$cluster == 2))

station.era5.cl2 <- subsetDimension(station.era5, dimension = "time", indices = which(kmModel5$cluster == 2))
```

```{r}
index.obs.cl2 <- valueIndex1D(station.obs.cl2$Data[!is.na(station.obs.cl2$Data)],index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))
index.obs.cl2 <- c(index.obs.cl2, valueIndex1D(station.obs.cl2$Data[!is.na(station.obs.cl2$Data)], index.codes = "P98WetAmount"))
index.obs.cl2.rv20max <- MaxReturnValue(station.obs.cl2)
index.obs.cl2 <- c(index.obs.cl2, index.obs.cl2.rv20max)

index.trmm.cl2 <- valueIndex1D(station.trmm.cl2$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.trmm.cl2.rv20max <- MaxReturnValue(station.trmm.cl2)
index.trmm.cl2 <- c(index.trmm.cl2, index.trmm.cl2.rv20max)

index.era5.cl2 <- valueIndex1D(station.era5.cl2$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.era5.cl2.rv20max <- MaxReturnValue(station.era5.cl2)
index.era5.cl2 <- c(index.era5.cl2, index.era5.cl2.rv20max)
```

```{r}
cal.station.cl2 <- biasCorrection(y = station.obs.cl2, x = station.trmm.cl2, precipitation = TRUE,  method = "pqm")


cal.station.cl2 <- subsetDimension(cal.station.cl2, dimension = "time", indices = which(!is.na(cal.station.cl2$Data)))

cal.station.cl2$Dates$start <- as.POSIXct(cal.station.cl2$Dates$start,tz = "GMT")
cal.station.cl2$Dates$end <- as.POSIXct(cal.station.cl2$Dates$end,tz = "GMT")

index.cal.station.cl2 <- valueIndex1D(cal.station.cl2$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl2 <- c(index.cal.station.cl2, valueIndex1D(cal.station.cl2$Data[!is.na(cal.station.cl2$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl2.rv20max <- MaxReturnValue(cal.station.cl2)

index.cal.station.cl2 <- c(index.cal.station.cl2, index.cal.station.cl2.rv20max)

index.cal.station.pqm.cl2 <- index.cal.station.cl2


```


```{r}
cal.station.cl2 <- biasCorrection(y = station.obs.cl2, x = station.trmm.cl2, precipitation = TRUE,  method = "eqm")


cal.station.cl2 <- subsetDimension(cal.station.cl2, dimension = "time", indices = which(!is.na(cal.station.cl2$Data)))

cal.station.cl2$Dates$start <- as.POSIXct(cal.station.cl2$Dates$start,tz = "GMT")
cal.station.cl2$Dates$end <- as.POSIXct(cal.station.cl2$Dates$end,tz = "GMT")

index.cal.station.cl2 <- valueIndex1D(cal.station.cl2$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl2 <- c(index.cal.station.cl2, valueIndex1D(cal.station.cl2$Data[!is.na(cal.station.cl2$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl2.rv20max <- MaxReturnValue(cal.station.cl2)

index.cal.station.cl2 <- c(index.cal.station.cl2, index.cal.station.cl2.rv20max)

index.cal.station.eqm.cl2 <- index.cal.station.cl2


```

```{r}
cal.station.cl2 <- biasCorrection(y = station.obs.cl2, x = station.trmm.cl2, precipitation = TRUE,  method = "gpqm")


cal.station.cl2 <- subsetDimension(cal.station.cl2, dimension = "time", indices = which(!is.na(cal.station.cl2$Data)))

cal.station.cl2$Dates$start <- as.POSIXct(cal.station.cl2$Dates$start,tz = "GMT")
cal.station.cl2$Dates$end <- as.POSIXct(cal.station.cl2$Dates$end,tz = "GMT")

index.cal.station.cl2 <- valueIndex1D(cal.station.cl2$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl2 <- c(index.cal.station.cl2, valueIndex1D(cal.station.cl2$Data[!is.na(cal.station.cl2$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl2.rv20max <- MaxReturnValue(cal.station.cl2)

index.cal.station.cl2 <- c(index.cal.station.cl2, index.cal.station.cl2.rv20max)

index.cal.station.gpqm.cl2 <- index.cal.station.cl2


```


```{r}
cal.station.cl2 <- biasCorrection(y = station.obs.cl2, x = station.trmm.cl2, precipitation = TRUE,  method = "gpqm" , theta = .7)


cal.station.cl2 <- subsetDimension(cal.station.cl2, dimension = "time", indices = which(!is.na(cal.station.cl2$Data)))

cal.station.cl2$Dates$start <- as.POSIXct(cal.station.cl2$Dates$start,tz = "GMT")
cal.station.cl2$Dates$end <- as.POSIXct(cal.station.cl2$Dates$end,tz = "GMT")

index.cal.station.cl2 <- valueIndex1D(cal.station.cl2$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl2 <- c(index.cal.station.cl2, valueIndex1D(cal.station.cl2$Data[!is.na(cal.station.cl2$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl2.rv20max <- MaxReturnValue(cal.station.cl2)

index.cal.station.cl2 <- c(index.cal.station.cl2, index.cal.station.cl2.rv20max)

index.cal.station.gpqm2.cl2 <- index.cal.station.cl2


```



```{r}
measures <- list()
for (i in c(1:9)) {
  measures[[length(measures)+1]] <- c(abs(index.trmm.cl2[i]-index.obs.cl2[i]),abs(index.era5.cl2[i]-index.obs.cl2[i]),abs(index.cal.station.pqm.cl2[i]-index.obs.cl2[i]), abs(index.cal.station.eqm.cl2[i]-index.obs.cl2[i]), abs(index.cal.station.gpqm.cl2[i]-index.obs.cl2[i]), abs(index.cal.station.gpqm2.cl2[i]-index.obs.cl2[i])) 
}

```

```{r}
norm.vector <- list()
for (i in c(1:length(measures))) {
  norm.vector[[length(norm.vector)+1]] <- normalization(measures[[i]]) 
}
```

```{r}
score.trmm <- c()
for (i in c(1:9)) {
  score.trmm <- c(score.trmm, norm.vector[[i]][1]) 
}
score.trmm <- mean(score.trmm)

score.era5 <- c()
for (i in c(1:9)) {
  score.era5 <- c(score.era5, norm.vector[[i]][2]) 
}
score.era5 <- mean(score.era5)

score.pqm <- c()
for (i in c(1:9)) {
  score.pqm <- c(score.pqm, norm.vector[[i]][3]) 
}
score.pqm <- mean(score.pqm)


score.eqm <- c()
for (i in c(1:9)) {
  score.eqm <- c(score.eqm, norm.vector[[i]][4]) 
}
score.eqm <- mean(score.eqm)


score.gpqm <- c()
for (i in c(1:9)) {
  score.gpqm <- c(score.gpqm, norm.vector[[i]][5]) 
}
score.gpqm <- mean(score.gpqm)

score.gpqm2 <- c()
for (i in c(1:9)) {
  score.gpqm2 <- c(score.gpqm2, norm.vector[[i]][6]) 
}
score.gpqm2 <- mean(score.gpqm2)

scores <- c(score.trmm, score.era5, score.pqm, score.eqm, score.gpqm, score.gpqm2)
names(scores) <- c("TRMM","ERA5","PQM-WT1","EQM-WT1","GPQM-WT1","GPQM2-WT1")
scores <- sort(scores, decreasing = T)
scores
```
```{r}
scores.st7.wt2 <- scores
```
### WT3

```{r}
station.obs.cl3 <- subsetDimension(station.obs, dimension = "time", indices = which(kmModel5$cluster == 3))


station.trmm.cl3 <- subsetDimension(station.trmm, dimension = "time", indices = which(kmModel5$cluster == 3))

station.era5.cl3 <- subsetDimension(station.era5, dimension = "time", indices = which(kmModel5$cluster == 3))
```

```{r}
index.obs.cl3 <- valueIndex1D(station.obs.cl3$Data[!is.na(station.obs.cl3$Data)],index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))
index.obs.cl3 <- c(index.obs.cl3, valueIndex1D(station.obs.cl3$Data[!is.na(station.obs.cl3$Data)], index.codes = "P98WetAmount"))
index.obs.cl3.rv20max <- MaxReturnValue(station.obs.cl3)
index.obs.cl3 <- c(index.obs.cl3, index.obs.cl3.rv20max)

index.trmm.cl3 <- valueIndex1D(station.trmm.cl3$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.trmm.cl3.rv20max <- MaxReturnValue(station.trmm.cl3)
index.trmm.cl3 <- c(index.trmm.cl3, index.trmm.cl3.rv20max)

index.era5.cl3 <- valueIndex1D(station.era5.cl3$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.era5.cl3.rv20max <- MaxReturnValue(station.era5.cl3)
index.era5.cl3 <- c(index.era5.cl3, index.era5.cl3.rv20max)
```

```{r}
cal.station.cl3 <- biasCorrection(y = station.obs.cl3, x = station.trmm.cl3, precipitation = TRUE,  method = "pqm")


cal.station.cl3 <- subsetDimension(cal.station.cl3, dimension = "time", indices = which(!is.na(cal.station.cl3$Data)))

cal.station.cl3$Dates$start <- as.POSIXct(cal.station.cl3$Dates$start,tz = "GMT")
cal.station.cl3$Dates$end <- as.POSIXct(cal.station.cl3$Dates$end,tz = "GMT")

index.cal.station.cl3 <- valueIndex1D(cal.station.cl3$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl3 <- c(index.cal.station.cl3, valueIndex1D(cal.station.cl3$Data[!is.na(cal.station.cl3$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl3.rv20max <- MaxReturnValue(cal.station.cl3)

index.cal.station.cl3 <- c(index.cal.station.cl3, index.cal.station.cl3.rv20max)

index.cal.station.pqm.cl3 <- index.cal.station.cl3


```


```{r}
cal.station.cl3 <- biasCorrection(y = station.obs.cl3, x = station.trmm.cl3, precipitation = TRUE,  method = "eqm")


cal.station.cl3 <- subsetDimension(cal.station.cl3, dimension = "time", indices = which(!is.na(cal.station.cl3$Data)))

cal.station.cl3$Dates$start <- as.POSIXct(cal.station.cl3$Dates$start,tz = "GMT")
cal.station.cl3$Dates$end <- as.POSIXct(cal.station.cl3$Dates$end,tz = "GMT")

index.cal.station.cl3 <- valueIndex1D(cal.station.cl3$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl3 <- c(index.cal.station.cl3, valueIndex1D(cal.station.cl3$Data[!is.na(cal.station.cl3$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl3.rv20max <- MaxReturnValue(cal.station.cl3)

index.cal.station.cl3 <- c(index.cal.station.cl3, index.cal.station.cl3.rv20max)

index.cal.station.eqm.cl3 <- index.cal.station.cl3


```

```{r}
cal.station.cl3 <- biasCorrection(y = station.obs.cl3, x = station.trmm.cl3, precipitation = TRUE,  method = "gpqm")


cal.station.cl3 <- subsetDimension(cal.station.cl3, dimension = "time", indices = which(!is.na(cal.station.cl3$Data)))

cal.station.cl3$Dates$start <- as.POSIXct(cal.station.cl3$Dates$start,tz = "GMT")
cal.station.cl3$Dates$end <- as.POSIXct(cal.station.cl3$Dates$end,tz = "GMT")

index.cal.station.cl3 <- valueIndex1D(cal.station.cl3$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl3 <- c(index.cal.station.cl3, valueIndex1D(cal.station.cl3$Data[!is.na(cal.station.cl3$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl3.rv20max <- MaxReturnValue(cal.station.cl3)

index.cal.station.cl3 <- c(index.cal.station.cl3, index.cal.station.cl3.rv20max)

index.cal.station.gpqm.cl3 <- index.cal.station.cl3


```


```{r}
cal.station.cl3 <- biasCorrection(y = station.obs.cl3, x = station.trmm.cl3, precipitation = TRUE,  method = "gpqm" , theta = .7)


cal.station.cl3 <- subsetDimension(cal.station.cl3, dimension = "time", indices = which(!is.na(cal.station.cl3$Data)))

cal.station.cl3$Dates$start <- as.POSIXct(cal.station.cl3$Dates$start,tz = "GMT")
cal.station.cl3$Dates$end <- as.POSIXct(cal.station.cl3$Dates$end,tz = "GMT")

index.cal.station.cl3 <- valueIndex1D(cal.station.cl3$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl3 <- c(index.cal.station.cl3, valueIndex1D(cal.station.cl3$Data[!is.na(cal.station.cl3$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl3.rv20max <- MaxReturnValue(cal.station.cl3)

index.cal.station.cl3 <- c(index.cal.station.cl3, index.cal.station.cl3.rv20max)

index.cal.station.gpqm2.cl3 <- index.cal.station.cl3


```



```{r}
measures <- list()
for (i in c(1:9)) {
  measures[[length(measures)+1]] <- c(abs(index.trmm.cl3[i]-index.obs.cl3[i]),abs(index.era5.cl3[i]-index.obs.cl3[i]),abs(index.cal.station.pqm.cl3[i]-index.obs.cl3[i]), abs(index.cal.station.eqm.cl3[i]-index.obs.cl3[i]), abs(index.cal.station.gpqm.cl3[i]-index.obs.cl3[i]), abs(index.cal.station.gpqm2.cl3[i]-index.obs.cl3[i])) 
}

```

```{r}
norm.vector <- list()
for (i in c(1:length(measures))) {
  norm.vector[[length(norm.vector)+1]] <- normalization(measures[[i]]) 
}
```

```{r}
score.trmm <- c()
for (i in c(1:9)) {
  score.trmm <- c(score.trmm, norm.vector[[i]][1]) 
}
score.trmm <- mean(score.trmm)

score.era5 <- c()
for (i in c(1:9)) {
  score.era5 <- c(score.era5, norm.vector[[i]][2]) 
}
score.era5 <- mean(score.era5)

score.pqm <- c()
for (i in c(1:9)) {
  score.pqm <- c(score.pqm, norm.vector[[i]][3]) 
}
score.pqm <- mean(score.pqm)


score.eqm <- c()
for (i in c(1:9)) {
  score.eqm <- c(score.eqm, norm.vector[[i]][4]) 
}
score.eqm <- mean(score.eqm)


score.gpqm <- c()
for (i in c(1:9)) {
  score.gpqm <- c(score.gpqm, norm.vector[[i]][5]) 
}
score.gpqm <- mean(score.gpqm)

score.gpqm2 <- c()
for (i in c(1:9)) {
  score.gpqm2 <- c(score.gpqm2, norm.vector[[i]][6]) 
}
score.gpqm2 <- mean(score.gpqm2)


scores <- c(score.trmm,score.era5, score.pqm, score.eqm, score.gpqm, score.gpqm2)
names(scores) <- c("TRMM","ERA5","PQM-WT3","EQM-WT3","GPQM-WT3","GPQM2-WT3")
scores <- sort(scores, decreasing = T)
scores
```
```{r}
scores.st7.wt3 <- scores
```
### WT4

```{r}
station.obs.cl4 <- subsetDimension(station.obs, dimension = "time", indices = which(kmModel5$cluster == 4))


station.trmm.cl4 <- subsetDimension(station.trmm, dimension = "time", indices = which(kmModel5$cluster == 4))

station.era5.cl4 <- subsetDimension(station.era5, dimension = "time", indices = which(kmModel5$cluster == 4))
```

```{r}
index.obs.cl4 <- valueIndex1D(station.obs.cl4$Data[!is.na(station.obs.cl4$Data)],index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))
index.obs.cl4 <- c(index.obs.cl4, valueIndex1D(station.obs.cl4$Data[!is.na(station.obs.cl4$Data)], index.codes = "P98WetAmount"))
index.obs.cl4.rv20max <- MaxReturnValue(station.obs.cl4)
index.obs.cl4 <- c(index.obs.cl4, index.obs.cl4.rv20max)

index.trmm.cl4 <- valueIndex1D(station.trmm.cl4$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.trmm.cl4.rv20max <- MaxReturnValue(station.trmm.cl4)
index.trmm.cl4 <- c(index.trmm.cl4, index.trmm.cl4.rv20max)

index.era5.cl4 <- valueIndex1D(station.era5.cl4$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.era5.cl4.rv20max <- MaxReturnValue(station.era5.cl4)
index.era5.cl4 <- c(index.era5.cl4, index.era5.cl4.rv20max)
```

```{r}
cal.station.cl4 <- biasCorrection(y = station.obs.cl4, x = station.trmm.cl4, precipitation = TRUE,  method = "pqm")


cal.station.cl4 <- subsetDimension(cal.station.cl4, dimension = "time", indices = which(!is.na(cal.station.cl4$Data)))

cal.station.cl4$Dates$start <- as.POSIXct(cal.station.cl4$Dates$start,tz = "GMT")
cal.station.cl4$Dates$end <- as.POSIXct(cal.station.cl4$Dates$end,tz = "GMT")

index.cal.station.cl4 <- valueIndex1D(cal.station.cl4$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl4 <- c(index.cal.station.cl4, valueIndex1D(cal.station.cl4$Data[!is.na(cal.station.cl4$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl4.rv20max <- MaxReturnValue(cal.station.cl4)

index.cal.station.cl4 <- c(index.cal.station.cl4, index.cal.station.cl4.rv20max)

index.cal.station.pqm.cl4 <- index.cal.station.cl4


```


```{r}
cal.station.cl4 <- biasCorrection(y = station.obs.cl4, x = station.trmm.cl4, precipitation = TRUE,  method = "eqm")


cal.station.cl4 <- subsetDimension(cal.station.cl4, dimension = "time", indices = which(!is.na(cal.station.cl4$Data)))

cal.station.cl4$Dates$start <- as.POSIXct(cal.station.cl4$Dates$start,tz = "GMT")
cal.station.cl4$Dates$end <- as.POSIXct(cal.station.cl4$Dates$end,tz = "GMT")

index.cal.station.cl4 <- valueIndex1D(cal.station.cl4$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl4 <- c(index.cal.station.cl4, valueIndex1D(cal.station.cl4$Data[!is.na(cal.station.cl4$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl4.rv20max <- MaxReturnValue(cal.station.cl4)

index.cal.station.cl4 <- c(index.cal.station.cl4, index.cal.station.cl4.rv20max)

index.cal.station.eqm.cl4 <- index.cal.station.cl4


```

```{r}
cal.station.cl4 <- biasCorrection(y = station.obs.cl4, x = station.trmm.cl4, precipitation = TRUE,  method = "gpqm")


cal.station.cl4 <- subsetDimension(cal.station.cl4, dimension = "time", indices = which(!is.na(cal.station.cl4$Data)))

cal.station.cl4$Dates$start <- as.POSIXct(cal.station.cl4$Dates$start,tz = "GMT")
cal.station.cl4$Dates$end <- as.POSIXct(cal.station.cl4$Dates$end,tz = "GMT")

index.cal.station.cl4 <- valueIndex1D(cal.station.cl4$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl4 <- c(index.cal.station.cl4, valueIndex1D(cal.station.cl4$Data[!is.na(cal.station.cl4$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl4.rv20max <- MaxReturnValue(cal.station.cl4)

index.cal.station.cl4 <- c(index.cal.station.cl4, index.cal.station.cl4.rv20max)

index.cal.station.gpqm.cl4 <- index.cal.station.cl4


```


```{r}
cal.station.cl4 <- biasCorrection(y = station.obs.cl4, x = station.trmm.cl4, precipitation = TRUE,  method = "gpqm" , theta = .7)


cal.station.cl4 <- subsetDimension(cal.station.cl4, dimension = "time", indices = which(!is.na(cal.station.cl4$Data)))

cal.station.cl4$Dates$start <- as.POSIXct(cal.station.cl4$Dates$start,tz = "GMT")
cal.station.cl4$Dates$end <- as.POSIXct(cal.station.cl4$Dates$end,tz = "GMT")

index.cal.station.cl4 <- valueIndex1D(cal.station.cl4$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl4 <- c(index.cal.station.cl4, valueIndex1D(cal.station.cl4$Data[!is.na(cal.station.cl4$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl4.rv20max <- MaxReturnValue(cal.station.cl4)

index.cal.station.cl4 <- c(index.cal.station.cl4, index.cal.station.cl4.rv20max)

index.cal.station.gpqm2.cl4 <- index.cal.station.cl4


```



```{r}
measures <- list()
for (i in c(1:9)) {
  measures[[length(measures)+1]] <- c(abs(index.trmm.cl4[i]-index.obs.cl4[i]),abs(index.era5.cl4[i]-index.obs.cl4[i]),abs(index.cal.station.pqm.cl4[i]-index.obs.cl4[i]), abs(index.cal.station.eqm.cl4[i]-index.obs.cl4[i]), abs(index.cal.station.gpqm.cl4[i]-index.obs.cl4[i]), abs(index.cal.station.gpqm2.cl4[i]-index.obs.cl4[i])) 
}

```

```{r}
norm.vector <- list()
for (i in c(1:length(measures))) {
  norm.vector[[length(norm.vector)+1]] <- normalization(measures[[i]]) 
}
```

```{r}
score.trmm <- c()
for (i in c(1:9)) {
  score.trmm <- c(score.trmm, norm.vector[[i]][1]) 
}
score.trmm <- mean(score.trmm)

score.era5 <- c()
for (i in c(1:9)) {
  score.era5 <- c(score.era5, norm.vector[[i]][2]) 
}
score.era5 <- mean(score.era5)

score.pqm <- c()
for (i in c(1:9)) {
  score.pqm <- c(score.pqm, norm.vector[[i]][3]) 
}
score.pqm <- mean(score.pqm)


score.eqm <- c()
for (i in c(1:9)) {
  score.eqm <- c(score.eqm, norm.vector[[i]][4]) 
}
score.eqm <- mean(score.eqm)


score.gpqm <- c()
for (i in c(1:9)) {
  score.gpqm <- c(score.gpqm, norm.vector[[i]][5]) 
}
score.gpqm <- mean(score.gpqm)

score.gpqm.cl5 <- c()


score.gpqm2 <- c()
for (i in c(1:9)) {
  score.gpqm2 <- c(score.gpqm2, norm.vector[[i]][6]) 
}
score.gpqm2 <- mean(score.gpqm2)



scores <- c(score.trmm,score.era5, score.pqm, score.eqm, score.gpqm, score.gpqm2)
names(scores) <- c("TRMM","ERA5","PQM-WT4","EQM-WT4","GPQM-WT4","GPQM2-WT4")
scores <- sort(scores, decreasing = T)
scores
```
```{r}
scores.st7.wt4 <- scores
```
### WT5

```{r}
station.obs.cl5 <- subsetDimension(station.obs, dimension = "time", indices = which(kmModel5$cluster == 5))


station.trmm.cl5 <- subsetDimension(station.trmm, dimension = "time", indices = which(kmModel5$cluster == 5))

station.era5.cl5 <- subsetDimension(station.era5, dimension = "time", indices = which(kmModel5$cluster == 5))
```

```{r}
index.obs.cl5 <- valueIndex1D(station.obs.cl5$Data[!is.na(station.obs.cl5$Data)],index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))
index.obs.cl5 <- c(index.obs.cl5, valueIndex1D(station.obs.cl5$Data[!is.na(station.obs.cl5$Data)], index.codes = "P98WetAmount"))
index.obs.cl5.rv20max <- MaxReturnValue(station.obs.cl5)
index.obs.cl5 <- c(index.obs.cl5, index.obs.cl5.rv20max)

index.trmm.cl5 <- valueIndex1D(station.trmm.cl5$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.trmm.cl5.rv20max <- MaxReturnValue(station.trmm.cl5)
index.trmm.cl5 <- c(index.trmm.cl5, index.trmm.cl5.rv20max)

index.era5.cl5 <- valueIndex1D(station.era5.cl5$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet","P98WetAmount"))
index.era5.cl5.rv20max <- MaxReturnValue(station.era5.cl5)
index.era5.cl5 <- c(index.era5.cl5, index.era5.cl5.rv20max)
```

```{r}
cal.station.cl5 <- biasCorrection(y = station.obs.cl5, x = station.trmm.cl5, precipitation = TRUE,  method = "pqm")


cal.station.cl5 <- subsetDimension(cal.station.cl5, dimension = "time", indices = which(!is.na(cal.station.cl5$Data)))

cal.station.cl5$Dates$start <- as.POSIXct(cal.station.cl5$Dates$start,tz = "GMT")
cal.station.cl5$Dates$end <- as.POSIXct(cal.station.cl5$Dates$end,tz = "GMT")

index.cal.station.cl5 <- valueIndex1D(cal.station.cl5$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl5 <- c(index.cal.station.cl5, valueIndex1D(cal.station.cl5$Data[!is.na(cal.station.cl5$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl5.rv20max <- MaxReturnValue(cal.station.cl5)

index.cal.station.cl5 <- c(index.cal.station.cl5, index.cal.station.cl5.rv20max)

index.cal.station.pqm.cl5 <- index.cal.station.cl5


```


```{r}
cal.station.cl5 <- biasCorrection(y = station.obs.cl5, x = station.trmm.cl5, precipitation = TRUE,  method = "eqm")


cal.station.cl5 <- subsetDimension(cal.station.cl5, dimension = "time", indices = which(!is.na(cal.station.cl5$Data)))

cal.station.cl5$Dates$start <- as.POSIXct(cal.station.cl5$Dates$start,tz = "GMT")
cal.station.cl5$Dates$end <- as.POSIXct(cal.station.cl5$Dates$end,tz = "GMT")

index.cal.station.cl5 <- valueIndex1D(cal.station.cl5$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl5 <- c(index.cal.station.cl5, valueIndex1D(cal.station.cl5$Data[!is.na(cal.station.cl5$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl5.rv20max <- MaxReturnValue(cal.station.cl5)

index.cal.station.cl5 <- c(index.cal.station.cl5, index.cal.station.cl5.rv20max)

index.cal.station.eqm.cl5 <- index.cal.station.cl5


```

```{r}
cal.station.cl5 <- biasCorrection(y = station.obs.cl5, x = station.trmm.cl5, precipitation = TRUE,  method = "gpqm")


cal.station.cl5 <- subsetDimension(cal.station.cl5, dimension = "time", indices = which(!is.na(cal.station.cl5$Data)))

cal.station.cl5$Dates$start <- as.POSIXct(cal.station.cl5$Dates$start,tz = "GMT")
cal.station.cl5$Dates$end <- as.POSIXct(cal.station.cl5$Dates$end,tz = "GMT")

index.cal.station.cl5 <- valueIndex1D(cal.station.cl5$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl5 <- c(index.cal.station.cl5, valueIndex1D(cal.station.cl5$Data[!is.na(cal.station.cl5$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl5.rv20max <- MaxReturnValue(cal.station.cl5)

index.cal.station.cl5 <- c(index.cal.station.cl5, index.cal.station.cl5.rv20max)

index.cal.station.gpqm.cl5 <- index.cal.station.cl5


```


```{r}
cal.station.cl5 <- biasCorrection(y = station.obs.cl5, x = station.trmm.cl5, precipitation = TRUE,  method = "gpqm" , theta = .7)


cal.station.cl5 <- subsetDimension(cal.station.cl5, dimension = "time", indices = which(!is.na(cal.station.cl5$Data)))

cal.station.cl5$Dates$start <- as.POSIXct(cal.station.cl5$Dates$start,tz = "GMT")
cal.station.cl5$Dates$end <- as.POSIXct(cal.station.cl5$Dates$end,tz = "GMT")

index.cal.station.cl5 <- valueIndex1D(cal.station.cl5$Data,index.codes=c("Skewness","SDII","R10","R10p","R20","R20p","P98Wet"))

index.cal.station.cl5 <- c(index.cal.station.cl5, valueIndex1D(cal.station.cl5$Data[!is.na(cal.station.cl5$Data)], index.codes = "P98WetAmount"))

index.cal.station.cl5.rv20max <- MaxReturnValue(cal.station.cl5)

index.cal.station.cl5 <- c(index.cal.station.cl5, index.cal.station.cl5.rv20max)

index.cal.station.gpqm2.cl5 <- index.cal.station.cl5


```



```{r}
measures <- list()
for (i in c(1:9)) {
  measures[[length(measures)+1]] <- c(abs(index.trmm.cl5[i]-index.obs.cl5[i]),abs(index.era5.cl5[i]-index.obs.cl5[i]),abs(index.cal.station.pqm.cl5[i]-index.obs.cl5[i]), abs(index.cal.station.eqm.cl5[i]-index.obs.cl5[i]), abs(index.cal.station.gpqm.cl5[i]-index.obs.cl5[i]), abs(index.cal.station.gpqm2.cl5[i]-index.obs.cl5[i])) 
}

```

```{r}
norm.vector <- list()
for (i in c(1:length(measures))) {
  norm.vector[[length(norm.vector)+1]] <- normalization(measures[[i]]) 
}
```

```{r}
score.trmm <- c()
for (i in c(1:9)) {
  score.trmm <- c(score.trmm, norm.vector[[i]][1]) 
}
score.trmm <- mean(score.trmm)

score.era5 <- c()
for (i in c(1:9)) {
  score.era5 <- c(score.era5, norm.vector[[i]][2]) 
}
score.era5 <- mean(score.era5)

score.pqm <- c()
for (i in c(1:9)) {
  score.pqm <- c(score.pqm, norm.vector[[i]][3]) 
}
score.pqm <- mean(score.pqm)


score.eqm <- c()
for (i in c(1:9)) {
  score.eqm <- c(score.eqm, norm.vector[[i]][4]) 
}
score.eqm <- mean(score.eqm)


score.gpqm <- c()
for (i in c(1:9)) {
  score.gpqm <- c(score.gpqm, norm.vector[[i]][5]) 
}
score.gpqm <- mean(score.gpqm)



score.gpqm2 <- c()
for (i in c(1:9)) {
  score.gpqm2 <- c(score.gpqm2, norm.vector[[i]][6]) 
}
score.gpqm2 <- mean(score.gpqm2)


scores <- c(score.trmm, score.era5, score.pqm, score.eqm, score.gpqm, score.gpqm2)
names(scores) <- c("TRMM","ERA5","PQM-WT5","EQM-WT5","GPQM-WT5","GPQM2-WT5")
scores <- sort(scores, decreasing = T)
scores
```

```{r}
scores.st7.wt5 <- scores
```

## Scores Boxplot

### WT1
```{r}
df.wt1 <- data.frame(c(scores.st1.wt1, scores.st2.wt1,scores.st3.wt1, scores.st4.wt1, scores.st5.wt1,scores.st6.wt1,scores.st7.wt1), c(names(scores.st1.wt1), names(scores.st2.wt1), names(scores.st3.wt1), names(scores.st4.wt1), names(scores.st5.wt1), names(scores.st6.wt1), names(scores.st7.wt1)))
colnames(df.wt1) <- c("Score_Value","Method")
df.wt1.filtered <- df.wt1[which(df.wt1$Method != "ERA5" & df.wt1$Method != "TRMM"),]
df.wt1.filtered
```


```{r}
df.wt1.trmm <- df.wt1[which(df.wt1$Method == "TRMM"),]
df.wt1.era5 <- df.wt1[which(df.wt1$Method == "ERA5"),]
```

```{r}
# df.wt1.trmm <- data.frame(rep(df.wt1.trmm$Score_Value,6),df.wt1$Method)
# colnames(df.wt1.trmm) <- c("TRMM_Score", "Method")
# 
# df.wt1.era5 <- data.frame(rep(df.wt1.era5$Score_Value,6),df.wt1$Method)
# colnames(df.wt1.era5) <- c("ERA5_Score", "Method")
```


```{r}
df.wt1.trmm$Method = rep("Raw-TRMM",length(df.wt1.trmm$Method))
df.wt1.era5$Method = rep("Raw-ERA5",length(df.wt1.era5$Method))

ggplot() +
  geom_boxplot(data = df.wt1.filtered, 
               aes(x = Method , y= Score_Value)) +
  geom_boxplot(data = df.wt1.trmm,
             aes(x = Method , y= Score_Value),
             color = 'red') +
  geom_boxplot(data = df.wt1.era5,
             aes(x = Method , y= Score_Value),
             color = 'blue') +
   ggtitle("WT1 Scores Boxplot")
```

### WT2
```{r}
df.wt2 <- data.frame(c(scores.st1.wt2, scores.st2.wt2,scores.st3.wt2, scores.st4.wt2, scores.st5.wt2,scores.st6.wt2,scores.st7.wt2), c(names(scores.st1.wt2), names(scores.st2.wt2), names(scores.st3.wt2), names(scores.st4.wt2), names(scores.st5.wt2), names(scores.st6.wt2), names(scores.st7.wt2)))
colnames(df.wt2) <- c("Score_Value","Method")
df.wt2.filtered <- df.wt2[which(df.wt2$Method != "ERA5" & df.wt2$Method != "TRMM"),]
df.wt2.filtered
```


```{r}
df.wt2.trmm <- df.wt2[which(df.wt2$Method == "TRMM"),]
df.wt2.era5 <- df.wt2[which(df.wt2$Method == "ERA5"),]
```

```{r}
# df.wt1.trmm <- data.frame(rep(df.wt1.trmm$Score_Value,6),df.wt1$Method)
# colnames(df.wt1.trmm) <- c("TRMM_Score", "Method")
# 
# df.wt1.era5 <- data.frame(rep(df.wt1.era5$Score_Value,6),df.wt1$Method)
# colnames(df.wt1.era5) <- c("ERA5_Score", "Method")
```


```{r}
df.wt2.trmm$Method = rep("Raw-TRMM",length(df.wt2.trmm$Method))
df.wt2.era5$Method = rep("Raw-ERA5",length(df.wt2.era5$Method))

ggplot() +
  geom_boxplot(data = df.wt2.filtered, 
               aes(x = Method , y= Score_Value)) +
  geom_boxplot(data = df.wt2.trmm,
             aes(x = Method , y= Score_Value),
             color = 'red') +
  geom_boxplot(data = df.wt2.era5,
             aes(x = Method , y= Score_Value),
             color = 'blue') +
   ggtitle("WT2 Scores Boxplot")
```

### WT3
```{r}
df.wt3 <- data.frame(c(scores.st1.wt3, scores.st2.wt3,scores.st3.wt3, scores.st4.wt3, scores.st5.wt3,scores.st6.wt3,scores.st7.wt3), c(names(scores.st1.wt3), names(scores.st2.wt3), names(scores.st3.wt3), names(scores.st4.wt3), names(scores.st5.wt3), names(scores.st6.wt3), names(scores.st7.wt3)))
colnames(df.wt3) <- c("Score_Value","Method")
df.wt3.filtered <- df.wt3[which(df.wt3$Method != "ERA5" & df.wt3$Method != "TRMM"),]
df.wt3.filtered
```


```{r}
df.wt3.trmm <- df.wt3[which(df.wt3$Method == "TRMM"),]
df.wt3.era5 <- df.wt3[which(df.wt3$Method == "ERA5"),]
```

```{r}
# df.wt1.trmm <- data.frame(rep(df.wt1.trmm$Score_Value,6),df.wt1$Method)
# colnames(df.wt1.trmm) <- c("TRMM_Score", "Method")
# 
# df.wt1.era5 <- data.frame(rep(df.wt1.era5$Score_Value,6),df.wt1$Method)
# colnames(df.wt1.era5) <- c("ERA5_Score", "Method")
```


```{r}
df.wt3.trmm$Method = rep("Raw-TRMM",length(df.wt3.trmm$Method))
df.wt3.era5$Method = rep("Raw-ERA5",length(df.wt3.era5$Method))

ggplot() +
  geom_boxplot(data = df.wt3.filtered, 
               aes(x = Method , y= Score_Value)) +
  geom_boxplot(data = df.wt3.trmm,
             aes(x = Method , y= Score_Value),
             color = 'red') +
  geom_boxplot(data = df.wt3.era5,
             aes(x = Method , y= Score_Value),
             color = 'blue') +
   ggtitle("WT3 Scores Boxplot")
```


### WT4
```{r}
df.wt4 <- data.frame(c(scores.st1.wt4, scores.st2.wt4,scores.st3.wt4, scores.st4.wt4, scores.st5.wt4,scores.st6.wt4,scores.st7.wt4), c(names(scores.st1.wt4), names(scores.st2.wt4), names(scores.st3.wt4), names(scores.st4.wt4), names(scores.st5.wt4), names(scores.st6.wt4), names(scores.st7.wt4)))
colnames(df.wt4) <- c("Score_Value","Method")
df.wt4.filtered <- df.wt4[which(df.wt4$Method != "ERA5" & df.wt4$Method != "TRMM"),]
df.wt4.filtered
```


```{r}
df.wt4.trmm <- df.wt4[which(df.wt4$Method == "TRMM"),]
df.wt4.era5 <- df.wt4[which(df.wt4$Method == "ERA5"),]
```

```{r}
# df.wt1.trmm <- data.frame(rep(df.wt1.trmm$Score_Value,6),df.wt1$Method)
# colnames(df.wt1.trmm) <- c("TRMM_Score", "Method")
# 
# df.wt1.era5 <- data.frame(rep(df.wt1.era5$Score_Value,6),df.wt1$Method)
# colnames(df.wt1.era5) <- c("ERA5_Score", "Method")
```


```{r}
df.wt4.trmm$Method = rep("Raw-TRMM",length(df.wt4.trmm$Method))
df.wt4.era5$Method = rep("Raw-ERA5",length(df.wt4.era5$Method))

ggplot() +
  geom_boxplot(data = df.wt4.filtered, 
               aes(x = Method , y= Score_Value)) +
 geom_boxplot(data = df.wt4.trmm,
             aes(x = Method , y= Score_Value),
             color = 'red') +
  geom_boxplot(data = df.wt4.era5,
             aes(x = Method , y= Score_Value),
             color = 'blue') +
   ggtitle("WT4 Scores Boxplot")
```


### WT5
```{r}
df.wt5 <- data.frame(c(scores.st1.wt5, scores.st2.wt5,scores.st3.wt5, scores.st4.wt5, scores.st5.wt5,scores.st6.wt5,scores.st7.wt5), c(names(scores.st1.wt5), names(scores.st2.wt5), names(scores.st3.wt5), names(scores.st4.wt5), names(scores.st5.wt5), names(scores.st6.wt5), names(scores.st7.wt5)))
colnames(df.wt5) <- c("Score_Value","Method")
df.wt5.filtered <- df.wt5[which(df.wt5$Method != "ERA5" & df.wt5$Method != "TRMM"),]
df.wt5.filtered
```


```{r}
df.wt5.trmm <- df.wt5[which(df.wt5$Method == "TRMM"),]
df.wt5.era5 <- df.wt5[which(df.wt5$Method == "ERA5"),]
```

```{r}
# df.wt1.trmm <- data.frame(rep(df.wt1.trmm$Score_Value,6),df.wt1$Method)
# colnames(df.wt1.trmm) <- c("TRMM_Score", "Method")
# 
# df.wt1.era5 <- data.frame(rep(df.wt1.era5$Score_Value,6),df.wt1$Method)
# colnames(df.wt1.era5) <- c("ERA5_Score", "Method")
```


```{r}
df.wt5.trmm$Method = rep("Raw-TRMM",length(df.wt5.trmm$Method))
df.wt5.era5$Method = rep("Raw-ERA5",length(df.wt5.era5$Method))

ggplot() +
  geom_boxplot(data = df.wt5.filtered, 
               aes(x = Method , y= Score_Value)) +
  geom_boxplot(data = df.wt5.trmm,
             aes(x = Method , y= Score_Value),
             color = 'red') +
  geom_boxplot(data = df.wt5.era5,
             aes(x = Method , y= Score_Value),
             color = 'blue') +
   ggtitle("WT5 Scores Boxplot")
```